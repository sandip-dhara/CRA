<apex:page standardcontroller="Community__c" showheader="false" extensions="SLP_EditCommunity" standardstylesheets="true" doctype="html-5.0" applybodytag="false" applyhtmltag="false">
  <!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
  <!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
  <!--[if !IE]><!-->
  <html lang="en">
  <!--<![endif]-->
  <!-- BEGIN HEAD -->
  <head>
  <meta charset="utf-8" />
  <title>Edit</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta content="" name="description" />
  <meta content="" name="hp" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/css/bootstrap.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/css/bootstrap-responsive.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/css/bootstrap-fileupload.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/font-awesome/css/font-awesome.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/icomoon/iconMoon.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style-responsive.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style-default.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/tagit.ui-zendesk.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/jquery.tagit.css')}" />
  <style type="text/css">
      .ratingDispalyL {
          height: 26px;
          margin-left: 69px;
          padding-top: 3px;
          position: absolute;
          width: 113px;
          z-index: 1;
          display: none;
      }
  </style>
  <script type="text/javascript">
  
  $(document).ready(function(){
    var operatingSystem=navigator.appVersion;
    operatingSystem=operatingSystem.substring(0,operatingSystem.indexOf("\)")+1);
        
    $('[id$=hdnOperatingSystem]').val(operatingSystem);
    $('[id$=hdnBrowser]').val(FindBrowserVersion());
    $('[id$=hdnDeviceType]').val('Desktop');
    });
    
    function FindBrowserVersion()
      {
          debugger
          var nVer = navigator.appVersion;
          var nAgt = navigator.userAgent;
          var browserName  = navigator.appName;
          var fullVersion  = ''+parseFloat(navigator.appVersion); 
          var majorVersion = parseInt(navigator.appVersion,10);
          var nameOffset,verOffset,ix;
          if ((verOffset=nAgt.indexOf("Opera"))!=-1) {
              browserName = "Opera";
              fullVersion = nAgt.substring(verOffset+6);
              if ((verOffset=nAgt.indexOf("Version"))!=-1) 
                  fullVersion = nAgt.substring(verOffset+8);
          }
              // In MSIE, the true version is after "MSIE" in userAgent
          else if ((verOffset=nAgt.indexOf("MSIE"))!=-1) {
              browserName = "Microsoft Internet Explorer";
              fullVersion = nAgt.substring(verOffset+5);
          }
              // In Chrome, the true version is after "Chrome" 
          else if ((verOffset=nAgt.indexOf("Chrome"))!=-1) {
              browserName = "Chrome";
              fullVersion = nAgt.substring(verOffset+7);
          }
              // In Safari, the true version is after "Safari" or after "Version" 
          else if ((verOffset=nAgt.indexOf("Safari"))!=-1) {
              browserName = "Safari";
              fullVersion = nAgt.substring(verOffset+7);
              if ((verOffset=nAgt.indexOf("Version"))!=-1) 
                  fullVersion = nAgt.substring(verOffset+8);
          }
              // In Firefox, the true version is after "Firefox" 
          else if ((verOffset=nAgt.indexOf("Firefox"))!=-1) {
              browserName = "Firefox";
              fullVersion = nAgt.substring(verOffset+8);
          }
              // In most other browsers, "name/version" is at the end of userAgent 
          else if ( (nameOffset=nAgt.lastIndexOf(' ')+1) < (verOffset=nAgt.lastIndexOf('/')) ) {
              browserName = nAgt.substring(nameOffset,verOffset);
              fullVersion = nAgt.substring(verOffset+1);
              if (browserName.toLowerCase()==browserName.toUpperCase()) {
                  browserName = navigator.appName;
              }
          }
          else
          {
              browserName= nAgt;
              fullVersion="None";
          }
          // trim the fullVersion string at semicolon/space if present
          if ((ix=fullVersion.indexOf(";"))!=-1)
              fullVersion=fullVersion.substring(0,ix);
          if ((ix=fullVersion.indexOf(" "))!=-1)
              fullVersion=fullVersion.substring(0,ix);

          majorVersion = parseInt(''+fullVersion,10);
          if (isNaN(majorVersion)) {
              fullVersion  = ''+parseFloat(navigator.appVersion); 
              majorVersion = parseInt(navigator.appVersion,10);
          }
          var BrowserVer='';
          if(fullVersion=='None')
          {
              BrowserVer=browserName;
          }
          else
          {
              BrowserVer=browserName+' '+fullVersion;
          }
          return BrowserVer;
      }

$(document).ready(function(){  

  $('#AddTopics').on('hide.bs.modal',function(e){
  $('#txtLearningBrd').val('');
  $('[id$=InputCheckbox1]').attr('selected',false);
  $('[id$=InputCheckbox2]').attr('selected',false);
  $('[id$=InputCheckbox3]').attr('selected',false);
  });
  
  $('#GlobalSearch').on('hide.bs.modal',function(e){
  $('#txtLearningBrd').val('');
  $('[id$=InputCheckbox1]').attr('selected',false);
  $('[id$=InputCheckbox2]').attr('selected',false);
  $('[id$=InputCheckbox3]').attr('selected',false);
  });
  
});
  
      var listBoardIds = new Array();
      $(document).ready(function () {

          if ($('#lblError').length) {
              if ($("#lblError").text() == "") {
                  var buttonId = document.getElementById('{!$Component.EditTopic.btnCancelUploadFile}');
                  buttonId.click();
              }
              else {
                  return false;
              }
          }
      });
      function getUrlVars() {
          var vars = [], hash;
          var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
          for (var i = 0; i < hashes.length; i++) {
              hash = hashes[i].split('=');
              vars.push(hash[0]);
              vars[hash[0]] = hash[1];
          }
          return vars;
      }

  </script>
  </head>
  <!-- END HEAD -->
  <!-- BEGIN BODY -->
  <body>
  
  <!-- BEGIN HEADER -->
  <header>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-fluid"> 
          <!-- <a class="HpLogo"> 
          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/insight_web_logo.png')}" style="width:220px" alt="HP Logo"/></a>    -->
          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/HP_Blue_Logo.png')}" alt="HP Logo" styleclass="HpLogo"/>
          <!-- </a>-->
          <div class="nav mtop20">
            <h1 class="h1fontS">insight</h1>
            <h3>Information - on your terms</h3>
          </div>
          <ul class="nav pull-right top-menu">
            <!-- BEGIN USER LOGIN DROPDOWN -->
            <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Welcome <span class="username colorBlue">{!LoggedinUserDtls.Name}</span> <span>
              <apex:image url="{!LoggedinUserDtls.FullPhotoUrl}" styleClass="userImage" alt="no_username"/>
              </span> 
              <!--<b class="caret"></b>--> 
              </a>
              <ul class="dropdown-menu extended logout">
                <li><a href="https://{!getSfInstance}/apex/AthenaUserProfile?id={!LoggedinUserDtls.id}">My Profile</a></li>
                <li><a href="https://{!getSfInstance}/apex/SLP_EditUserProfile?id={!LoggedinUserDtls.id}">Edit Profile</a></li>
                <li><a href="https://{!getSfInstance}/secur/logout.jsp">Log Out</a></li>
              </ul>
            </li>
            <!-- END USER LOGIN DROPDOWN -->
          </ul>
          <c:SLP_SearchCustomComponent InputString="Edit Community Page"/>
          <div class="alert alert-error topSearchEr" style="display:none;" id="err_msg"> </div>
        </div>
      </div>
    </div>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-fluid menunavBar"> <a class="icon-home topNavIcon" href="https://{!getSfInstance}/apex/slp_activity" title="Home"></a> <a class="icon-book topNavIcon"  href="https://{!getSfInstance}/apex/AthenaSocialLearning" title="Library"></a>
          <apex:OutputPanel rendered="{!IsProducerOrModerator}"> <a class="icon-file-text-alt topNavIconC" href="https://{!getSfInstance}/apex/AthenacreatelearningBoard"  title="Create Board "><span class="icon-plus NaviconPlus" title="Create Board "></span></a> <a class="icon-group topNavIconCom" href="https://{!getSfInstance}/apex/SLP_CreateCommunity"  title="Create Community"><span class="icon-plus NaviconPlus" title="Create Community"></span></a> </apex:OutputPanel>
          <apex:outputPanel rendered="{!IsUserRoleMappingVisible}"> <a class="topNavRoll topNavIconCom" href="https://{!getSfInstance}/apex/SLP_UserRoleAndExpertiseMapping" title="User Role & Expert Mapping"><span class="NaviconPlus"></span></a> </apex:outputPanel>
          
          <!--<a class="icon-question-sign topNavIcon pull-right" href="https://ea2013.sharepoint.hp.com/teams/esplm/SitePages/Social Learning.aspx" target="_blank" title="Help"></a>--> 
        </div>
      </div>
    </div>
  </header>
  <!-- END HEADER --> 
  <!-- BEGIN CONTAINER -->
  <div id="container" class="row-fluid"> 
    <!-- BEGIN PAGE -->
    <apex:form id="EditTopic">  
      <div id="main-content"> 
        <!-- BEGIN PAGE CONTAINER-->
        <div class="container-fluid">
          <div class="row-fluid">
            <div class="BDheadingCom">
              <div class="span8" >
                <div>
                  <apex:inputText id="txtCommunityname" style="display:none" value="{!CommunityName}"  / >
                  <apex:inputText id="txtLName" styleclass="span7 inp5" value="{!CommunityName}"  required="true" title="Community Name"  maxlength="100" / >
                  <!--<select tabindex="1" data-placeholder="Choose a Category" class="span12">
                                    <option value="">Select Community</option>
                                    <option value="Category 1">Community 1</option>
                                    <option value="Category 2">Community 2</option>
                                    <option value="Category 3">Community 3</option>
                                    <option value="Category 4">Community 4</option>
                                </select>--> 
                </div>
              </div>
            </div>
          </div>
          <div class="row-fluid mtop10">
            <div class="span12">
              <div class="span9">
                <div class="row-fluid">
                  <div class="hpit_athena_rightDiv clearB">
                    <div class="ComBoardImage">
                      <apex:OutputPanel rendered="{!IsCommunityModeratorOrOwner}"> <a class="a_underNone" data-toggle="modal" href="#EditComImage">
                        <div class="CommunityEditTitImg"><span class="icon-pencil"></span></div>
                        </a> </apex:OutputPanel>
                      <div id="EditComImage" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                        <div class="modal-header">
                          <h3>Edit Community  Banner</h3>
                        </div>
                        <div class="modal-body">
                          <div class="control-group Editratio">
                            <label class="control-label">Choose image</label>
                            <div class="controls">
                              <apex:selectRadio Styleclass="test2" id="imgCommunity" value="{!ImageSelectionOption}"  onclick="ShowHideDefaultImage(this)">
                                <apex:selectOptions value="{!ImageOptions}"/>
                              </apex:selectRadio>
                            </div>
                          </div>
                          <div class="check ShowuploadImage clearB"   id="showLoadImg">
                            <p>This image appears at the top of each learning board Recommended size is 920px * 320px</p>
                            <div class="controls">
                              <div data-provides="fileupload" class="fileupload fileupload-new">
                                <div style="width: 200px; height: 150px;" class="fileupload-new thumbnail">
                                  <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/no_image.gif')}" alt="no_image" styleclass="viewDefNoImage"   style="width: auto; border: 0 none;"/>
                                </div>
                                <div style="max-width: 200px; max-height: 150px; line-height: 20px;" class="fileupload-preview fileupload-exists thumbnail"></div>
                                <div> <span class="btnAthena btn-file"><span class="fileupload-new">Select image</span> <span class="fileupload-exists">Change</span>
                                  <apex:inputFile styleclass="default" value="{!BoardAttach.body}" filename="{!BoardAttach.name}" contentType="{!BoardAttach.contentType}"/>
                                  </span> </div>
                              </div>
                              <span class="label label-important">NOTE!</span> <span>Attached image thumbnail is
                              supported in Latest Firefox, Chrome, Opera,
                              Safari and Internet Explorer 10 only </span> </div>
                          </div>
                          <div class="check ShowDefaultImage clearB" style="display: none" id="DefaultDrop">
                            <div class="control-group">
                              <label class="control-label">Select Default Image </label>
                              <div class="controls" style="min-height: 200px">
                                <apex:selectList multiselect="false" size="1" value="{!dropDefaultSelected}" id="dropDefault" onchange="defaultImgChanged(this, '{!getStaticImagePath}')" >
                                  <apex:selectOptions value="{!DefaultBoardImage}" ></apex:selectOptions>
                                </apex:selectList>
                                <div class="viewDefaultImage thumbnail">
                                  <apex:image id="imgDefault" url="{!URLFOR($Resource.img_athena, 'img_athena/no_image.gif')}" alt="no_image" styleclass="viewDefNoImage"/>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="modal-footer">
                          <button class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true">Cancel</button>
                          <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"  action="{!BoardImageupload}" value="Save" id="theButton"/>
                        </div>
                      </div>
                      <!--<img class="ComBoardImage_img" src="img_athena/BoardImage1.png" />-->
                      <apex:outputPanel rendered="{!!CommunityStaticImage}">
                        <apex:image url="{!URLFOR($Action.Attachment.Download, AttachmentId)}" styleClass="ComBoardImage_img" />
                      </apex:outputPanel>
                      <apex:outputPanel rendered="{!CommunityStaticImage}"> <img src='{!CommunityDefaultImageName}' class="ComBoardImage_img" /> </apex:outputPanel>
                    </div>
                    <div style='white-space: pre-line;'>
                      <apex:inputTextarea id="txtCommunityDesc"   styleclass="span12 comDescriptionT"   value="{!CommunityDescription}" title="Enter Community Description"/>
                    </div>
                  </div>
                  <div class="controls mtop10 mbot10 clearfix"> <span class="mr10 publishCheckBG">
                    <apex:inputCheckbox value="{!CommunityPublish}" id="chkPublish"> </apex:inputCheckbox>
                    Publish </span> <span class="mr10">
                    <apex:inputCheckbox value="{!CommunityPublic}" id="chkFeatured"> </apex:inputCheckbox>
                    Public </span> <span class="mr10">
                    <apex:inputCheckbox disabled="{!!IsModerator}" value="{!CommunityFeatured}" id="chkCommunityFeatured"> </apex:inputCheckbox>
                    Featured </span> <span class="pull-right mtop10">
                    <apex:commandButton styleclass="btnAthena btn_cancel"  action="{!DoCommunityCancel}" id="btnHeaderBoardCancel"  value="Cancel"/>
                    <apex:commandButton styleclass="btnAthena btn-primary"  action="{!UpdateCommunity}" id="btnHeaderCommunitySave"  value="Save"  />
                    </span> </div>
                </div>
                <div id="DeleteCategory" class="modal hide fade" tabindex="-1" role="dialog" style="width:800px; left:43%;" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                  <div class="modal-body">
                    <div class="row-fluid">
                      <div class="span12">
                        <div class="control-group">
                          <label class="control-label">Are you sure you want to Delete Category ? <br />
                            <span style="color:red">Note: All Contents will be deleted</span></label>
                          <div style="display:none">
                            <apex:inputText id="txtDeleteCId" value="{!DeleteCategoryId}" ></apex:inputText>
                          </div>
                          <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="No" />
                          <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"    action="{!DeleteCommunityCategory}" value="Yes" id="btnDeleteCategory"/>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div id="persistDiv" style="display:none">
                  <apex:inputText id="txtPersist" value="{!PersistTab}" ></apex:inputText>
                </div>
                <div id="CommunityChangeOrderPopup" class="modal hide fade PositionR" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" data-backdrop="static" aria-hidden="true" style="width: 55%;">
                  <div class="modal-header">
                    <h3>Change Category Order</h3>
                  </div>
                  <div class="modal-body">
                    <div style="display:none">
                      <apex:inputText id="txtOrderCategoryName"  value="{!OrderCommunityCategoryName}"></apex:inputText>
                      <apex:inputText id="txtOrderCategoryId"  value="{!OrderCommunityCategoryId}"></apex:inputText>
                    </div>
                    <div style="display:none">
                      <apex:inputText id="txtTopicChangeOrderID"  value="{!CommCategoryChangeOrder}"></apex:inputText>
                    </div>
                    
                    <!--                <div class="span10 mtop20 changeOrder">
                          <div class="clearB mtop10 clearfix">
                            <div class="pull-left span10">
                            <select id="list-box" multiple="multiple" size="5" class="span12" style="height:250px">
                            </select>
                            </div>
                            <div class="pull-left p5 mtop10P">
                                <button id="move-up" type="button" class="btnAthena btn-primary" title="Move Up" value="Move Up"> &#9650; </button> <br />
                                <button id="move-down" type="button" class="btnAthena btn-primary" title="Move Down"  value="Move Down"> &#9660; </button> 
                            </div>
                          </div>
                        </div>--> 
                  </div>
                  <div class="modal-footer">
                    <button class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true">Cancel</button>
                    <!--<apex:commandButton styleclass="btnAthena btn-primary"  action="{!SaveCommunityChangeOrder}" value="Save" onclick="SaveTopicsChangeOrder(this)" id="CommandButton9"/>--> 
                  </div>
                </div>
                <div id="EditCategory" class="modal hide fade" tabindex="-1" role="dialog" style="width:800px; left:43%;" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                  <div class="modal-body">
                    <div class="row-fluid">
                      <div class="span12">
                        <div class="control-group">
                          <label class="control-label">Name</label>
                          <div class="controls controls-row">
                            <apex:inputText id="txtEditCategory"  maxlength="100" styleclass="input-block-level" value="{!EditCategoryNm}"    title="Enter Category Name" />
                          </div>
                          <div class="alert alert-error" style="display:none" id="Div4"> </div>
                        </div>
                      </div>
                    </div>
                    <div style="display:none">
                      <apex:inputText id="txtEditCId" value="{!EditCategoryId}" ></apex:inputText>
                    </div>
                    <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="Cancel" />
                    <!--<input type="button" class="btnAthena btn-primary btnAthenaPopP"  value="Save"  id="Button3"   /> -->
                    <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"    action="{!EditCategory}" value="Save" id="btnEditCategory"/>
                  </div>
                </div>
                <div id="AddCategory" class="modal hide fade" tabindex="-1" role="dialog" style="width:800px; left:43%;" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                  <div class="modal-body">
                    <div class="row-fluid">
                      <div class="span12">
                        <div class="control-group">
                          <label class="control-label">Name</label>
                          <div class="controls controls-row">
                            <apex:inputText id="txtCtgryNm"  maxlength="50" styleclass="input-block-level" value="{!CategoryName}"    title="Enter Category Name" />
                          </div>
                          <div class="alert alert-error" style="display:none" id="showDuplicateTName"> </div>
                        </div>
                        
                        <!--<div class="control-group">
                                          <label class="control-label">Description </label>
                                          <div class="controls controls-row">
                                              <apex:inputTextarea id="txtCtgryDesc"   styleclass="span12"   value="{!CategoryDesc}" title="Enter Category Description" />
                                            
                                          </div>
                                        </div>--> 
                      </div>
                    </div>
                    <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="Cancel" />
                    <input type="button" class="btnAthena btn-primary btnAthenaPopP"  value="Save"  id="CategorySave"  onclick="VerifyDuplicateCategoryName()" />
                    <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"  style="display:none"   action="{!CreateCategory}"  value="Save" id="SaveCategory"/>
                  </div>
                </div>
                
                <!-- Start Add Topics -->
                <div id="AddTopics" class="modal hide fade" tabindex="-1" role="dialog" style="width:800px; left:43%;" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">

          <div class="modal-body">
            <div class="TABclass">
              <ul class="nav nav-tabs" id="myTab">
                <li class="active"><a data-toggle="tab" href="#SearchTopics" ><span class="icon-search"></span> Search Existing Content </a></li>
                <li><a data-toggle="tab" href="#CreateNewTopics"><span class="icon-plus"></span> Create New Content </a></li>
              </ul>
              <div class="tab-content" id="myTabContent">
                <div id="SearchTopics" class="tab-pane fade active in">
                  <div class="row-fluid">
                    <div class="span12">
                      <div class="span9">
                        <div class="control-group">
                          <div class="pull-left colorBlue">
                            <h1 class="control-label">Category :</h1>
                          </div>
                          <div class="pull-left mtop5">
                            <label class="control-label"  id="lblCtgryName"></label>
                          </div>
                          <div class="controls controls-row">
                            <input type="text" class="input-block-level" value="" id="txtLearningBrd"  html-Placeholder="Search Topics" onkeydown="SearchTopic(event)"/>
                          </div>
                        </div>
                      </div>
                      <div class="span2">
                        <input type="button" class="btnAthena btn-primary mtop30" value="Search" onclick="SearchLearningBoard()"/>
                      </div>
                      <div class="alert alert-error clearB" style="display:none" id="emptySearchTopic"> </div>
                      <!-- Commented By Komala <p class="searchResult clearB" id="divSearchTopicResult"  style="display:none">Search Topic result </p> --> 
                      
                    </div>
                  </div>
                  <!-- START By Komala -->
                  
                  <div class="TABclass clearB" id="dvExternalSearch">
                    <ul class="nav nav-tabs">
                      <li><a href="#searchExternal" data-toggle="tab">Search result <span class="countNum">(<span id="SearchRes"></span>)</span> </a></li>
                    </ul>
                    <div class="tab-content">
                      <div class="tab-pane active" id="searchExternal">
                      <div class="searchResult clearB" id="divSearchTopicResult" style="display:none">Search result </div>
                        <div class="AddLearningSearchDivB" id="ExternalSearch"> </div>
                      </div>
                    </div>
                  </div>
                  <!-- End By Komala -->
                  
                  <div class="row-fluid">
                    <div class="span12 AddLearningSearchDiv" id="Div2"  style="display:none"> </div>
                  </div>
                  <div id="SearchTopicDiv"  style="display:none">
                    <apex:inputText id="txtSearchTopic"  value="{!SearchTopicIds}"></apex:inputText>
                    <apex:inputText id="txtSearchCtgry"  value="{!SearchCtgry}"></apex:inputText>
                  </div>
                  <div class="mbot20">
                    <div class="controls mtop10"> <span class="pull-right mtop30">
                      <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" id="btnExternalSearch" value="Cancel" />
                      </span> </div>
                  </div>
                </div>
                <div id="CreateNewTopics" class="tab-pane fade ">
                  <div class="row-fluid">
                    <div class="span12">
                      <div class="control-group">
                        <div class="alert alert-error" style="display:none" id="emptyImageUpLoad"> </div>
                        <!-- <h1 class="catHeading">What Category</h1>
                                        <hr />-->
                        <div class="pull-left colorBlue">
                          <h1 class="control-label">Category :</h1>
                        </div>
                        <div class="pull-left mtop5">
                          <label class="control-label"  id="lblCategory"></label>
                          <apex:selectList multiselect="false" size="1" value="{!CreateTopicCtgryId}" id="Ctgry" onclick="CreateCatChanged()">
                            <apex:selectOptions value="{!TopicCategory}" ></apex:selectOptions>
                          </apex:selectList>
                        </div>
                      </div>
                      <div class="control-group clearB ptop10">
                        <apex:inputHidden value="{!hdnTopicCatId}" id="hdnTopicCtgry" />
                        <label class="control-label">Type</label>
                        <div class="controls controls-row">
                          <apex:selectList styleclass="span12 "  multiselect="false" size="1" value="{!CreateTypeOfTopic}" id="LearningTopic"  onchange="ShowTopicOnType(this)">
                            <apex:selectOptions value="{!LearningType}" ></apex:selectOptions>
                          </apex:selectList>
                        </div>
                      </div>
                      <div class="mbot20" id="dvInitTopicCancel">
                        <div class="controls mtop10"> <span class="pull-right mtop30">
                          <input type="button" id="btnInitTopicCancel" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="Cancel" />
                          </span> </div>
                      </div>
                      <div  id="divTopicCommon" style="display:none">
                        <div class="control-group">
                          <label class="control-label">Name</label>
                          <div class="controls controls-row">
                            <apex:inputText id="txtTopic"  maxlength="100" styleclass="input-block-level" value="{!CreateTopicName}"  onblur="VerifyDuplicateTopicName(this)"  title="Enter Content Name" />
                          </div>
                          <div class="alert alert-error" style="display:none" id="showDuplicateTName"> </div>
                        </div>
                        <div class="control-group">
                          <label class="control-label">Description </label>
                          <div class="controls controls-row">
                            <apex:inputTextarea id="txtTopicArea"   styleclass="span12"   value="{!CreateTopicDesc}" title="Enter Content Description" />
                          </div>
                        </div>
                        <div id="urlLearning" style="display:none"  class="span12 ml0 mtop10 clearB" >
                          <label>URL <span class="colorWarning warningImg" style="display:none" id="spnNoticeMessage"></span></label>
                          <span>
                          <apex:inputText id="InputTextURL" styleclass="span10" value="{!CreateTopicVideoURL}"/>
                          <!--<apex:commandButton styleclass="btnAthena btn-primary mtop-10" action="{!ShowVideoPreview}" value="Test"  />-->
                          <button type="button" class="btnAthena btn-primary mtop-10" id="playvideo"  onclick="openLinkInNewWindow1()">Test</button>
                          
                          <!--<iframe id="video1" width="520" height="360"  frameborder="0" ></iframe>--> 
                          
                          </span> </div>
                      </div>
                      <div class="span5 ml0 mtop10 clearB"  id="VideoLearning"  style="display:none"> <span> 
                        <!-- <apex:inputText id="txtVideoURL" styleclass="span10" value="{!LVideoURL}"/>
                                                              
                                                                <button type="button" class="btnAthena btn-primary mtop-10">Test</button>--> 
                        <span class="colorBlue">Video Preview</span><br />
                        <span>
                        <div class="span10">
                          <apex:image id="novideo" url="{!URLFOR($Resource.img_athena, 'img_athena/no_video.png')}" alt="no_video" styleClass="span12"/>
                          <iframe   id="testvideo" frameborder="0"   scrolling="no" class="borderV" style="display:none"></iframe>
                        </div>
                        </span> <br />
                        </span>
                        <p class="span12 BoardImgList ml0 clearB"> </p>
                      </div>
                      <div class="mbot20 clearB"  id="TopicCheckPublish"  style="display:none">
                        <hr />
                        <div class="controls mtop10"> <span class="mr10 publishCheckBG">
                          <apex:inputCheckbox value="{!CreateTopicPublish}" id="AddTopicPublish"/>
                          Publish </span> <span class="mr10">
                          <apex:inputCheckbox value="{!CreateTopicClientFacing}" id="AddTopicCF"  />
                          Client Facing </span> <span class="mr10">
                          <apex:inputCheckbox value="{!CreateTopicPracticeApprv}"  id="AddTopicPA"/>
                          Practice Approved </span>
                          <div style="display:none">
                            <apex:inputText id="txtCategoryType" styleclass="span10" value="{!CategoryType}"/>
                          </div>
                          <span class="pull-right mtop30">
                          <div id="TextUrlLink"  style="display:none" >
                            <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="Cancel" />
                            <input type="button" class="btnAthena btn-primary btnAthenaPopP" value="Save"  id="SaveAndNext"  onclick="funcVerifyDuplicateTopic(this)"/>
                                                        <apex:inputText id="hdnOperatingSystem" style="display:none"  value="{!OperatingSystem}"/>
                            <apex:inputText id="hdnBrowser" style="display:none"  value="{!Browser}"/>
                            <apex:inputText id="hdnDeviceType" style="display:none"  value="{!DeviceType}"/>
                            <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"  style="display:none"   action="{!CreateLearningAndAssociate}" value="Save" id="SaveTopic"/>
                          </div>
                          <div  id="UpLoadDoc"  style="display:none" >
                            <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="Cancel" />
                            <input type="button" class="btnAthena btn-primary btnAthenaPopP"  value="Next"  onclick="funcVerifyDuplicateTopicUpload(this)"/>
                            <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"  style="display:none"   action="{!CreateLearningAndAssociate}" value="Next"  id="NextCreateTopic"/>
                          </div>
                          </span> </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
       <!-- End Add Topics By Komala --> 
       
         <!-- Start Model PopUp -->
  
  <div id="GlobalSearch" class="modal hide fade" tabindex="-1" role="dialog" style="width:800px; left:43%;" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
          <div class="modal-header">
            <h3>Create New Content</h3>
          </div>
          <div class="modal-body">
            <div class="row-fluid">
              <div class="span12">
                <div class="control-group clearfix">
                  <div class="alert alert-error" style="display:none" id="DivDuplicateIdolTName"> </div>
                  <div class="pull-left colorBlue">
                    <h1 class="control-label pl0">Category :</h1>
                  </div>
                  <div class="pull-left mtop5">
                    <label class="control-label"  id="lblGblCtgry" ></label>
                    <apex:selectList multiselect="false" size="1" value="{!CreateSearchTopicCtgryId}" id="TopicCtrgy" >
                      <apex:selectOptions value="{!TopicCategory}" ></apex:selectOptions>
                    </apex:selectList>
                  </div>
                </div>
                
                <!--                                      <div class="control-group">
                                          <label class="control-label">Category:</label>

                                          </div>-->
                <div class="control-group clearfix">
                  <div class="pull-left colorBlue">
                    <h1 class="control-label pl0">Type : </h1>
                  </div>
                  <div class="pull-left mtop5">
                    <label class="control-label"  >Link</label>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label">Content</label>
                  <div class="controls controls-row">
                    <apex:inputText id="SearchTopicNm" styleclass="input-block-level" value="{!RTopicName}"/>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label">Description </label>
                  <div class="controls controls-row">
                    <apex:inputTextarea rows="15" id="SearchTopicDesc"   styleclass="span12"   value="{!RTopicDescription}" title="Enter Content Description"/>
                  </div>
                </div>
                <div id="Div7"  class="ml0 mtop10" >
                  <label>URL <span class="colorWarning"></span></label>
                  <span>
                  <apex:inputText id="SearchLinkUrl" styleclass="span10" value="{!RLink}"/>
                  <!--<apex:commandButton styleclass="btnAthena btn-primary mtop-10" action="{!ShowVideoPreview}" value="Test"  />-->
                  <button type="button" class="btnAthena btn-primary mtop-10" id="Button2"  onclick="openLinkInNewWindow()">Test</button>
                  </span> </div>
                <hr />
                <div class="mbot20"  id="Div9"  >
                  <div class="controls mtop10"> <span class="mr10 publishCheckBG">
                    <apex:inputCheckbox value="{!RTopicPublish}"  id="InputCheckbox1"/>
                    Publish </span> <span class="mr10">
                    <apex:inputCheckbox value="{!RTopicClientFacing}"  id="InputCheckbox2" />
                    Client Facing </span> <span class="mr10">
                    <apex:inputCheckbox value="{!RTopicPracticeApprv}" id="InputCheckbox3" />
                    Practice Approved </span> <span class="pull-right">
                    <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="Cancel" />
                    <input type="button" class="btnAthena btn-primary btnAthenaPopP"  value="Save"  id="Button4"  onclick="funcIdolCreateTopic()"  />
                    <apex:inputHidden id="hdnCategoryIdForExternalSearch" value="{!CategoryIdForExternalSearch}"/>
                    <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP" style="display:none"  action="{!CreateIdolSearchTopic}" value="Save" id="btnIdolSave"/>
                    </span> </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--End Search Global Results -->
                 
                <!--- Delete Topic -->
                <div id="DeleteTopics" class="modal hide fade" tabindex="-1" role="dialog" style="width:800px; left:43%;" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                  <div class="modal-header">
                    <h3>Are you sure you want to delete Content ?</h3>
                  </div>
                  <div class="controls mtop10" >
                    <div id="DeleteTopicId" style="Display:none">
                      <apex:inputText id="txtTId" value="{!DTopicId}" />
                    </div>
                    <div class="modal-body"> <span class="pull-right mtop30">
                      <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="No" />
                      <apex:commandButton styleclass="btnAthena btn-primary"  action="{!DeleteTopic}" value="Yes" id="RemoveTopic"  onclick="RemoveTopicDlog()"/>
                      </span> </div>
                  </div>
                </div>
                
                <!--- Edit Topic-->
                <div id="EditTopics" class="modal hide fade" tabindex="-1" role="dialog" style="width:800px; left:43%;" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                  <div class="modal-header">
                    <h3>Edit Content</h3>
                  </div>
                  <div class="modal-body">
                    <div class="row-fluid">
                      <div class="span12">
                        <div class="control-group"> 
                          <!-- <h1 class="catHeading">What Category</h1>
                                        <hr />-->
                          <div class="alert alert-error" style="display:none" id="errorMsgForEdit"> </div>
                          <label class="control-label">Category</label>
                          <div class="controls controls-row">
                            <apex:selectList multiselect="false" size="1" value="{!TopicCtgryId}" id="TopicCategory"  onclick="EditCatChanged()">
                              <apex:selectOptions value="{!TopicCategory}" ></apex:selectOptions>
                            </apex:selectList>
                          </div>
                          <apex:inputHidden value="{!hdnTopicCatId}" id="InputHidden1" />
                          <div class="pull-left colorBlue">
                            <h1 class="control-label">Type :</h1>
                          </div>
                          <div class="pull-left mtop5">
                            <label class="control-label"  id="lblTopicType" data-TypeId=""></label>
                          </div>
                          
                          <!--  <label class="control-label">Type</label>-->
                          <div class="controls controls-row">
                            <apex:selectList styleclass="span12 "  multiselect="false" size="1" value="{!TypeOfTopic}" id="TypeOfTopic"  >
                              <apex:selectOptions value="{!LearningType}" ></apex:selectOptions>
                            </apex:selectList>
                          </div>
                        </div>
                        <div id="EditTopicId"  style="display:none">
                          <apex:inputText id="txtEditTopicId" value="{!TopicId}" styleclass="input-block-level" > </apex:inputText>
                        </div>
                        <div id="hideEditTopic" style="display:none">
                          <apex:inputText id="txtHideTopic" styleclass="input-block-level" value="{!TopicName}"/>
                        </div>
                        <div  id="EditCommonTopic" style="display:none">
                          <div class="control-group">
                            <label class="control-label">Content</label>
                            <div class="controls controls-row">
                              <apex:inputText id="txtEditTopicName" styleclass="input-block-level" value="{!TopicName}"/>
                            </div>
                          </div>
                          <div class="control-group">
                            <label class="control-label">Description </label>
                            <div class="controls controls-row">
                              <apex:inputTextarea id="txtEditTopicDesc"   styleclass="span12"   value="{!TopicDesc}" title="Enter content Description"/>
                            </div>
                          </div>
                          <div id="EditUpload" style="display:none"  class="span12 ml0 mtop10 clearB borderV" >
                            <div class="m10"> Upload a new document or replace an existing one. <br/>
                              <span id="hdnLURLCaption">Current uploaded document: </span><a href="" id="hdnLURLlink" target="_blank">abc</a> <span>
                              <apex:canvasApp canvasId="capp" applicationName="SLP_File_Upload" width="90%" height="275px" scrolling="no"/>
                              </span>
                              <input type='button' onClick="UploadFile('edit')" Value="Upload File" style="padding-left:20px" class="btnAthena btn-primary"/>
                            </div>
                          </div>
                          <div id="EditLinkDoc" style="display:none"  class="span5 ml0 mtop10 clearB" >
                            <label  style="width:780px"> URL <span class="colorWarning warningImg" id="spnEditNoteVideoMsg"></span> </label>
                            <label  id="lblTopicUrl" style="width:780px"></label>
                            <span>
                            <apex:inputText id="txtEditVideoURL" styleclass="span10" value="{!TopicVideoURL}"/>
                            <!--<apex:commandButton   styleclass="btnAthena btn-primary mtop-10" action="{!ShowVideoPreview}" value="Test"  />-->
                            <button type="button" class="btnAthena btn-primary mtop-10" id="Button1"  onclick="EditopenNewWindow()">Test</button>
                            
                            <!--<iframe id="video1" width="520" height="360"  frameborder="0" ></iframe>--> 
                            
                            </span> </div>
                        </div>
                        <div class="span5 ml0 mtop10 clearB"  id="EditTopicVideo"  style="display:none"> <span> 
                          <!-- <apex:inputText id="txtVideoURL" styleclass="span10" value="{!LVideoURL}"/>
                                                              
                                                                <button type="button" class="btnAthena btn-primary mtop-10">Test</button>--> 
                          <span class="colorBlue">Video Preview</span><br />
                          <span>
                          <div class="span10">
                            <apex:image style="display:none" id="DefaultVideo" url="{!URLFOR($Resource.img_athena, 'img_athena/no_video.png')}" alt="no_video" styleClass="span12"/>
                            <iframe id="EditVideoURL" frameborder="0"   scrolling="no" ></iframe>
                          </div>
                          </span> <br />
                          <div class="clearB"><a>View instructions for uploading Brainshark videos</a></div>
                          <br />
                          <span>YouTube video must be in below format</span><br />
                          <span>http ://www.youtube.com/watch?v=TSNLsBiep31 </span> </span>
                          <p class="span12 BoardImgList ml0 clearB"> </p>
                        </div>
                        <div class="clearB">
                          <hr />
                          <div class="mbot20"  id="EditCommonchkBox"  style="display:none">
                            <div class="controls mtop10"> <span class="mr10 publishCheckBG">
                              <apex:inputCheckbox value="{!TopicPublish}"  id="chkTopicPublish"/>
                              Publish </span> <span class="mr10">
                              <apex:inputCheckbox value="{!TopicClientFacing}"  id="chkTopicCF" />
                              Client Facing </span> <span class="mr10">
                              <apex:inputCheckbox value="{!TopicPracticeApprv}" id="chkTopicPA" />
                              Practice Approved </span> <span class="pull-right mtop30"> 
                              <!-- <apex:commandButton styleclass="btnAthena"  action="{!CancelTopic}" value="Cancel" id="CommandButtonCancel"/> -->
                              <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="Cancel" />
                              <input type="button" class="btnAthena btn-primary btnAthenaPopP"  value="Save"  id="Button2"  onclick="UpdateTopicTags(this)"/>
                              <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP" style="display:none"    action="{!UpdateTopic}" value="Save" id="btnEditTopic"/>
                              </span> </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--- End Edit Topic --> 
                <!--- Start Fileupload -->
                <div id="UploadFile" class="modal hide fade" tabindex="-1" style="width:800px; left:43%;" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                  <div class="modal-header">
                    <h3>Upload Document</h3>
                  </div>
                  <div class="modal-body">
                    <div id="uploadLearning" class="span12 ml0 mtop10" > <span>Upload a new document or replace an existing one. </span> <span>
                      <apex:canvasApp canvasId="cappCreate" applicationName="SLP_File_Upload" width="90%" height="275px" scrolling="no" />
                      </span> </div>
                  </div>
                  <div class="modal-footer">
                    <apex:commandButton id="btnCancelUploadFile" Styleclass="btnAthena btn_cancel" action="{!CancelUploadClick}" value="Cancel" />
                    <input type='button' onClick="UploadFile('create')" Value="Upload File" style="padding-left:20px" class="btnAthena btn-primary"/>                    
                    <apex:inputHidden value="{!hdnPendingFileUploadTopicId}" id="hdnPendingFileUploadTopicId" />
                  </div>
                </div>
                <!--- End Fileupload -->
                
                <div class="row-fluid">
                  <div class="TABclass">
                    <ul class="nav nav-tabs" id="myTab">
                      <li class="active" id="liCollateral"><a data-toggle="tab" href="#Collateral">Content</a></li>
                      <li id="liActivity" style="display:none"><a data-toggle="tab" href="#Activity">Chat</a></li>
                      <li id="liMembers"><a data-toggle="tab" href="#Members">Members</a></li>
                      <li id="liBoard"><a data-toggle="tab" href="#Board">Related Boards</a></li>
                      <li id="liPrivateMembers"><a data-toggle="tab" href="#PMemAccess" id="PMemberAcc">Provide Member Access</a></li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                      <div id="Activity" class="tab-pane fade active in"> </div>
                      <div id="Collateral" class="tab-pane fade active in">
                        <div>
                          <div class="clearB clearfix"> <a class='btnAthena btn-inverse pull-right' style="display:none"  onclick="CommunityChangeOrder()"><span class="icon-sort-by-order"></span></a> <a class='btnAthena btn-inverse pull-right' data-toggle='modal' style="margin-right:3px"  onclick='AddCreateCategory()'><span class='icon-plus'></span> Add Category</a> </div>
                          <div id="divCategory" class="clearB clearfix mtop10"></div>
                        </div>
                      </div>
                      <div id="Board" class="tab-pane fade">
                        <p class="searchResult"> <a class="ml10" data-toggle="modal" onClick="AddRelCommunityBoards()"><span class="icon-plus"></span> Add Boards</a></p>
                        <div id="AddBoards" class="modal hide fade PositionF" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                          <div class="modal-header">
                            <h3>Add Boards</h3>
                          </div>
                          <div class="modal-body">
                            <div class="row-fluid">
                              <div class="span12">
                                <div class="span8"> <span>
                                  <input type="text" placeholder="Enter title of learning board" id="txtAddRelative" class="span11"  onkeydown="SubmitAddBoardSearch(event);"/>
                                  </span> </div>
                                <div class="span4">
                                  <input type="button" value="Search" class="btnAthena btn-primary" onClick="SearchAddRelatedBoard()" />
                                </div>
                                <div class="alert alert-error clearB pull-left mr30" style="display:none" id="dvReleatedBoardErrorMsg"></div>
                                <div class="clearB">
                                  <label>Available boards :</label>
                                  <div id="AddRelative" class="AddLearningSearchDiv clearB"></div>
                                </div>
                              </div>
                            </div>
                            <div class="modal-footer">
                              <apex:inputHidden value="{!hdnRelatedLB}" id="hiddenRelatedSearch" />
                              <button class="btnAthena EbtnLess btn_cancel mr3" data-dismiss="modal" aria-hidden="true" onClick="ClearAddRelatedBoardFields()">Cancel</button>
                              <input type="button" value="Add" class="btnAthena btn-primary btnAthenaPopP" onClick="SaveRelatedBoard(this)" />
                              <apex:commandButton action="{!SaveRelatedLB}" value="Search" id="btnRelatedBoard" title="" style="display:none;"/>
                            </div>
                          </div>
                        </div>
                        <div id="Boards" class="tab-pane fade active in">
                          <p class="searchResult">
                          <h2></h2>
                          </p>
                          <div>
                            <apex:repeat value="{!RelatedLearningBoards}" var="brdRslt"> 
                              <script>

                                  var Id = '{!brdRslt.LBid}';
                                  var RatingNbr = '{!brdRslt.AvgRating}';
                                  listBoardIds.push({ "ID": Id, "RatingNbr": RatingNbr });
                       </script>
                              <div class="hpit_athena_ca-item hpit_athena_ca-item-2">
                                <li class="dropdown ErelatedB_remove" id="Li2"> <a class="icon-remove-sign removeCBbtn fs16" id="A3" onClick="RemoveCommunityBoard('{!brdRslt.Lbid}')"></a> </li>
                                <div class="hpit_athena_ca-item-main">
                                  <div class="hpit_athena_ca-item-firstHalf">
                                    <div class="hpit_athena_ca-item-topBar">
                                      <div class="hpit_athena_ca-item-topBarDate">
                                        <apex:OutputText value="{0,date,MMM dd}">
                                          <apex:param value="{!brdRslt.LBCrtDate}"/>
                                        </apex:outputtext>
                                      </div>
                                      <div class='ratingDispalyL' id='ratingBoard_{!brdRslt.LBid}' style="display:none;"></div>
                                      <div class="hpit_athena_ca-item-topBarChat">
                                        <div class="hpit_athena_ca-item-topBarChatImg">
                                          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/hpit_athena_chatIcon.png')}" width="14" height="14" alt="hpit_athena_chatIcon"/>
                                        </div>
                                        <div class="hpit_athena_ca-item-topBarChatValue"> {!brdRslt.LBNoOfComments} </div>
                                      </div>
                                    </div>
                                    <div class="ca-icon"> <a class="hpit_athena_ca_itemLink ratingMouseOver" href="/apex/AthenaLearningBoardDtls?id={!brdRslt.LBid}&CommunityId={!CommunityId}" id= "anchorBoard_{!brdRslt.LBid}" data-boardLBid = 'ratingBoard_{!brdRslt.LBid}' onmouseover='ShowBoardRating(this)' onmouseleave = 'HideBoardRating(this)'>
                                      <apex:outputPanel rendered="{!!brdRslt.StaticImage}">
                                        <apex:image url="{!URLFOR($Action.Attachment.Download, brdRslt.AttachmentId)}" />
                                      </apex:outputPanel>
                                      <apex:outputPanel rendered="{!brdRslt.StaticImage}"> <img src='{!brdRslt.DefaultImageName}'/> </apex:outputPanel>
                                      </a> </div>
                                  </div>
                                  <a class="a_underNone">
                                  <div class="hpit_athena_ca-item-BottomBar"> <a class="hpit_athena_ca_itemA" href="/apex/AthenaLearningBoardDtls?id={!brdRslt.LBid}&CommunityId={!CommunityId}">
                                    <h3>{!brdRslt.LBName}</h3>
                                    </a> </div>
                                  </a>
                                  <div class="hpit_athena_ca-item-SecondHalf">
                                    <div class="hpit_athena_ca-item-person cf">
                                      <div class="hpit_athena_ca-item-personPhoto">
                                        <apex:image value="{!brdRslt.OwnerPhotoUrl}" width="35" height="35" alt="no_username_small"/>
                                      </div>
                                      <a class="a_underNone">
                                      <div class="hpit_athena_ca-item-personName"> <a class="hpit_athena_ca_itemLink" href="/apex/AthenaUserProfile?id={!brdRslt.LBOwnerID}"> {!brdRslt.LBOwnerName} </a> </div>
                                      </a>
                                      <div class='hpit_athena_ca-item-personName hpit_athena_ca-item-personD hpit_athena_ca-item-personNameS'>{!IF((brdRslt.LBOwnerTitle==null),'',brdRslt.LBOwnerTitle)}</div>
                                    </div>
                                    <div class="hpit_athena_ca-item-PersonPost">
                                      <p>{!brdRslt.LBDescription}</p>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </apex:repeat>
                            <div id="dvRelatedBoardRemove" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                              <div id="Div3" style="Display:none">
                                <apex:inputText id="hdrlbrdId" value="{!hdnRelBrdId}" />
                              </div>
                              <div class="modal-header">
                                <h3>Are you sure you want to delete Related Board?</h3>
                              </div>
                              <div class="modal-body">
                                <p> </p>
                              </div>
                              <div class="modal-footer">
                                <input type="button" class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true" value="No" />
                                <apex:commandButton styleclass="btnAthena btn-primary"  action="{!RemoveCommunityBoard}" value="Yes" id="CommandButton6"/>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div id="Members" class="tab-pane fade ">
                        <apex:repeat value="{!CommunityMembers}" var="peopleRslt">
                          <div class="span4 PFspace">
                            <div class="span2 PFimg"> <img src='{!peopleRslt.SmallPhotoUrl}' /> </div>
                            <div class="span9">
                              <li class="mtop10"><a href="/apex/AthenaUserProfile?id={!peopleRslt.id}" target="_top">{!peopleRslt.Name}</a></li>
                              <li>{!peopleRslt.Title}</li>
                            </div>
                          </div>
                        </apex:repeat>
                        <!--<div class="span4 PFspace">
                                                <div class="span2 PFimg">
                                                    <img src="img_athena/no_username.jpg" />
                                                </div>
                                                <div class="span9">
                                                    <li class="mtop10"><a href="" target="_top">Fernando, Anto</a></li>
                                                    <li>Development Services </li>
                                                </div>
                                            </div>
                                            <div class="span4 PFspace">
                                                <div class="span2 PFimg">
                                                    <img src="img_athena/no_username.jpg" />
                                                </div>
                                                <div class="span9">
                                                    <li class="mtop10"><a href="" target="_top">Fernando, Anto</a></li>
                                                    <li>Development Services </li>
                                                </div>
                                            </div>
                                            <div class="span4 PFspace">
                                                <div class="span2 PFimg">
                                                    <img src="img_athena/no_username.jpg" />
                                                </div>
                                                <div class="span9">
                                                    <li class="mtop10"><a href="" target="_top">Fernando, Anto</a></li>
                                                    <li>Development Services </li>
                                                </div>
                                            </div>
                                            <div class="span4 PFspace">
                                                <div class="span2 PFimg">
                                                    <img src="img_athena/no_username.jpg" />
                                                </div>
                                                <div class="span9">
                                                    <li class="mtop10"><a href="" target="_top">Fernando, Anto</a></li>
                                                    <li>Development Services </li>
                                                </div>
                                            </div>
                                            <div class="span4 PFspace">
                                                <div class="span2 PFimg">
                                                    <img src="img_athena/no_username.jpg" />
                                                </div>
                                                <div class="span9">
                                                    <li class="mtop10"><a href="" target="_top">Fernando, Anto</a></li>
                                                    <li>Development Services </li>
                                                </div>
                                            </div>--> 
                      </div>
                      <div id="divPrivateMem" style="display:none">
                        <apex:inputText id="txtPriMemAcc" value="{!PrivateMembersAccess}" />
                        <apex:inputText id="txtCommApprv" value="{!CommApproved}" />
                        <apex:inputText id="txtCommRjct" value="{!CommReject}" />
                      </div>
                      <div id="PMemAccess" class="tab-pane">
                        <div id="divPrivateMembers"></div>
                        <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"    onclick=" return validatePrivateMembers(this)"  style="display:none"  action="{!SavePrivateMemberAccess}" value="Save" id="PrivateMember"/>
                        <div class="hpit_BVP_box_c_content" style="margin-left:40px;">
                          <div class="row" id="divRegion">
                            <div class="twelve">
                              <div style="display:none">
                                <apex:inputText id="txtUserMemberIds"  value="{!UserMemberId}"></apex:inputText>
                              </div>
                              <table class="hpit_BVP_SealectBox">
                                <tr>
                                  <td class="hpit_BVP_SealectBox_L">Available
                                    <input type="text" id="searchtext_kpileft" class="SearchBox input-text" onkeyup='SearchListBox("searchtext_kpileft", "KPI_Left", "HdnKPI_Left", "CC")' />
                                    <select id="HdnKPI_Left" multiple="multiple" class="span12" style="display:none;">
                                    </select>
                                    <select id="KPI_Left" multiple="multiple" class="span12" style="height:250px">
                                    </select></td>
                                  <td class="hpit_BVP_SealectBox_Btn" style="width:40px; padding:10px;"><input type="button" class="btn btnAthena btn-primary btnAthenaPopP" style="width:38px" id="KPIMoveRight" value=">" alt="Move Right" />
                                    <input type="button" class="btn btnAthena btn-primary btnAthenaPopP" style="width:38px" id="KPIMoveLeft" value="<" alt="Move Left" />
                                    <input type="button" class="btn btnAthena btn-primary btnAthenaPopP" style="width:38px" id="KPIMoveAllRight" value=">>" alt="Move Right" />
                                    <input type="button" class="btn btnAthena btn-primary btnAthenaPopP" style="width:38px" id="KPIMoveAllLeft" value="<<" alt="Move Left" /></td>
                                  <td class="hpit_BVP_SealectBox_R">Selected
                                    <input type="text" id="searchtext_kpiright" class="SearchBox input-text" onkeyup='SearchListBox("searchtext_kpiright", "KPI_Right", "HdnKPI_Right", "KPI_Left")' />
                                    <select id="HdnKPI_Right" multiple="multiple" class="span12" style="display:none;">
                                    </select>
                                    <select id="KPI_Right" multiple="multiple" class="span12" style="height:250px">
                                    </select></td>
                                </tr>
                              </table>
                            </div>
                            <div class="twelve" id="privateMembersSave"> 
                              <!--<input type="button" id="KPIOk" class="hpit_BVP_gh_button" value="Save" title="Save" />-->
                              <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"  action="{!SaveOrUpdateMembers}" onclick="SaveOrUpdateMembers(this)" value="Save" id="btnSaveMembers"/>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="span3">
                <div class="row-fluid">
                  <div class="hpit_athena_rightDiv span12"> 
                      <div class="pull-left">
                      Community Owner
                      </div>
                      <apex:OutputPanel rendered="{!IsCommunityModeratorOrOwner}">
                      <div class="btn-group pull-right">
                        <button class="comDropBtn" data-toggle="dropdown"> <span class="icon-cog colorBlue"></span> Action  &nbsp;&nbsp;<span class="icon-angle-down colorBlue"></span></button>
                        <ul class="dropdown-menu" style=" left:-98px;">
                          <li><a href="#" onClick="OpenChangeNamePopup();" ><i class="icon-edit colorBlue"></i> Change Owner</a></li>
                          <li><a href="#" id="ExportToExcel" class="hpit_athena_ca_itemLink"  onclick="CommunityExportToExcel()"><i class="icon-signout colorBlue"></i> Export Members</a></li>
                        </ul>
                      </div>
                          </apex:outputPanel>
                    
                    
                    <!-- <apex:OutputPanel rendered="{!IsCommunityModeratorOrOwner}"> 
                    <a class="btnAthena btn-primary ml10" data-toggle="modal" title="Change Community Owner" onclick="OpenChangeNamePopup();"><span class="icon-edit"></span></a> </apex:OutputPanel> --> 
                    <!--<a class="btnAthena btn-primary ml10" href="#ChangeOwner" data-toggle="modal" title="Change Community Owner"><span class="icon-edit"></span></a>-->
                    
                    <div id="ChangeOwner" class="modal hide fade PositionF" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
                      <div class="modal-header">
                        <h3>Change Owner</h3>
                      </div>
                      <div class="modal-body">
                        <div class="span5">
                          <label>Curent Owner :</label>
                        </div>
                        <div class="span5"><span>{!CommunityOwnerDetails.Name}</span> </div>
                        <div class="span5 ml0">
                          <label>New Owner</label>
                        </div>
                        <div class="span5"> <span>
                          <apex:inputField value="{!Community__c.ownerid}" id="chgOnwerInputUser" label="CurrentOwner" />
                          </span> </div>
                      </div>
                      <div class="modal-footer">
                        <button class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true">Cancel</button>
                        <apex:inputHidden value="{!hdnChangeOwnerId}" id="hiddenChangeOwner" />
                        <apex:commandButton Styleclass="btnAthena btn-primary btnAthenaPopP" action="{!CommunityChangeOwner}" value="Save"  onclick="funcChangeOwner('{!$Component.formLB.inputUser_lkid}');" />
                      </div>
                    </div>
                    <div id="dvChangeOwnerModal" class="modal hide fade PositionF" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
                      <div class="modal-header">
                        <h3>Change Owner</h3>
                      </div>
                      <div class="modal-body">
                        <div style="display:none">
                          <input type="text" id="txtOwnerSearchResult" />
                          <apex:inputText id="txtChangeOwnerId" value="{!ChangeOwnerID}" />
                        </div>
                        Search Users:
                        <input type="text" id="txtSearchOwner" class="SearchBox input-text" onKeyDown="functionTextSearchUser(event);"/>
                        <span id="spnChangeOwnerErrorMsg" class="alert alert-error"></span>
                        <div id="divChangeOwnerResult" class='readmoreHpop'></div>
                      </div>
                      <div class="modal-footer">
                        <button class="btnAthena EbtnLess btn_cancel mr3" data-dismiss="modal" aria-hidden="true">Cancel</button>
                        <input type="button" value="Add" class="btnAthena btn-primary btnAthenaPopP" onClick="SaveOrAddOwner()" />
                        <apex:commandButton style="display:none;"  action="{!SaveOrUpdateOwner}" value="Save" id="btnSaveOrUpdateOwner"/>
                      </div>
                    </div>
                      <div class="clearB"></div>
                    <hr />
                    <div class="PFspace">
                      <div style="min-width: 50px" class="span2 PFimg">
                        <apex:image styleClass="mtop5" width="35" height="35" url="{!CommunityOwnerDetails.SmallPhotoUrl}"  />
                      </div>
                      <div class="span9">
                        <li class="mtop10"><a target="_top" href="/apex/AthenaUserProfile?id={!CommunityOwnerDetails.Id}">{!CommunityOwnerDetails.Name}</a></li>
                        <li>{!CommunityOwnerDetails.Title} </li>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row-fluid">
                  <div class="hpit_athena_rightDiv span12"> Contributors
                    <apex:OutputPanel rendered="{!IsCommunityModeratorOrOwner}"> 
                      <!--<a class="ml10" href="#AddContributors" data-toggle="modal"><span class="icon-plus"></span> Add</a>--> 
                      <a class="ml10" data-toggle="modal" id="aAddContributor" onClick="OpenContributorNamePopup();"><span class="icon-plus"></span> Add</a> </apex:OutputPanel>
                    <div id="AddContributors" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
                      <div class="modal-header">
                        <h3>Add Contributor</h3>
                      </div>
                      <div class="modal-body">
                        <div class="span5 ml0">
                          <label>New Contributor </label>
                        </div>
                        <div class="span5"> <span>
                          <apex:inputField value="{!Community__c.ownerid}" id="inputUser" label="CurrentOwner" />
                          </span> </div>
                      </div>
                      <div class="modal-footer">
                        <button class="btnAthena btn_cancel " data-dismiss="modal" aria-hidden="true">Cancel</button>
                        <apex:inputHidden value="{!hdnNewContributorId}" id="hdnNewContributor" />
                        <apex:commandButton Styleclass="btnAthena btn-primary btnAthenaPopP" action="{!AddContributor}" value="save"  onclick="AddContributor('{!$Component.formLB.inputUser_lkid}');" />
                      </div>
                    </div>
                    <div class="controls"> 
                      <!--<apex:inputhidden id="hdnUserId" value="{!UserId}"/>-->
                      <apex:inputHidden value="{!ContributorUserID}" id="hdncontributorlist" />
                      <input type="hidden" id="hdnSearchResult" />
                      <div id="UserNamePopUp" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                        <div class="modal-header">
                          <h3>Add Contributor</h3>
                        </div>
                        <div class="modal-body"> Search Users:
                          <input type="text" id="txtSearchUsers" class="SearchBox input-text" onKeyDown="functionTextSearchUser(event);"/>
                          <span id="dvctrbtrErrorMsg" class="alert alert-error"></span>
                          <div id="dvContributorsList" class='readmoreHpop'></div>
                        </div>
                        <div class="modal-footer">
                          <button class="btnAthena EbtnLess btn_cancel mr3 mr3" data-dismiss="modal" aria-hidden="true">Cancel</button>
                          <input type="button" value="Add" class="btnAthena btn-primary btnAthenaPopP" onClick="SaveOrAddContributor(this)" />
                          <apex:commandButton style="display:none;"  action="{!SaveContributors}" value="Save" id="btnSaveContributor"/>
                        </div>
                      </div>
                    </div>
                    <hr />
                    <apex:repeat value="{!Contributors}" var="cont" >
                      <div class="removeFdiv">
                        <li class="dropdown" id="Li1"> <a href="https://{!getSfInstance}/apex/AthenaUserProfile?id={!cont.id}" title="{!cont.Name}" class="hpit_athena_ca-item-personPhoto" data-toggle="dropdown">
                          <apex:image width="35" height="35" url="{!cont.FullPhotoUrl}"  />
                          </a> </li>
                        <apex:OutputPanel rendered="{!IsCommunityModeratorOrOwner}"> <a class="icon-remove-sign removeFbtn" id="btnContributorsRemove" data-contrbtrID="{!cont.id}" onClick="functionContributorsRemove(this)"></a> </apex:OutputPanel>
                      </div>
                    </apex:repeat>
                    <div id="dvModalContributor" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                      <div id="Div2" style="Display:none">
                        <apex:inputText id="txtContributorId" value="{!ContributorId}" />
                      </div>
                      <div class="modal-header">
                        <h3>Are you sure you want to delete Contributor?</h3>
                      </div>
                      <div class="modal-body">
                        <p> </p>
                      </div>
                      <div class="modal-footer">
                        <input type="button" class="btnAthena btn_cancel btn_cancel" data-dismiss="modal" aria-hidden="true" value="No" />
                        <apex:commandButton styleclass="btnAthena btn-primary"  action="{!RemoveContributor}" value="Yes" id="CommandButton1"/>
                      </div>
                    </div>
                    
                    <!--                                    <li id="header_inbox_bar" class="dropdown"><a data-toggle="dropdown" class="dropdown-toggle hpit_athena_ca-item-personPhoto" href="#2">
                                        <img width="35" height="35" src="img_athena/no_username_small.jpg" />
                                    </a></li>--> 
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- END PAGE CONTENT--> 
        </div>
        <div id="modalPreviewRequired" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
          <div class="modal-body" style="white-space: pre-line;">
            <div id="cappPDF">
              <apex:canvasApp canvasId="cappPDF" applicationName="SLP_File_Download" width="100%" scrolling="yes"/>
            </div>
            <div id="cappTXT">
              <apex:canvasApp canvasId="cappTXT" applicationName="SLP_File_Download" width="100%" scrolling="yes"/>
            </div>
            <div id="cappXLSX">
              <apex:canvasApp canvasId="cappXLSX" applicationName="SLP_File_Download" width="100%" scrolling="yes"/>
            </div>
            <div id="cappHTML">
              <apex:canvasApp canvasId="cappHTML" applicationName="SLP_File_Download" width="100%" scrolling="yes"/>
            </div>
            <div id="cappDOCX">
              <apex:canvasApp canvasId="cappDOCX" applicationName="SLP_File_Download" width="100%" scrolling="yes"/>
            </div>
            <div id="cappPPT">
              <apex:canvasApp canvasId="cappPPT" applicationName="SLP_File_Download" width="100%" scrolling="yes"/>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true">Cancel</button>
          </div>
        </div>
        <div id="VideoPopUp" class="modal hide fade modalUploadView" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
          <div class="modal-header">
            <h3 id="videoHeading"></h3>
          </div>
          <div class="modal-body">
            <iframe id="frameVideo" class='EBaddTopicLF' frameborder='0'   scrolling='no'></iframe>
          </div>
          <div class="modal-footer">
            <button class="btnAthena EbtnLess btn_cancel mr3" data-dismiss="modal" aria-hidden="true">Cancel</button>
          </div>
        </div>
        <!-- END PAGE CONTAINER--> 
      </div>
      <input type='hidden' id= 'hdnTopicId' value=''/>
      <apex:inputHidden value="{!hdnLURL}" id="hdnLURL"/>
      <input type='hidden' id= 'hdnDocId' value=''/>
      <apex:inputHidden value="{!hdnTopicCatName}" id="hdnTopicCatName"/>
    </apex:form>
    <div id="divChatter" style="display:none">
      <chatter:feed entityid="{!CommunityId}" />
    </div>
  </div> 
  
  <div id="LearningChangeOrderPopup" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" data-backdrop="static" aria-hidden="true">
    <apex:form >
      <div class="modal-header">
        <h3>Change Content Order</h3>
      </div>
      <div class="modal-body">
        <div style="display:none">
          <apex:inputText id="txtTopicOrderCategoryName"  value="{!OrderTopicCategoryName}"></apex:inputText>
          <apex:inputText id="txtTopicOrderCategoryId"  value="{!OrderTopicCategoryId}"></apex:inputText>
        </div>
        <div style="display:none">
          <apex:inputText id="txtTopicCollateralId"  value="{!CategoryChangeOrderTopicId}"></apex:inputText>
        </div>
        <div class=" mtop20 changeOrder">
          <div class="clearB mtop10 clearfix">
            <div class="pull-left">
              <select id="list-box" multiple="multiple" size="5" style="height:250px; width:350px">
              </select>
            </div>
            <div class="pull-left p5 mtop10P">
              <button id="move-up" type="button" class="btnAthena btn-primary" title="Move Up" value="Move Up"> &#9650; </button>
              <br />
              <button id="move-down" type="button" class="btnAthena btn-primary" title="Move Down"  value="Move Down"> &#9660; </button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btnAthena btn_cancel" data-dismiss="modal" aria-hidden="true">Cancel</button>
        <apex:commandButton styleclass="btnAthena btn-primary"  action="{!SaveCollateralChangeOrder}" value="Save" onclick="SaveTopicsChangeOrder(this)" id="CommandButton2"/>
      </div>
    </apex:form>
  </div>
  
  <!-- END PAGE CONTAINER--> 
  
  <!-- END PAGE --> 
  
  <!-- END CONTAINER --> 
  
  <!-- BEGIN FOOTER -->
  <div id="footer"> © Hewlett-Packard Development Company, L.P.     |     HP Restricted </div>
  <!-- END FOOTER --> 
  
  <!-- BEGIN JAVASCRIPTS --> 
  <!-- Load javascripts at bottom, this will reduce page load time
         -->
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/jquery-1.8.3.min.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/js/bootstrap.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/jquery-ui/jQuery_UI_1_10_3.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/raty/ratyViewJs.js')}"/>
  <!-- page js files -->
  
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/js/bootstrap-fileupload.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/typeahead.js')}"/>
  <!-- Add Tags  -->
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/tag-it.js')}"/>
  
  <!-- ie8 fixes --> 
  <!--[if lt IE 9]>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/excanvas.js')}"/>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/respond.js')}"/>
   <![endif]--> 
  
  <!--common script for all pages-->
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/common-scripts.js')}"/>
  <!-- canvas -->
  <apex:includeScript value="{!$Resource.athena_canvas_controller}"/>
  
  <!-- END JAVASCRIPTS --> 
  <script>

      var originalItems;
      function AddCreateCategory() {
          $('[id$=txtCtgryNm]').val('');
          $('#AddCategory').modal('show');
      }

      function getPersistTabs(ActiveTab, InactiveTab1, InactiveTab2, InactiveTab3, InactiveTab4, ActiveIn, InActiveIn1, InActiveIn2, InActiveIn3, InActiveIn4) {
          $('#' + ActiveTab).addClass('active');
          $('#' + InactiveTab1).removeClass('active');
          $('#' + InactiveTab2).removeClass('active');
          $('#' + InactiveTab3).removeClass('active');
          $('#' + InactiveTab4).removeClass('active');

          $('#' + ActiveIn).removeClass('tab-pane fade');
          $('#' + ActiveIn).addClass('tab-pane fade active in');

          $('#' + InActiveIn1).removeClass('tab-pane fade active in');
          $('#' + InActiveIn1).addClass('tab-pane fade');
          $('#' + InActiveIn2).removeClass('tab-pane fade active in');
          $('#' + InActiveIn2).addClass('tab-pane fade');
          $('#' + InActiveIn3).removeClass('tab-pane fade active in');
          $('#' + InActiveIn3).addClass('tab-pane fade');
          $('#' + InActiveIn4).removeClass('tab-pane fade active in');
          $('#' + InActiveIn4).addClass('tab-pane fade');

      }

      $(document).ready(function () {

          $('input.typeahead-devs').typeahead({
              name: 'accounts',
              local: ['']
          });

          for (var i = 0; i < listBoardIds.length; i++) {
              $('#ratingBoard_' + listBoardIds[i].ID).raty({
                  cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                  cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                  starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                  starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                  starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                  readOnly: true,
                  score: listBoardIds[i].RatingNbr,
              });
          }

          BindProvideMemberAccess();

          var collateral = 'liCollateral';
          var Activity = 'liActivity';
          var Board = 'liBoard';
          var Members = 'liMembers';
          var PrivateMembers = 'liPrivateMembers';
          var coll = 'Collateral';
          var Act = 'Activity';
          var Brd = 'Board';
          var Mem = 'Members';
          var PMember = 'PMemAccess';

          var Persist = $('[id$=txtPersist]').val();
          if (Persist == 'Collateral') {
              getPersistTabs(collateral, Activity, Board, Members, PrivateMembers, coll, Act, Brd, Mem, PMember);

              ScrollToRelativePosition('Collateral');
          }
          else if (Persist == 'Boards') {

              getPersistTabs(Board, Activity, collateral, Members, PrivateMembers, Brd, Act, coll, Mem, PMember);

              ScrollToRelativePosition('Boards');
          }
          else if (Persist == 'ProvideMemAccess') {
              getPersistTabs(PrivateMembers, Activity, collateral, Members, Board, PMember, Act, coll, Mem, Brd);

              ScrollToRelativePosition('privateMembersSave');
          }


          //var PMemberAcc={!CommunityPublic};

          //if (PMemberAcc) {
          //    $('#PMemberAcc').hide();
          //}

          originalItems = $("#list-box option");

          $("#move-up").click(moveUp);
          $("#move-down").click(moveDown);
          $("#reset-list").click(resetList);

          $('[id$=publisherDropdown]').hide();
          $('[id$=publisherAttachRypplePost]').hide();
          //LoadPrivateMemberAccess();
          //$("#Activity").append($("#divChatter"));
          //$("#divChatter").css('display', 'block');
          //$("#divChatter").show();

          $('#showLoadImg').show();
          //Hide dropdown on Contributors Modal Popup
          $("select[id$=inputUser_mlktp]").hide();
          //Disable the textbox on modal popup of contributor
          document.getElementById('{!$Component.EditTopic.inputUser}').disabled = true;
          //clear the textbox on modal popup of contributor
          document.getElementById('{!$Component.EditTopic.inputUser}').value = '';

          //Hide dropdown on change owner Modal Popup
          $("select[id$=chgOnwerInputUser_mlktp]").hide();
          //Disable the textbox on change owner popup
          document.getElementById('{!$Component.EditTopic.chgOnwerInputUser}').disabled = true;
          //clear the textbox on change owner popup
          document.getElementById('{!$Component.EditTopic.chgOnwerInputUser}').value = '';

          LoadCommunity();
          $('#publishersharebutton').val('Post');

          $('#txtSearchUsers').on('keyup paste', function () {

              var FilterResultSet = new Array();
              var hdnSearchResultVal = $('[id$=hdnSearchResult]').val();
              var ResultSet = $.parseJSON(hdnSearchResultVal);
              var value = $(this).val().toUpperCase();

              if (value === '') {
                  if (ResultSet.length > 0) {
                      $('#dvContributorsList').empty();
                      $.each(ResultSet, function (index, domElement) {

                          $('#dvContributorsList').append("<div id='trigger'><span><input type='radio' name='RelatedContributorSearch' value=" + domElement.Id + "  /></span><span class='m5' id=" + domElement.Id + ">" + domElement.Name + "</span> <div>");
                      });
                  }
                  return false;
              }

              $.each(ResultSet, function (index, domElement) {

                  var DomText = domElement.Name.toUpperCase();

                  if (DomText.indexOf(value) > -1 || DomText.indexOf(value) == 0) {
                      FilterResultSet.push({ "Id": domElement.Id, "Name": domElement.Name });
                  }
              });

              if (FilterResultSet.length > 0) {
                  $('#dvContributorsList').empty();

                  $.each(FilterResultSet, function (index, domElement) {

                      $('#dvContributorsList').append("<div id='trigger'><span><input type='radio' name='RelatedContributorSearch' value=" + domElement.Id + "  /></span><span class='m5' id=" + domElement.Id + ">" + domElement.Name + "</span> <div>");
                  });
              }
          });

      });

      function moveUp() {
          $("#list-box option:selected").each(function () {
              var listItem = $(this);
              var listItemPosition = $("#list-box option").index(listItem) + 1;

              if (listItemPosition == 1) return false;

              listItem.insertBefore(listItem.prev());
          });
      }

      function moveDown() {
          var itemsCount = $("#list-box option").length;

          $($("#list-box option:selected").get().reverse()).each(function () {
              var listItem = $(this);
              var listItemPosition = $("#list-box option").index(listItem) + 1;

              if (listItemPosition == itemsCount) return false;

              listItem.insertAfter(listItem.next());
          });
      }

      function resetList() {
          $("#list-box").html(originalItems);
      }



      function ValidateCategory() {

          $('[id$=SaveCategory]').click();
          return true;
      }

      // Utility; parse out parameter by name from URL query string
      $.urlParam = function (name) {

          var resultData = '';
          var results = new RegExp('[\\?&]' + name + '=([^&#]*)')
              .exec(window.location.href);
          if (results == null) {
              resultData = '';
          }
          else {
              resultData = results[1] || 0;
          }
          return resultData;
      }

      function LoadCommunity() {
          var CommunityId = $.urlParam('id');

          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.SLP_EditCommunity.getCommunityWithCat}',
              CommunityId,
              DisplayTopicsWithCategory
          );
      }

      function ShowHideCategory(data) {

          if ($(data).parent().find(".icon-plus-sign-alt").hasClass("icon-plus-sign-alt")) {
              $(data).parent().find(".icon-plus-sign-alt").removeClass("icon-plus-sign-alt").addClass("icon-check-minus");
          }
          else {
              $(data).parent().find(".icon-check-minus").removeClass("icon-check-minus").addClass("icon-plus-sign-alt");
          }

      }


      function DisplayTopicsWithCategory(result, event) {


          var lstTopicCollateralIds = new Array();

          for (var icount = 0; icount < result.length; icount++) {
              //var spacehref = result[icount].CategoryName.replace(/ /g, "_");
              var spacehref = result[icount].CategoryName.replace(/([~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,.\/? ])+/g, '_').replace(/^(-)+|(-)+$/g, '');
              var hrefurl = '#' + spacehref;
              var CategoryName = result[icount].CategoryName;
              var CategoryId = result[icount].CategoryId;

              var contentCount = result[icount].lstlrngs.length;

              var generateCategory = ("<div class='panel panel-default'> <div class='panel-heading'>" +
                "<h4 class='panel-title'> <a   onclick='ShowHideCategory(this)'  class='accordion-toggle a_underNone' data-toggle='collapse' data-parent='#accordion' href='" + hrefurl + "'> <span class='icon-plus-sign-alt'></span> " + result[icount].CategoryName + " </a>");

              if (CategoryName != '') {
                  var CategoryEdit = ("<a class='icon-remove pull-right a_underNone editTopic_a colorRed'   data-CtgryId=" + CategoryId + "  data-CategoryName='" + CategoryName + "'  onclick='DeleteCommunityCtgry(this)' ></a>" +
                    "<a class='icon-pencil pull-right a_underNone editTopic_a e_IconColor'  data-CtgryId=" + CategoryId + "  data-CategoryName='" + CategoryName + "'  onclick='ValidateEditCategory(this)'  ></a></h4></div>");
                  generateCategory += CategoryEdit;
              }
              else {
                  generateCategory += "</h4></div>";
              }


              $('#divCategory').append(generateCategory);

              var generateL = ("<div id='" + spacehref + "' class='panel-collapse collapse'>");

              if (contentCount > 1) {

                  var DisplayHTML = ("<div class='clearfix'>  <a class='icon-sort-alpha-asc btnAthena btn-primary pull-right ml0' data_sortctgryNm='" + CategoryName + "'  data-sortctgry=" + CategoryId + " onclick='ShowChangeOrder(this)'></a> <a class='btnAthena btn-primary pull-right mr5' data-toggle='modal'  data_ctgryNm='" + CategoryName + "' data-categoryName = " + spacehref + " data-ctgry=" + CategoryId + "  onclick='ShowTopicDtls(this)' ><span class='icon-plus'></span> Add Content</a>" +
                                    "</div> " +
                                    "<div></div>");

                  generateL += DisplayHTML;
              }
              else {
                  var DisplayHTML = ("<div class='clearfix'><a class='btnAthena btn-primary pull-right mr5' data-toggle='modal'  data_ctgryNm='" + CategoryName + "' data-categoryName = " + spacehref + " data-ctgry=" + CategoryId + "  onclick='ShowTopicDtls(this)' ><span class='icon-plus'></span> Add Content</a>" +
                                 "</div> " +
                                 "<div></div>");

                  generateL += DisplayHTML;
              }

              //generateL += genCatEdit;

              //if (CategoryName != '') {
              //    var CategoryEdit = ("<div><a class='icon-remove pull-right a_underNone editTopic_a colorRed'   data-CtgryId=" + CategoryId + "  data-CategoryName='" + CategoryName + "'  onclick='DeleteCommunityCtgry(this)' ></a>" +
              //      "<a class='icon-pencil pull-right a_underNone editTopic_a e_IconColor'  data-CtgryId=" + CategoryId + "  data-CategoryName='" + CategoryName + "'  onclick='ValidateEditCategory(this)'  ></a></div>");
              //    generateL += CategoryEdit;
              //}


              var GenerateUrl = '';
              var generateLText = '';
              var IntegrateContent = '';
              var generateVideo = '';
              var LinkRelatedPDF = '';
              //var clientFacing = '';
              var NextDviToComplete = '';
              IntegrateContent = generateL;
              for (var icnt = 0; icnt < result[icount].lstlrngs.length; icnt++) {
debugger
                  var LShortDescription = result[icount].lstlrngs[icnt].LShortDescription;

                  LShortDescription = LShortDescription.replace(/[^\011\012\015\040-\177]/g, function (x) {
                      return '&#' + x.charCodeAt(0) + ';'
                  })
                  LShortDescription = $($.parseHTML(LShortDescription)).text();
                  var tID = 'ratingCollateral_' + result[icount].lstlrngs[icnt].Lid;
                  var AverageRating = result[icount].lstlrngs[icnt].AvgRating;
                  var RatersCount = result[icount].lstlrngs[icnt].RatersCount;

                  lstTopicCollateralIds.push({ "Id": tID, "Rating": AverageRating, "RateCount": RatersCount });

                  var spacehrefLearning = $.trim(result[icount].lstlrngs[icnt].LName).replace(/([~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,.\/? ])+/g, '-').replace(/^(-)+|(-)+$/g, '');
                  var hrefurlLearning = '#' + spacehrefLearning;

                  if (result[icount].lstlrngs[icnt].LType == 'Text') {
                      var maindivStart = "<div class='panel-body topicEdit clearB clearfix PositionR'>";

                      var Header = ("<div class='leftDisplayCon span9 pull-left'>" +
                          "<div class='span12'>" +
                            "<div class='m10 pr20'>");
                            var IsReadMore='';
                if (result[icount].lstlrngs[icnt].StrDescLength > 0) {
                           IsReadMore= ("<a class='' data-toggle='modal' href=" + hrefurlLearning + "> Read more </a>");
                         
                      }
                      if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                          var DisplayFormat = ("<a class='' data-toggle='modal' href='#' onclick='ShowTXT(" + "\"" + hrefurlLearning + "\"" + ")'> <h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                       "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                          Header += DisplayFormat;
                      }
                      else {
                          var DisplayFormat = ("<a class='' data-toggle='modal' href='" + hrefurlLearning + "'> <h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                       "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");
                          Header += DisplayFormat;
                      }


                      Header += "</div>";

                      Header += "</div>";
                      Header += "</div>";


                      var TopIcons = ("<div class='iconRightTop span3 pull-left'>" +
                     "<div class='clearfix clearB'>" +
                    "<a class='icon-remove pull-right a_underNone editTopic_a colorRed'   data-topicId=" + result[icount].lstlrngs[icnt].Lid + "  data-topicName='" + result[icount].lstlrngs[icnt].LName + "' data-ctgryname='" + spacehref + "'   onclick='funcDeleteTopic(this)' ></a>" +
                                                 "<a class='icon-pencil pull-right a_underNone editTopic_a e_IconColor'  data-topicId='" + result[icount].lstlrngs[icnt].Lid + "'  data-PractApprv='" + result[icount].lstlrngs[icnt].PracticeApprv + "'  data-ClientFacing='" + result[icount].lstlrngs[icnt].ClientFacing + "'  data-publish='" + result[icount].lstlrngs[icnt].IsActive + "'  data-TopicDesc='" + result[icount].lstlrngs[icnt].LDescription + "' data-TopicName='" + result[icount].lstlrngs[icnt].LName + "'  data-LType='" + result[icount].lstlrngs[icnt].LType + "' data-ctgryname=" + spacehref + "  data-ctgry=" + CategoryId + "  data-TopicTags='" + result[icount].lstlrngs[icnt].AssociatedTopicTags + "'    data-LURL=" + result[icount].lstlrngs[icnt].LURL + "  onclick='EditTopic(this)'  ></a>");
                      if (result[icount].lstlrngs[icnt].ClientFacing) {

                          var clientFacing = ("<div class='iconDisplayBG'> <span class=' icon-clientfacing_new iconPublish' title='Client-Facing' ></span> </div>");
                          TopIcons += clientFacing;
                      }
                      if (result[icount].lstlrngs[icnt].IsActive) {

                          var HPPublish = ("<div class='iconDisplayBG '> <span class='icon-globe iconPublish ml3' title='Published'></span> </div>");
                          TopIcons += HPPublish;
                      }
                      if (result[icount].lstlrngs[icnt].PracticeApprv) {
                          var HPCrt = ("<div class='iconDisplayBG '> <span class='icon-certified iconPublish ml_1' title='Practice-Approved' ></span> </div>");
                          TopIcons += HPCrt;
                      }




                      TopIcons += "</div>";


                      TopIcons += "</div>";

                      var ReadMoreRating = "<div class='leftDisplayCon span9 pull-left ml0 p10'>";
                      

                      var rating = ("<div id='ratingCollateral_" + result[icount].lstlrngs[icnt].Lid + "'></div>");

                      if (RatersCount > 0) {
                          var userRatersCount = "<span>" + RatersCount + " People Rated and Avg Rating " + AverageRating + "</span>";
                          rating += userRatersCount;
                      }
                      ReadMoreRating += rating;
                      var AfterTags = ("<div id='" + spacehrefLearning + "' class='modal hide fade PositionF' tabindex='-1' role='dialog' aria-labelledby='myModalLabel1' aria-hidden='true' data-backdrop='static'>" +
                                              "<div class='modal-header'>" +
                                               " <h3>Content Description</h3>" +
                                              "</div>" +
                                              "<div class='modal-body readmoreHpop'>" +
                                               " <p style='white-space: pre-line;'> " +
                                                      "" + result[icount].lstlrngs[icnt].LDescription + "" +
                                                "</p>" +
                                              "</div>" +
                                              "<div class='modal-footer'>" +
                                               " <button class='btnAthena btn_cancel' data-dismiss='modal' aria-hidden='true'>Cancel</button>" +
                                              "</div>" +
                                            "</div>" +

           "<div><img class='Br20' src=" + result[icount].lstlrngs[icnt].OwnerPhoto + "  height='35' width='35'/> <a id='aTopicName' class='hpit_athena_ca_itemLink' href='/apex/AthenaUserProfile?id=" + result[icount].lstlrngs[icnt].TopicOwnerId + "'> " + result[icount].lstlrngs[icnt].LOwnerName + " </a></div>" +

    "</div>");
                      ReadMoreRating += AfterTags;



                      var MainDivEnd = "</div>";

                      var IntegrateContentFinal = maindivStart + Header + TopIcons + ReadMoreRating + MainDivEnd;

                      IntegrateContent += IntegrateContentFinal;


                  }
                  else if ((result[icount].lstlrngs[icnt].LType == 'Link or Document') || (result[icount].lstlrngs[icnt].LType == 'Upload Document')) {

                      var IsURLExist = result[icount].lstlrngs[icnt].LURL;
                      var LinkTopicID = result[icount].lstlrngs[icnt].Lid;

                      var maindivStart = "<div class='panel-body topicEdit clearB clearfix PositionR'>";

                      var Header = ("<div class='leftDisplayCon span9 pull-left'>" +
                          "<div class='span12'>" +
                            "<div class='m10 pr20'>");
                var IsReadMore = '';
                if (result[icount].lstlrngs[icnt].StrDescLength > 0) {
                          IsReadMore=("<a class='' data-toggle='modal' href=" + hrefurlLearning + "> Read more </a>");
                         
                      }

                      if (IsURLExist != undefined) {
                    
                          if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                              var imageHTML = ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " Data-Url = " + escape(result[icount].lstlrngs[icnt].LURL) + " Data-DocType = " + result[icount].lstlrngs[icnt].DocType + " onclick = 'OpenAssociatedModalPopUp(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                           "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                              Header += imageHTML;
                          }
                          else {
                              var imageHTML = ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " target='_blank' Data-Url = " + (result[icount].lstlrngs[icnt].LURL) + " onclick = 'NavigateUrl(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                           "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                              Header += imageHTML;
                          }

                      }
                      else {
                          var imageHTML = ("<h4>" + result[icount].lstlrngs[icnt].LName + " </h4>" +
                                           "<p style='white-space: pre-line;'> " + LShortDescription + " "+ IsReadMore +" </p>");

                          Header += imageHTML;
                      }


                      Header += "</div>";

                      Header += "</div>";
                      Header += "</div>";


                      var TopIcons = ("<div class='iconRightTop span3 pull-left'>" +
                     "<div class='clearfix clearB'>" +
                    "<a class='icon-remove pull-right a_underNone editTopic_a colorRed'   data-topicId=" + result[icount].lstlrngs[icnt].Lid + "  data-topicName='" + result[icount].lstlrngs[icnt].LName + "' data-ctgryname='" + spacehref + "'  onclick='funcDeleteTopic(this)' ></a> " +
                                          "<a class='icon-pencil pull-right a_underNone editTopic_a e_IconColor'  data-topicId='" + result[icount].lstlrngs[icnt].Lid + "'  data-PractApprv='" + result[icount].lstlrngs[icnt].PracticeApprv + "'  data-ClientFacing='" + result[icount].lstlrngs[icnt].ClientFacing + "'  data-publish='" + result[icount].lstlrngs[icnt].IsActive + "'  data-TopicDesc='" + result[icount].lstlrngs[icnt].LDescription + "' data-TopicName='" + result[icount].lstlrngs[icnt].LName + "'  data-ctgry=" + CategoryId + "  data-LType='" + result[icount].lstlrngs[icnt].LType + "' data-ctgryname=" + spacehref + "  data-TopicTags='" + result[icount].lstlrngs[icnt].AssociatedTopicTags + "'  data-Tags=" + result[icount].lstlrngs[icnt].Tags + "  data-LURL='" + result[icount].lstlrngs[icnt].LURL + "'  onclick='EditTopic(this)' ></a>");
                      if (result[icount].lstlrngs[icnt].ClientFacing) {

                          var clientFacing = ("<div class='iconDisplayBG'> <span class='icon-clientfacing_new iconPublish' title='Client-Facing' ></span> </div>");
                          TopIcons += clientFacing;
                      }
                      if (result[icount].lstlrngs[icnt].IsActive) {

                          var HPPublish = ("<div class='iconDisplayBG '> <span class='icon-globe iconPublish ml3' title='Published'></span> </div>");
                          TopIcons += HPPublish;
                      }
                      if (result[icount].lstlrngs[icnt].PracticeApprv) {
                          var HPCrt = ("<div class='iconDisplayBG '> <span class='icon-certified iconPublish ml_1' title='Practice-Approved' ></span> </div>");
                          TopIcons += HPCrt;
                      }




                      TopIcons += "</div>";


                      TopIcons += "</div>";

                      var ReadMoreRating = "<div class='leftDisplayCon span9 pull-left ml0 p10'>";
                      

                      var rating = ("<div id='ratingCollateral_" + result[icount].lstlrngs[icnt].Lid + "'></div>");

                      if (RatersCount > 0) {
                          var userRatersCount = "<span>" + RatersCount + " People Rated and Avg Rating " + AverageRating + "</span>";
                          rating += userRatersCount;
                      }
                      ReadMoreRating += rating;
                      var AfterTags = ("<div id='" + spacehrefLearning + "' class='modal hide fade PositionF' tabindex='-1' role='dialog' aria-labelledby='myModalLabel1' aria-hidden='true' data-backdrop='static'>" +
                                              "<div class='modal-header'>" +
                                               " <h3>Content Description</h3>" +
                                              "</div>" +
                                              "<div class='modal-body readmoreHpop'>" +
                                               " <p style='white-space: pre-line;'> " +
                                                      "" + result[icount].lstlrngs[icnt].LDescription + "" +
                                                "</p>" +
                                              "</div>" +
                                              "<div class='modal-footer'>" +
                                               " <button class='btnAthena btn_cancel' data-dismiss='modal' aria-hidden='true'>Cancel</button>" +
                                              "</div>" +
                                            "</div>" +

           "<div><img class='Br20' src=" + result[icount].lstlrngs[icnt].OwnerPhoto + "  height='35' width='35'/> <a id='aTopicName' class='hpit_athena_ca_itemLink' href='/apex/AthenaUserProfile?id=" + result[icount].lstlrngs[icnt].TopicOwnerId + "'> " + result[icount].lstlrngs[icnt].LOwnerName + " </a></div>" +

    "</div>");
                      ReadMoreRating += AfterTags;

                      var belowIcons = ("<div class='iconRight span3 pull-left p5'>" +
                              "<div class='clearB clearfix mtop20'>");

                      if (result[icount].lstlrngs[icnt].DocType == 'PDF') {

                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                          if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {

                              var DisplayHTML = ("<a id= anchor_" + ShareTopicID + " data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowPDF(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <span class='icon-dload-pdf conBottomBtn pull-right' title='Download File' /> </a></span> ");
                              belowIcons += DisplayHTML;
                          }
                          else {

                              var DisplayHTML = ("<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <span class='icon-dload-pdf conBottomBtn pull-right'  title='Download File' /> </a></span> ");
                              belowIcons += DisplayHTML;
                          }

                      }

                      else if (result[icount].lstlrngs[icnt].DocType == 'PPT') {

                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                          var DisplayIcon = ("<span class='detailDoc'> " +
                           //"<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <img class='mrl' width='25' height='25' src=" + result[icount].lstlrngs[icnt].filePPTUpload + " /> </a> " +
                           "<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <span class='icon-dload-powerpoint conBottomBtn pull-right' title='Download File'  /> </a> " +
                           "</span> ");
                          belowIcons += DisplayIcon;
                          //IntegrateContent += LinkRelatedPDF;

                      }

                      else if (result[icount].lstlrngs[icnt].DocType == 'DOC') {
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                          var DisplayIcondoc = ("<span class='detailDoc'> " +
                          //"<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <img class='mrl' width='25' height='25' src=" + result[icount].lstlrngs[icnt].fileWordUpload + " /> </a> " +
                          "<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <span class='icon-dload-word conBottomBtn pull-right' title='Download File' /> </a> " +
                          "</span> ");
                          belowIcons += DisplayIcondoc;
                          //IntegrateContent += LinkRelatedPDF;

                      }
                      else if (result[icount].lstlrngs[icnt].DocType == 'XLS') {
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                          var DisplayIconXls = ("<span class='detailDoc'> " +
                          //"<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <img class='mrl' width='25' height='25' src=" + result[icount].lstlrngs[icnt].fileExcelUpload + " /> </a> " +
                          "<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <span class='icon-dload-excel conBottomBtn pull-right' title='Download File' /> </a> " +
                          "</span> ");
                          belowIcons += DisplayIconXls;
                          //IntegrateContent += LinkRelatedPDF;

                      }
                      else if (result[icount].lstlrngs[icnt].DocType == 'TXT') {
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                          var DisplayIconTxt = ("<span class='detailDoc'> ");
                          belowIcons += DisplayIconTxt;
                          if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                              //var DisplayHTML = ("<a id= anchor_" + ShareTopicID + " data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowTXT(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <img class='mrl' width='25' height='25' src=" + result[icount].lstlrngs[icnt].fileTextUpload + " /> </a></span> ");
                              var DisplayHTML = ("<a id= anchor_" + ShareTopicID + " data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowTXT(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <span class='icon-dload-text conBottomBtn pull-right' title='Download File' /> </a> </span>");
                              belowIcons += DisplayHTML;
                          }
                          else {
                              var DisplayHTML = ("<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <span class='icon-dload-text conBottomBtn pull-right' title='Download File' /> </a> </span>");
                              belowIcons += DisplayHTML;
                          }

                      }

                      else if (result[icount].lstlrngs[icnt].DocType == 'OTHER') {
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                          var DisplayIconOther = ("<span class='detailDoc'> ");
                          belowIcons += DisplayIconOther;
                          if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                              //var DisplayHTML = ("<a id= anchor_" + ShareTopicID + "  data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowHTML(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <img class='mrl' width='25' height='25' src=" + result[icount].lstlrngs[icnt].fileURLUpload + " /> </a></span> ");
                              var DisplayIco = ("<a id= anchor_" + ShareTopicID + "  data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowHTML(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <span class='icon-link conBottomBtn conBottomBtn_B pull-right'  title='Visit Page'  /> </a></span> ");
                              //LinkRelatedPDF += DisplayHTML;
                              belowIcons += DisplayIco;
                          }
                          else {

                              var DisplayIcoc = ("<a id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='functionTargetUrl(this)'> <span class='icon-link conBottomBtn conBottomBtn_B pull-right'  title='Visit Page' /> </a></span> ");

                              belowIcons += DisplayIcoc;
                          }


                      }
                      belowIconsEnd = "</div>";
                      belowIcons += belowIconsEnd;
                      belowIconsEnd2 = "</div>";
                      belowIcons += belowIconsEnd2;
                      var MainDivEnd = "</div>";

                      IntegrateContentfinal = maindivStart + Header + TopIcons + ReadMoreRating + belowIcons + MainDivEnd;
                      IntegrateContent += IntegrateContentfinal;

                  }
                  else if (result[icount].lstlrngs[icnt].LType == 'Video') {
                      var someText = "<a>" + result[icount].lstlrngs[icnt].LName + "</a>";
                      var maindivStart = "<div class='panel-body topicEdit clearB clearfix PositionR'>";

                      var Header = ("<div class='leftDisplayCon span9 pull-left'>" +
                          "<div class='span12'>" +
                            "<div class='m10 pr20'>");

var IsReadMore ='';
                if (result[icount].lstlrngs[icnt].StrDescLength > 0) {
                         IsReadMore=  ("<a class='' data-toggle='modal' href=" + hrefurlLearning + "> Read more </a>");
                          
                      }
                      if (IsURLExist != undefined) {
                      
                          if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                              var imageHTML = ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " Data-Url = " + escape(result[icount].lstlrngs[icnt].LURL) + " Data-DocType = " + result[icount].lstlrngs[icnt].DocType + " onclick = 'OpenAssociatedModalPopUp(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                           "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                              Header += imageHTML;
                          }
                          else {
                              var imageHTML = ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " target='_blank' Data-Url = " + (result[icount].lstlrngs[icnt].LURL) + " onclick = 'NavigateUrl(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                           "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                              Header += imageHTML;
                          }

                      }
                      else {
                          var imageHTML = ("<h4>" + result[icount].lstlrngs[icnt].LName + " </h4>" +
                                           "<p style='white-space: pre-line;'> '" + LShortDescription + "' "+IsReadMore+" </p>");

                          Header += imageHTML;
                      }


                      Header += "</div>";

                      Header += "</div>";
                      Header += "</div>";


                      var TopIcons = ("<div class='iconRightTop span3 pull-left'>" +
                     "<div class='clearfix clearB'>" +
                    "<a class='icon-remove pull-right a_underNone editTopic_a colorRed'  data-topicId=" + result[icount].lstlrngs[icnt].Lid + "  data-topicName='" + result[icount].lstlrngs[icnt].LName + "' data-ctgryname='" + spacehref + "' onclick='funcDeleteTopic(this)' ></a>" +
                                            "<a class='icon-pencil pull-right a_underNone editTopic_a e_IconColor'  data-topicId='" + result[icount].lstlrngs[icnt].Lid + "'  data-PractApprv='" + result[icount].lstlrngs[icnt].PracticeApprv + "' data-ClientFacing='" + result[icount].lstlrngs[icnt].ClientFacing + "'  data-publish='" + result[icount].lstlrngs[icnt].IsActive + "'  data-TopicDesc='" + result[icount].lstlrngs[icnt].LDescription + "' data-TopicName='" + result[icount].lstlrngs[icnt].LName + "' data-ctgryname=" + spacehref + "'  data-ctgry=" + CategoryId + "  data-LType='" + result[icount].lstlrngs[icnt].LType + "'  data-TopicTags='" + result[icount].lstlrngs[icnt].AssociatedTopicTags + "'  data-Tags=" + result[icount].lstlrngs[icnt].Tags + "  data-LURL=" + result[icount].lstlrngs[icnt].LURL + "  onclick='EditTopic(this)' ></a>");
                      if (result[icount].lstlrngs[icnt].ClientFacing) {

                          var clientFacing = ("<div class='iconDisplayBG'> <span class='icon-clientfacing_new iconPublish' title='Client-Facing' ></span> </div>");
                          TopIcons += clientFacing;
                      }
                      if (result[icount].lstlrngs[icnt].IsActive) {

                          var HPPublish = ("<div class='iconDisplayBG '> <span class='icon-globe iconPublish ml3' title='Published'></span> </div>");
                          TopIcons += HPPublish;
                      }
                      if (result[icount].lstlrngs[icnt].PracticeApprv) {
                          var HPCrt = ("<div class='iconDisplayBG '> <span class='icon-certified iconPublish ml_1' title='Practice-Approved' ></span> </div>");
                          TopIcons += HPCrt;
                      }




                      TopIcons += "</div>";


                      TopIcons += "</div>";

                      var ReadMoreRating = "<div class='leftDisplayCon span9 pull-left ml0 p10'>";
                     

                      var rating = ("<div id='ratingCollateral_" + result[icount].lstlrngs[icnt].Lid + "'></div>");

                      if (RatersCount > 0) {
                          var userRatersCount = "<span>" + RatersCount + " People Rated and Avg Rating " + AverageRating + "</span>";
                          rating += userRatersCount;
                      }
                      ReadMoreRating += rating;
                      var AfterTags = ("<div id='" + spacehrefLearning + "' class='modal hide fade PositionF' tabindex='-1' role='dialog' aria-labelledby='myModalLabel1' aria-hidden='true' data-backdrop='static'>" +
                                              "<div class='modal-header'>" +
                                               " <h3>Content Description</h3>" +
                                              "</div>" +
                                              "<div class='modal-body readmoreHpop'>" +
                                               " <p style='white-space: pre-line;'> " +
                                                      "" + result[icount].lstlrngs[icnt].LDescription + "" +
                                                "</p>" +
                                              "</div>" +
                                              "<div class='modal-footer'>" +
                                               " <button class='btnAthena btn_cancel' data-dismiss='modal' aria-hidden='true'>Cancel</button>" +
                                              "</div>" +
                                            "</div>" +

           "<div><img class='Br20' src=" + result[icount].lstlrngs[icnt].OwnerPhoto + "  height='35' width='35'/> <a id='aTopicName' class='hpit_athena_ca_itemLink' href='/apex/AthenaUserProfile?id=" + result[icount].lstlrngs[icnt].TopicOwnerId + "'> " + result[icount].lstlrngs[icnt].LOwnerName + " </a></div>" +

    "</div>");
                      ReadMoreRating += AfterTags;

                      var belowIcons = ("<div class='iconRight span3 pull-left p5'>" +
                              "<div class='clearB clearfix mtop20'>");

                      var videoIcon = ("<span class='detailDoc'><a src='" + result[icount].lstlrngs[icnt].LURL + "'  href='" + result[icount].lstlrngs[icnt].LURL + "' target='_blank' ><span class='icon-video-camera conBottomBtn_B conBottomBtn pull-right'  title='Play Video' /></a></span>");
                      belowIcons += videoIcon;
                      belowIcons += "</div>";

                      belowIcons += "</div>";

                      var MainDivEnd = "</div>";

                      var IntegrateContentFinal = maindivStart + Header + TopIcons + ReadMoreRating + belowIcons + MainDivEnd;

                      IntegrateContent += IntegrateContentFinal;

                  }

              }

              var LastDiv = "</div>";
              IntegrateContent += LastDiv;
              $('#divCategory').append(IntegrateContent);

          }

          //Sarah
          var ele = '';
          var spacehref2 = '';
          if (getCookie('CatName') != '' && getUrlVars()["u"] == 'y') {
              ele = getCookie('CatName');
              spacehref2 = ele.replace(/ /g, "_");
          }
          else {
              ele = $('[id$=hdnTopicCatName]');
              spacehref2 = ele.val().replace(/ /g, "_");
          }

          var ele2 = $('#' + spacehref2);
          ele2.addClass('in');
          var ahref = $('a[href="#' + spacehref2 + '"]')
          ShowHideCategory(ahref);


          for (var iL = 0; iL < lstTopicCollateralIds.length; iL++) {


              $('#' + lstTopicCollateralIds[iL].Id).raty({
                  cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                  cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                  starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                  starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                  starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                  readOnly: true,
                  score: lstTopicCollateralIds[iL].Rating
              });


          }

      }

      function isValidUrl(s) {
          var regexp = /(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/
          return regexp.test(s);
      }
      function isValidWWWUrl(s) {
          var regexp = /(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/
          return regexp.test(s);
      }

      //Test Button Validation


      function openNewWindow() {
          $('#emptyImageUpLoad').empty();
          $('#VideoLearning').hide();
          $('#emptyImageUpLoad').hide();
          var TestURL = $('[id$=SearchLinkUrl]').val();

          //var TestURL = document.getElementById('{!$Component.EditTopic:SearchLinkUrl}').value;
          //var LType = $('input[name=optionsRadios1]:checked').val(); 
          if (TestURL == "Video") {
              var srcurl1 = $.trim($('[id$=InputTextURL]').val());
              var isUrlValid = isValidWWWUrl(srcurl1);
              if ((srcurl1 != '') && (isUrlValid)) {

                  if (srcurl1.indexOf("youtube.com") > -1) {
                      $('#emptyImageUpLoad').empty();
                      if (srcurl1.indexOf("www") == -1) {
                          srcurl1 = "www." + srcurl1;

                      }
                      if (srcurl1.indexOf("https") == -1) {
                          if (srcurl1.indexOf("http") == -1) {
                              srcurl1 = 'https://' + srcurl1;
                          }
                      }

                      if (isValidUrl(srcurl1)) {
                          $('#VideoLearning').show();
                          $('[id$=testvideo]').show();
                          $('[id$=novideo]').hide();
                          $('#emptyImageUpLoad').hide();


                          srcurl1 = srcurl1.replace("watch?v=", "embed/");
                          srcurl1 = srcurl1.replace("http:", "https:");
                          $('#testvideo').attr('src', srcurl1);
                          $('#testvideo').reload(true);

                      }

                      else {
                          $('#emptyImageUpLoad').append('Enter Valid URL');
                          $('#emptyImageUpLoad').append('<br/>');
                          if ($('#emptyImageUpLoad')[0].children.length > 0) {
                              $("#emptyImageUpLoad").show();
                              $('#VideoLearning').hide();
                              $('#emptyImageUpLoad').css('display', 'block');

                              return false;
                          }

                      }

                  }
                  else if (srcurl1.indexOf("brainshark.com") > -1) {
                      if (srcurl1.indexOf("www") == -1) {
                          srcurl1 = "www." + srcurl1;

                      }
                      if (srcurl1.indexOf("https") == -1) {
                          if (srcurl1.indexOf("http") == -1) {
                              srcurl1 = 'https://' + srcurl1;
                          }
                      }

                      if (isValidUrl(srcurl1)) {
                          $('#VideoLearning').show();
                          $('[id$=testvideo]').show();
                          $('[id$=novideo]').hide();
                          $('#emptyImageUpLoad').hide();


                          //srcurl1 = srcurl1.replace("watch?v=", "embed/");
                          //srcurl1 = srcurl1.replace("http:", "https:");
                          $('#testvideo').attr('src', srcurl1);
                          $('#testvideo').reload(true);

                      }

                      else {
                          $('#emptyImageUpLoad').append('Enter Valid URL');
                          $('#emptyImageUpLoad').append('<br/>');
                          if ($('#emptyImageUpLoad')[0].children.length > 0) {
                              $("#emptyImageUpLoad").show();
                              $('#VideoLearning').hide();
                              $('#emptyImageUpLoad').css('display', 'block');

                              return false;
                          }

                      }
                  }
                  else {

                      $('#emptyImageUpLoad').append('Enter Valid URL');
                      $('#emptyImageUpLoad').append('<br/>');
                      if ($('#emptyImageUpLoad')[0].children.length > 0) {
                          $("#emptyImageUpLoad").show();
                          $('#VideoLearning').hide();
                          $('#emptyImageUpLoad').css('display', 'block');

                          return false;
                      }

                  }

              }

              else {
                  if ($('[id$=InputTextURL]').val() == '') {
                      $('#emptyImageUpLoad').append('Enter URL');
                      $('#emptyImageUpLoad').append('<br/>');
                  }
                  if ((!isUrlValid) && $('[id$=InputTextURL]').val() != '') {
                      $('#emptyImageUpLoad').append('Enter Valid URL');
                      $('#emptyImageUpLoad').append('<br/>');
                  }
                  if ($('#emptyImageUpLoad')[0].children.length > 0) {
                      $("#emptyImageUpLoad").show();
                      $('#emptyImageUpLoad').css('display', 'block');

                      return false;
                  }
              }


          }
          else {
              TestLinkUrl();
          }
      }

      if (typeof String.prototype.startsWith != 'function') {
          String.prototype.startsWith = function (prefix) {
              return this.slice(0, prefix.length) == prefix;
          };
      }

      function TestLinkUrl() {

          $('#emptyImageUpLoad').empty();
          $('#emptyImageUpLoad').hide();
          var href = $('[id$=InputTextURL]').val();
          if (href != '') {
          
            if(href.length>255)
            {
                    $('#emptyImageUpLoad').append('URL length should be 255 characters');
                  $('#emptyImageUpLoad').append('<br/>');
            }
            else
            {
              if ((href.startsWith('https://')) || (href.startsWith('http://'))) {
                  var link = $('<a href="' + href + '" />');
                  link.attr('target', '_blank');
                  window.open(link.attr('href'));

              }
              else {
                  $('#emptyImageUpLoad').append('Unfortunately we were not able to accept this URL. Please make sure it is a valid URL (starting with https:// or http://) and try again.');
                  $('#emptyImageUpLoad').append('<br/>');

              }
            }
          }
          else {
              $('#emptyImageUpLoad').append('Enter Url. Please make sure it is a valid URL (starting with https:// or http://) and try again.');
              $('#emptyImageUpLoad').append('<br/>');
          }

          if ($('#emptyImageUpLoad')[0].children.length > 0) {
              $("#emptyImageUpLoad").show();
              $('#emptyImageUpLoad').css('display', 'block');

              return false;
          }
      }

      function funcVerifyDuplicateTName(btnSave) {

          //var TName = document.getElementById('{!$Component.EditTopic.txtTopic}').value;
          //var TName = $('#txtTopic').attr('data-TName');
          var TName = $('[id$=txtTopic]').val();
          var CommunityId = $.urlParam('id');
          if (TName != '') {
              Visualforce.remoting.Manager.invokeAction(
                       '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateTopicName}',
                       TName,
                       CommunityId,
                       VerifyDupTName
                   );
          }
      }

      function VerifyDupTName(result, event) {

          $('#emptyImageUpLoad').empty();
          $('#emptyImageUpLoad').hide();
          $('#DuplicateTName').empty();
          $('#DuplicateTName').hide();
          if (result > 0) {

              $('#DuplicateTName').append('Duplicate Content Name');
              $('#DuplicateTName').append('<br/>');
              $('#DuplicateTName').show();

          }
          else {
              $('#DuplicateTName').empty();
              $('#DuplicateTName').hide();
          }


      }

      function funcVerifyDuplicateTopic(btnSave) {
          $('#DuplicateTName').empty();
          $('#DuplicateTName').hide();
          //var TName = document.getElementById('{!$Component.EditTopic.txtTopic}').value;
          //var TName = $('#txtTopic').attr('data-TName');
          var TName = $('[id$=txtTopic]').val();
          var CommunityId = $.urlParam('id');
          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateTopicName}',
                   TName,
                   CommunityId,
                   VerifyTName
               );
      }

      function VerifyTName(result, event) {

          $('#emptyImageUpLoad').empty();
          if (result > 0) {

              $('#emptyImageUpLoad').append('Duplicate Content Name');
              $('#emptyImageUpLoad').append('<br/>');
              funcCreateTopic(event);
          }
          else {
              funcCreateTopic(event);
          }


      }

      function funcVerifyDuplicateTopicUpload(btnSave) {
          var CommunityId = $.urlParam('id');
          var TName = $('[id$=txtTopic]').val();
          $('#DuplicateTName').empty();
          $('#DuplicateTName').hide();
          // var TName = document.getElementById('{!$Component.EditTopic.txtTopic}').value;
          //var TName = $('#txtTopic').attr('data-TName');
          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateTopicName}',
                   TName,
                   CommunityId,
                   VerifyTUploadName);
      }

      function VerifyTUploadName(result, event) {

          $('#emptyImageUpLoad').empty();
          $('#emptyImageUpLoad').hide();
          if (result > 0) {

              $('#emptyImageUpLoad').append('Duplicate Content Name');
              $('#emptyImageUpLoad').append('<br/>');
              funcCreateTopicUploadDoc(event);
          }
          else {
              funcCreateTopicUploadDoc(event);
          }
      }




      function funcCreateTopicUploadDoc(event) {

          $('#showDuplicateTName').hide();

          // $('#emptyImageUpLoad').empty();

          var TName = $.trim($('[id$=txtTopic]').val());


          var topicTags = $('[id$=txtTopicTags]').val();
          $('[id$=txtAddTopicTags]').val(topicTags);
          var TDesc = $.trim($('[id$=txtTopicArea]').val());

          if (TName == '') {
              $('#emptyImageUpLoad').append('Enter Content Name');
              $('#emptyImageUpLoad').append('<br/>');
          }
          if (TDesc == '') {
              $('#emptyImageUpLoad').append('Enter Content Description');
              $('#emptyImageUpLoad').append('<br/>');
          }

          if ($('[id$=LearningTopic]').val() == 'Video' || $('[id$=LearningTopic]').val() == 'LinkORDoc') {
              if ($('[id$=InputTextURL]').val() == '') {
                  $('#emptyImageUpLoad').append('Enter URL');
                  $('#emptyImageUpLoad').append('<br/>');
              }

          }
          //funcVerifyDuplicateTopic();
          if ($('#emptyImageUpLoad')[0].children.length > 0) {
              $("#emptyImageUpLoad").show();
              $('#emptyImageUpLoad').css('display', 'block');
              // event.preventDefault();
              return false;
          }
          else {
              $('[id$=NextCreateTopic]').click();
              return true;
          }
      }



      function funcCreateTopic(event) {


          $('#showDuplicateTName').hide();

          var TName = $.trim($('[id$=txtTopic]').val());


          //var topicTags = $('[id$=txtTopicTags]').val();
          //$('[id$=txtAddTopicTags]').val(topicTags);


          var TDesc = $.trim($('[id$=txtTopicArea]').val());

          if (TName == '') {
              $('#emptyImageUpLoad').append('Enter Content Name');
              $('#emptyImageUpLoad').append('<br/>');
          }
          if (TDesc == '') {
              $('#emptyImageUpLoad').append('Enter Content Description');
              $('#emptyImageUpLoad').append('<br/>');
          }


          if ($('[id$=LearningTopic]').val() == 'Video' || $('[id$=LearningTopic]').val() == 'LinkORDoc') {
              if ($('[id$=InputTextURL]').val() == '') {
                  $('#emptyImageUpLoad').append('Enter URL');
                  $('#emptyImageUpLoad').append('<br/>');
              }
              else {
                  if ($('[id$=LearningTopic]').val() == 'LinkORDoc') {
                      var href = $('[id$=InputTextURL]').val();
                      if (href != '') {
                      if(href.length>255)
                      {
                              $('#emptyImageUpLoad').append('URL length should be 255 characters ');
                              $('#emptyImageUpLoad').append('<br/>');
                      }
                      else
                      {
                          if ((href.indexOf('http://') > -1) || (href.indexOf('https://') > -1)) { }
                          else
                          {
                              $('#emptyImageUpLoad').append('Unfortunately we were not able to accept this URL. Please make sure it is a valid URL (starting with https:// or http://) and try again. ');
                              $('#emptyImageUpLoad').append('<br/>');

                          }
                      }
                    }
                  }
              }

          }

          if ($('#emptyImageUpLoad')[0].children.length > 0) {
              $("#emptyImageUpLoad").show();
              $('#emptyImageUpLoad').css('display', 'block');

              return false;
          }
          else {
              $('[id$=SaveTopic]').click();
              return true;
          }
      }

      function ShowTopicDtls(data) {
          $('#emptyImageUpLoad').hide();
          $('#emptyImageUpLoad').empty();

          var CategoryId = $(data).attr('data-ctgry');
          var CategoryName = $(data).attr('data_ctgryNm');
          $('[id$=hdnCategoryIdForExternalSearch]').val(CategoryId);
          $('[id$=hdnTopicCtgry]').val(CategoryId);
          $('[id$=hdnTopicCtgryName]').val(CategoryName);
          $('[id$=Ctgry]').val(CategoryId);
          $('[id$=lblCategory]').val(CategoryId);
          $('[id$=lblCategory]').text(CategoryName);
          $('[id$=lblCtgryName]').val(CategoryId);
          $('[id$=lblCtgryName]').text(CategoryName);

          //$('[id$=hdnTopicCatName]').val(CategoryName);

          var TabCategoryName = $(data).attr('data-categoryName');

          $('[id$=hdnTopicCatName]').val(TabCategoryName);
          document.cookie = "CatName=" + TabCategoryName;// By Komala

          $('[id$=txtTopic]').val('');
          $('[id$=txtTopicArea]').val('');

          $('[id$=chkboxPublish]').removeAttr('checked');
          $('[id$=chkboxClientF]').removeAttr('checked');
          $('[id$=chkboxPracticeAppr]').removeAttr('checked');
          $('[id$=LearningTopic]').val('TopicType');

          $('#divTopicCommon').hide();
          $('#urlLearning').hide();
          $('#VideoLearning').hide();
          $('#TopicCheckPublish').hide();
          $('#TextUrlLink').hide();
          $('#UpLoadDoc').hide();

          $('[id$=Ctgry]').hide();

          $('[id$=btnCancelTopic]').show();
          
          $('#dvExternalSearch').css('display','none');

          $('#AddTopics').modal('show');
      }

      function ShowTopicOnType(data) {

          $('#divTopicCommon').show();
          $('#TopicCheckPublish').show();
          $('#DuplicateTName').empty();
          $('#DuplicateTName').hide();
          $('#spnNoticeMessage').empty();
          //$('#TextUrlLink').show();
          //$('#UpLoadDoc').hide();
          $('#btnInitTopicCancel').css('display','block');

          if (data.value == 'Text') {
              $('#btnInitTopicCancel').css('display','none');
              $('#TextUrlLink').show();
              $('#UpLoadDoc').hide();
              //$('#TopicTextImage').show();
              $('#VideoLearning').hide();
              $('#urlLearning').hide();
              //$($($($($('[id$=UpLoadDefault]')[0].children)[0].children)[0].children)[0].children[0]).attr('checked', 'checked');
              $('[id$=rdoOptions]').attr("checked", "checked");
              $('#TopicTextImage').show();

              $('#ShowTopicUpload').show();
              $('[id$=btnCancelTopic]').hide();

          }
          else if (data.value == 'Video') {
              $('#btnInitTopicCancel').css('display','none');
              $('#spnNoticeMessage').addClass('warningImg');
              $('#spnNoticeMessage').text('(Only Youtube and Brainshark videos are supported)');
              $('#spnNoticeMessage').show();
              $('#TextUrlLink').show();
              $('#UpLoadDoc').hide();
              //$('#TopicTextImage').hide();
              $('#VideoLearning').show();
              $('#urlLearning').show();
              $('#ShowTopicUpload').hide();
              $('[id$=InputTextURL]').val('');
              $('[id$=btnCancelTopic]').hide();

          }
          else if (data.value == 'LinkORDoc') {
              $('#btnInitTopicCancel').css('display','none');
              $('#spnNoticeMessage').removeClass('warningImg');
              $('#spnNoticeMessage').hide();
              $('#TextUrlLink').show();
              $('#UpLoadDoc').hide();
              //$('#TopicTextImage').show();
              $('#VideoLearning').hide();
              $('#urlLearning').show();
              $('#ShowTopicUpload').show();
              $('[id$=InputTextURL]').val('');
              $('[id$=btnCancelTopic]').hide();
              //$($($($($('[id$=UpLoadDefault]')[0].children)[0].children)[0].children)[0].children[0]).attr('checked', 'checked');

          }
          else if (data.value == 'UploadDoc') {
              $('#btnInitTopicCancel').css('display','none');
              //$('#SaveAndNext').val('Next');
              $('#TextUrlLink').hide();
              $('#UpLoadDoc').show();
              //$('#TopicTextImage').show();
              $('#VideoLearning').hide();
              $('#urlLearning').hide();
              $('#uploadLearning').show();
              //$('#TextUrlLink').show();
              $('#UpLoadDoc').show();
              $('#ShowTopicUpload').show();
              $('[id$=btnCancelTopic]').hide();
              //$($($($($('[id$=UpLoadDefault]')[0].children)[0].children)[0].children)[0].children[0]).attr('checked', 'checked');
          }
          else if(data.value == 'TopicType')
          {
          $('#btnInitTopicCancel').css('display','block');
          }
      }

      function AddContributor(data) {

          var lkfield = document.getElementById('{!$Component.EditTopic.inputUser}_lkid').value;
          $('[id$=hdnNewContributor]').val(lkfield);
      }

      function functionContributorsRemove(data) {

          $('#dvModalContributor').modal('show');
          var contributorId = $(data).attr('data-contrbtrID');
          $('[id$=txtContributorId]').val(contributorId);
      }

      function funcChangeOwner() {

          var lkfield = document.getElementById('{!$Component.EditTopic.chgOnwerInputUser}_lkid').value;

          $('[id$=hiddenChangeOwner]').val(lkfield);

      }

      function SearchAddRelatedBoard() {

          var searchData = $('#txtAddRelative').val();

          if (searchData != '') {
              $('[id$=dvReleatedBoardErrorMsg]').hide();
              $('[id$=AddRelative]').show();
              var warehouseId = $.urlParam('id');

              Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.SLP_EditCommunity.AddRelatedCommunityBoards}', searchData, warehouseId, CommunityResultBoards);
          }
          else {
              document.getElementById('dvReleatedBoardErrorMsg').innerHTML = "Enter Value For Search";
              $('[id$=dvReleatedBoardErrorMsg]').show();
          }
      }

      function CommunityResultBoards(result, event) {

          $('#AddRelative').empty();

          if (result.length > 0) {

              for (var icnt = 0; icnt < result.length; icnt++) {
                  $('#AddRelative').append("<div><span><input type='checkbox' name='RelatedSearch' value=" + result[icnt].LBid + "  /></span> <span> <img width='50' height='50' class='m10' src=" + result[icnt].DefaultImageName + " /></span><span class='m5' id=" + result[icnt].LBid + ">" + result[icnt].LBName + " <span class='searchPopU'>" + result[icnt].LBOwnerName + " </span> </span> <div>");
              }
          }
          else {
              $('#AddRelative').append("<div> Search Result not found </div>");
          }
      }

      function SaveRelatedBoard(event) {

          var SearchText = $('[id$=txtAddRelative]').val();
          var strRel = '';
          var flag = 0;

          if (SearchText == '') {
              $('[id$=dvReleatedBoardErrorMsg]').empty();
              $('[id$=dvReleatedBoardErrorMsg]').append('Enter Search Value');
              $('[id$=dvReleatedBoardErrorMsg]').append('<br/>');
              flag = 1;

              $('[id$=dvReleatedBoardErrorMsg]').show();
              event.preventDefault();
              event.stopPropagation();
              return false;
          }
          else {

              $('input[name="RelatedSearch"]:checked').each(function () {
                  if (strRel == '') {
                      strRel = $(this).val();
                  }
                  else {
                      strRel = strRel + ',' + $(this).val();
                  }
              });

              $('[id$=hiddenRelatedSearch]').val(strRel);

              //if (strRel == '') {
              //    event.preventDefault();
              //    return false;
              //}
              //else {
              //    var button = document.getElementById("{!$Component.EditTopic.btnRelatedBoard}");
              //    button.click();
              //}


              if (strRel == '') {
                  $('[id$=dvReleatedBoardErrorMsg]').empty();
                  $('[id$=dvReleatedBoardErrorMsg]').append('Select at least one board');
                  $('[id$=dvReleatedBoardErrorMsg]').append('<br/>');
                  $('[id$=dvReleatedBoardErrorMsg]').show();

                  event.preventDefault();
                  return false;
              }
              else {
                  $('[id$=dvReleatedBoardErrorMsg]').hide();
                  var button = document.getElementById("{!$Component.EditTopic.btnRelatedBoard}");
                  button.click();
              }
          }
      }

      function EditCatChanged() {
          $('[id$=hdnTopicCatName]').val($('[id$=TopicCategory] option:selected').text());
      }
      function EditTopic(data) {

          $('#EditTopics').modal('show');
          $('#EditCommonTopic').show();

          $('#errorMsgForEdit').empty();
          $('#errorMsgForEdit').hide();
          $('[Id$=txtEditVideoURL]').val('');

          var Ltype = $(data).attr('data-LType');
          if (Ltype == 'Link or Document') {
              Ltype = 'Link';
              $('#spnEditNoteVideoMsg').hide();
              var TopicUrl = $(data).attr('data-LURL');
              $('#lblTopicUrl').text(TopicUrl);
          }
          if (Ltype == 'Video') {
              var TopicUrl = 'Existing URL:' + $(data).attr('data-LURL');
              $('#spnEditNoteVideoMsg').text('(Only Youtube and Brainshark videos are supported)');
              $('#spnEditNoteVideoMsg').show();
              $('#lblTopicUrl').text(TopicUrl);
          }

          $('[id$=TypeOfTopic]').hide();
          $('[id$=lblTopicType]').val(Ltype);
          $('[id$=lblTopicType]').text(Ltype);

          //$('#lblTopicUrl').text(TopicUrl);
          //$('#lblTopicUrl').val(TopicUrl);

          var ctgryId = $(data).attr('data-ctgry');
          var TopicType = $(data).attr('data-LType');
          $('[id$=TopicCategory]').val(ctgryId);
          var CatName = $(data).attr('data-ctgryname');
          $('[id$=hdnTopicCatName]').val(CatName);
          // Start By Komala
          document.cookie = "CatName=" + CatName;
          // End By Komala
          var TName = $(data).attr('data-TopicName');
          var TDesc = $(data).attr('data-TopicDesc');
          $('[id$=txtEditTopicName]').val(TName);
          $('[id$=txtHideTopic]').val(TName);
          $('[id$=txtEditTopicDesc]').val(TDesc);
          var TId = $(data).attr('data-topicId');
          $('[id$=txtEditTopicId]').val(TId);
          $('#hdnTopicId').val(TId);
          var DocId = $(data).attr('data-DocId');
          $('#hdnDocId').val(DocId);

          if ($(data).attr('data-publish').toUpperCase() == "TRUE") {

              $('[id$=chkTopicPublish]').attr('checked', 'checked');
          }
          else {
              $('[id$=chkTopicPublish]').removeAttr('checked');
          }

          if ($(data).attr('data-ClientFacing').toUpperCase() == "TRUE") {
              $('[id$=chkTopicCF]').attr('checked', 'checked');
          }
          else {
              $('[id$=chkTopicCF]').removeAttr('checked');
          }

          if ($(data).attr('data-PractApprv').toUpperCase() == "TRUE") {
              $('[id$=chkTopicPA]').attr('checked', 'checked');
          }
          else {
              $('[id$=chkTopicPA]').removeAttr('checked');
          }

          if (TopicType == 'Text') {
              $('[id$=TypeOfTopic]').val(TopicType);
              //$('[id$=TypeOfTopic]').attr('disabled', 'disabled');
              $('#EditTopicImage').show();
              $('#EditTopicUpload').show();
              $('#EditCommonchkBox').show();
              $('#EditLinkDoc').hide();
              $('#EditUpload').hide();
              //$($($($($('[id$=SelectByUpload]')[0].children)[0].children)[0].children)[0].children[0]).attr('checked', 'checked');
          }
          else if (TopicType == 'Video') {
              $('[id$=TypeOfTopic]').val(TopicType);
              //$('[id$=TypeOfTopic]').attr('disabled', 'disabled');
              $('#EditLinkDoc').show();
              $('#EditTopicImage').hide();
              $('#EditCommonchkBox').show();
              $('#EditUpload').hide();
              $('#EditTopicVideo').hide();
              $('#DefaultVideo').hide();
              $('#EditVideoURL').hide();


          }
          else if (TopicType == 'Link or Document') {
              var Link = 'LinkORDoc';
              $('[id$=TypeOfTopic]').val(Link);
              $('#EditLinkDoc').show();
              //$('[id$=TypeOfTopic]').attr('disabled', 'disabled');
              $('#EditTopicImage').show();
              $('#EditTopicUpload').show();
              $('#EditCommonchkBox').show();
              $('#EditUpload').hide();
              $('#EditTopicVideo').hide();
              //$($($($($('[id$=SelectByUpload]')[0].children)[0].children)[0].children)[0].children[0]).attr('checked', 'checked');
          }
          else if (TopicType == 'Upload Document') {

              var Link = 'UploadDoc';
              $('[id$=TypeOfTopic]').val(Link);
              $('#EditLinkDoc').hide();
              //$('[id$=TypeOfTopic]').attr('disabled', 'disabled');
              $('#EditTopicImage').show();
              $('#EditTopicUpload').show();
              $('#EditCommonchkBox').show();
              $('#EditUpload').show();
              $('#EditTopicVideo').hide();
              if ($(data).attr('data-LURL') != 'undefined') {
                  $('#UploadedFileName').text($(data).attr('data-LURL'));
              }

              var url = $(data).attr('data-LURL');
              $('[id$=hdnLURL]').val(url);
              var hyp = document.getElementById('hdnLURLlink');
              hyp.text = url;
              hyp.href = url;
              hyp.innerHTML = url;
              $('#hdnLURLCaption').html('Current uploaded document: ');
              var DocId = $(data).attr('data-DocId');
              $('#hdnDocId').val(DocId);
              // $($($($($('[id$=SelectByUpload]')[0].children)[0].children)[0].children)[0].children[0]).attr('checked', 'checked');
          }


      }

      function UploadFile(editOrcreate) {
          UploadViaApp(editOrcreate);
      }

      function UploadViaApp(editOrcreate) {

          if (editOrcreate.toLowerCase() == 'create') {
              var m = { 'name': 'button.click', 'payload': { 'BoardId': 'abc', 'CommunityId': 'def', 'tid': '123', 'UserName': 'def', 'LURL': 'url', 'DocId': 'ESxx' }, 'target': { 'canvas': 'cappCreate' } };
              m.payload.tid = $('[id$=hdnPendingFileUploadTopicId]').val();
              //$('[id$=hdnPendingFileUploadTopicId]').val('');
              m.payload.LURL = '';
              m.payload.DocId = '';

              //var buttonId = document.getElementById('{!$Component.EditTopic.btnCancelUploadFile}');
              //buttonId.click();
          }
          else if (editOrcreate.toLowerCase() == 'edit') {
              var m = { 'name': 'button.click', 'payload': { 'BoardId': 'abc', 'CommunityId': 'def', 'tid': '123', 'UserName': 'def', 'LURL': 'url', 'DocId': 'ESxx' }, 'target': { 'canvas': 'capp' } };
              m.payload.tid = $('#hdnTopicId').val();
              m.payload.LURL = $('[id$=hdnLURL]').val();
              m.payload.DocId = $('#hdnDocId').val();

              //var buttonId = document.getElementById('{!$Component.EditTopic.btnCancelUploadFile}');
              //buttonId.click();
          }
          m.payload.BoardId = '';
          m.payload.CommunityId = $.urlParam('id');
          m.payload.UserName = $('span.username').text();
          Sfdc.canvas.controller.publish(m);
          $('#hdnLURLCaption').html('');
          var hyp = document.getElementById('hdnLURLlink');
          hyp.text = '';
          hyp.href = '';
          hyp.innerHTML = '';
          //$('#btnCancelUploadFile').trigger('click');

      }

      function UpdateCommunityTopic() {

          var topicCtgry = $('[id$=TopicCategory]').val();
          if (topicCtgry == 'selectCategory') {
              $('#errorMsgForEdit').empty();
              $('#errorMsgForEdit').append('Select Category');
              $('#errorMsgForEdit').append('<br/>');
          }
          //$('#errorMsgForEdit').empty();
          var TopicNm = $('[id$=txtEditTopicName]').val();
          if (TopicNm == '') {

              $('#errorMsgForEdit').append('Enter Content Name');
              $('#errorMsgForEdit').append('<br/>');
          }
          var TopicDesc = $('[id$=txtEditTopicDesc]').val();
          if (TopicDesc == '') {
              $('#errorMsgForEdit').append('Enter Description');
              $('#errorMsgForEdit').append('<br/>');
          }

          if ($('[id$=lblTopicType]').text() == 'Link') {
              var Editurl = $('[id$=txtEditVideoURL]').val();
              if (Editurl != '') {
               if(Editurl.length > 255)
               {
                      $('#errorMsgForEdit').append('URL length should be 255 characters');
                      $('#errorMsgForEdit').append('<br/>');
               }
               else
               {
                  if ((Editurl.indexOf('http://') > -1) || (Editurl.indexOf('https://') > -1)) { }
                  else
                  {
                      $('#errorMsgForEdit').append('Unfortunately we were not able to accept this URL. Please make sure it is a valid URL (starting with https:// or http://) and try again. ');
                      $('#errorMsgForEdit').append('<br/>');

                  }
              }
             }
          }

          if ($('#errorMsgForEdit')[0].children.length > 0) {
              $("#errorMsgForEdit").show();
              $('#errorMsgForEdit').css('display', 'block');
              return false;
          }
          else {
              $('[id$=btnEditTopic]').click();
              return true;
          }

      }

      function UpdateTopicTags() {

          var topicTags = $('[id$=txtEditTags]').val();
          $('[id$=txtEditTag]').val(topicTags);
            $('#errorMsgForEdit').empty();
           $('#errorMsgForEdit').hide();
          //Validation 
          var TopicNm = $('[id$=txtEditTopicName]').val();
          var TName = $('[id$=txtHideTopic]').val();

          if ((TopicNm.trim() != TName.trim()) && (TopicNm != '')) {
              var CommunityId = $.urlParam('id');
              Visualforce.remoting.Manager.invokeAction(
                  '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateTopicName}',
                  TopicNm,
                  CommunityId,
                  VerifyEditTName
              );

          }

          else {
              //$('[id$=btnEditTopic]').click();
              //return true;
              UpdateCommunityTopic();
          }

      }

      function VerifyEditTName(result, event) {

         
          if (result > 0) {
              $('#errorMsgForEdit').append('Duplicate Content Name');
              $('#errorMsgForEdit').append('<br/>');
              //    $('#errorMsgForEdit').show();
              //  return false;
              UpdateCommunityTopic();
          }

          else {
              //$('[id$=btnEditTopic]').click();
              //return true;
              UpdateCommunityTopic();
          }

      }

      function funcDeleteTopic(data) {

          $('#DeleteTopics').modal('show');
          var topicId = $(data).attr('data-topicId');
          $('[id$=txtTId]').val(topicId);

          var CatName = $(data).attr('data-ctgryname');
          $('[id$=hdnTopicCatName]').val(CatName);
      }

      function RemoveTopicDlog() {
          $('#DeleteTopics').hide();
      }

      function ShowHideDefaultImage(data) {

          if ($(data).val() == 'UFC') {
              $('#showLoadImg').show();
              $('#DefaultDrop').hide();
          }
          else {
              $('#DefaultDrop').show();
              $('#showLoadImg').hide();
          }

      }

      function LoadPrivateMemberAccess() {
          var CommunityId = $.urlParam('id');

          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.SLP_EditCommunity.GetRequestedMembers}',
              CommunityId,
              DisplayPrivateMemberAccess
          );
      }


      function DisplayPrivateMemberAccess(result, event) {

          $('#divPrivateMembers').empty();

          if (result.length > 0) {

              for (var icnt = 0; icnt < result.length; icnt++) {

                  var EditPrivate = ("<div> <img width='50' height='50' class='m10' src=" + result[icnt].SmallPhotoUrl + " /></span><span class='m5' id=" + result[icnt].Id + ">" + result[icnt].Name + "");


                  var divTitle = (" <span class='searchPopU'>" + result[icnt].Title + " </span> ");
                  EditPrivate += divTitle;


                  var nextTitle = ("</span> <div>" +
                       "<input type='radio' name='ApproveReject_" + result[icnt].Id + "' data-UserId=" + result[icnt].Id + "  value='Approve'>Approve" +
                 "<input type='radio' name='ApproveReject_" + result[icnt].Id + "' value='Reject'>Reject");
                  EditPrivate += nextTitle;

                  $('#divPrivateMembers').append(EditPrivate);
              }
              $('[id$=PrivateMember]').show();
          }
          else {
              $('[id$=PrivateMember]').hide();
          }
      }

      function validatePrivateMembers(event) {


          var strRel = '';
          var PrivateMem = $('#divPrivateMembers')[0].children;
          var CommApprv = $('[id$=txtCommApprv]').val();
          var CommReject = $('[id$=txtCommRjct]').val();

          for (var iLoop = 0; iLoop < PrivateMem.length; iLoop++) {



              if (PrivateMem[iLoop].children[2].children[0].checked) {
                  var UserApprovedId = $(PrivateMem[iLoop].children[2].children[0]).attr('data-UserId');
                  if (strRel == '') {
                      strRel = UserApprovedId + '_' + CommApprv;
                  }
                  else {
                      strRel = strRel + ',' + UserApprovedId + '_' + CommApprv;
                  }

              }
              else if (PrivateMem[iLoop].children[2].children[1].checked) {
                  var UserRejectId = $(PrivateMem[iLoop].children[2].children[0]).attr('data-UserId');
                  if (strRel == '') {
                      strRel = UserRejectId + '_' + CommReject;
                  }
                  else {
                      strRel = strRel + ',' + UserRejectId + '_' + CommReject;
                  }

              }
          }
          $('[id$=txtPriMemAcc]').val(strRel);

          //if (strRel != '') {
          //$("[id$=PrivateMember]").css("display", "block");
          //document.getElementById('{!$Component.EditTopic.PrivateMember}').style.display = 'block';
          //  $('[id$=PrivateMember]').show();
          //}


      }

      function ValidateEditCategory(data) {
          var EditCId = $(data).attr('data-CtgryId');
          var EditCName = $(data).attr('data-CategoryName');
          $('#EditCategory').modal('show');
          $('[id$=txtEditCId]').val(EditCId);
          $('[id$=txtEditCategory]').text(EditCName);
          $('[id$=txtEditCategory]').val(EditCName);
          //$('[id$=btnEditCategory]').click();
      }
      function DeleteCommunityCtgry(data) {
          var EditCId = $(data).attr('data-CtgryId');
          var EditCName = $(data).attr('data-CategoryName');
          $('[id$=txtDeleteCId]').val(EditCId);
          $('#DeleteCategory').modal('show');
      }

      function CommunityChangeOrder() {
          $('[id$=CommunityChangeOrderPopup]').modal('show');
      }

      function RemoveCommunityBoard(data) {

          $('#dvRelatedBoardRemove').modal('show');
          $('[id$=hdrlbrdId]').val(data);
      }

      function ShowChangeOrder(data) {

          var TopicCategoryId = $(data).attr('data-sortctgry');
          var TopicCategoryName = $(data).attr('data_sortctgryNm');
          var CatName = $(data).attr('data-ctgryname');

          $('[id$=txtTopicOrderCategoryId]').val(TopicCategoryId);
          $('[id$=txtTopicOrderCategoryName]').val(TopicCategoryName);
          $('[id$=hdnTopicCatName]').val(CatName);

          var LearningBoardId = $.urlParam('id');

          Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.SLP_EditCommunity.GetCollateralBoardOrder}', TopicCategoryId, RenderChangeOrderDropdown);
      }

      function RenderChangeOrderDropdown(result) {

          $('#list-box').empty();

          $.each(result, function (index, value) {


              $("#list-box").append($("<option></option>").val(this.ID).html(this.Name));
          });

          $('#LearningChangeOrderPopup').modal('show');
      }

      function SaveTopicsChangeOrder(data) {

          var strRel = '';
          $("#list-box > option").each(function () {
              if (strRel == '') {
                  strRel = $(this).val();
              }
              else {
                  strRel = strRel + ',' + $(this).val();
              }
          });

          $('[id$=txtTopicCollateralId]').val(strRel);
      }

      function defaultImgChanged(selObj, path) {

          var selText = selObj.options[selObj.selectedIndex].text;
          var selVal = selObj.options[selObj.selectedIndex].value;
          var selPath = path + selVal;
          if (selVal != '') {
              $('[id$=imgDefault]').attr("src", selPath);
              $('[id$=imgDefault]').attr("alt", selText);
              $('[id$=imgDefault]').attr("class", "");
          }
          else {
              $('[id$=imgDefault]').attr("src", noImgSrc);
              $('[id$=imgDefault]').attr("alt", "no image");
              $('[id$=imgDefault]').attr("class", "viewDefNoImage");
          }
      }

      //function SubmitSearchForm(event) {
      //    
      //    if (event.keyCode == 13) {
      //        
      //        var txtSearch = document.getElementById('{!$Component.UPForm.searchText}');

      //        if (txtSearch.value.length == 0) {
      //            document.getElementById('err_msg').innerHTML = "Enter Value For Search";
      //            document.getElementById('err_msg').style.display = 'block';
      //            event.preventDefault();
      //            event.stopPropagation();
      //            return false;
      //        }
      //        else {
      //            document.getElementById('err_msg').style.display = 'none';
      //            var button = document.getElementById("{!$Component.UPForm.searchButton}");
      //            button.click();
      //        }
      //        return true;
      //    }
      //}

      function VerifyDuplicateCategoryName(btnSave) {

          var CName = $('[id$=txtCtgryNm]').val();
          var CommunityId = $.urlParam('id');

          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateCategoryName}',
                   CName,
                   CommunityId,
                   VerifyTopicDuplCategoryName
               );
      }

      function VerifyTopicDuplCategoryName(result, event) {

          $('#showDuplicateTName').empty();
          if (result > 0) {

              $('#showDuplicateTName').append('Duplicate Category Name');
              $('#showDuplicateTName').append('<br/>');
              funcCreateCategory(event);
          }
          else {
              funcCreateCategory(event);
          }


      }


      function funcCreateCategory(event) {

          $('#showDuplicateTName').hide();
          var CName = $('[id$=txtCtgryNm]').val();
          if (CName == '') {
              $('#showDuplicateTName').append('Enter Category Name');
              $('#showDuplicateTName').append('<br/>');
          }

          if ($('#showDuplicateTName')[0].children.length > 0) {
              $("#showDuplicateTName").show();
              $('#showDuplicateTName').css('display', 'block');
              return false;
          }
          else {
              $('[id$=SaveCategory]').click();
              return true;
          }
      }

      function ValidateCategory() {

          $('[id$=SaveCategory]').click();
          return true;
      }

      function funcVerifyDuplicateTopic(btnSave) {
          $('#DuplicateTName').empty();
          $('#DuplicateTName').hide();

          var TName = $('[id$=txtTopic]').val();
          var catId = $('[id$=Ctgry]').val();

          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateCategoryTopicName}',
                   TName,
                   catId,
                   VerifyTName
               );
      }

      function VerifyTName(result, event) {

          $('#emptyImageUpLoad').empty();
          $('#emptyImageUpLoad').hide();
          $('#errorMsgForEdit').empty();
          $('#errorMsgForEdit').hide();
          if (result > 0) {

              $('#emptyImageUpLoad').append('Duplicate Content Name');
              $('#emptyImageUpLoad').append('<br/>');
              funcCreateTopic(event);
          }
          else {
              funcCreateTopic(event);
          }


      }

      //function funcCreateTopic(event) {

      //    $('#showDuplicateTName').hide();

      //    var TName = $('[id$=txtTopic]').val();

      //    var TDesc = $('[id$=txtTopicArea]').val();

      //    if (TName == '') {
      //        $('#emptyImageUpLoad').append('Enter Content Name');
      //        $('#emptyImageUpLoad').append('<br/>');
      //    }
      //    if (TDesc == '') {
      //        $('#emptyImageUpLoad').append('Enter Content Description');
      //        $('#emptyImageUpLoad').append('<br/>');
      //    }


      //    if ($('#emptyImageUpLoad')[0].children.length > 0) {
      //        $("#emptyImageUpLoad").show();
      //        $('#emptyImageUpLoad').css('display', 'block');

      //        return false;
      //    }
      //    else {
      //        $('[id$=SaveTopic]').click();
      //        return true;
      //    }
      //}

      $(document).ready(function () {
          if ($('[id$=hdnPendingFileUploadTopicId]').val() != "") {
              $('#UploadFile').modal('show');
              ScrollToRelativePosition("UploadFile");
          }


          $('#txtSearchOwner').unbind().bind('keyup paste', function () {

              var FilterResultSet = new Array();
              var hdnSearchResultVal = $('[id$=txtOwnerSearchResult]').val();
              var ResultSet = $.parseJSON(hdnSearchResultVal);
              var value = $(this).val().toUpperCase();

              if (value === '') {
                  if (ResultSet.length > 0) {
                      $('#divChangeOwnerResult').empty();
                      $.each(ResultSet, function (index, domElement) {

                          $('#divChangeOwnerResult').append("<div id='trigger' ><span><input type='radio' name='RelatedOwnerSearch' value=" + domElement.Id + "  /></span><span class='m5' id=" + domElement.Id + ">" + domElement.Name + "</span> <div>");
                      });
                  }
                  return false;
              }

              $.each(ResultSet, function (index, domElement) {

                  var DomText = domElement.Name.toUpperCase();

                  if (DomText.indexOf(value) > -1 || DomText.indexOf(value) == 0) {
                      FilterResultSet.push({ "Id": domElement.Id, "Name": domElement.Name });
                  }
              });

              if (FilterResultSet.length > 0) {
                  $('#divChangeOwnerResult').empty();

                  $.each(FilterResultSet, function (index, domElement) {

                      $('#divChangeOwnerResult').append("<div id='trigger'><span><input type='radio' name='RelatedOwnerSearch' value=" + domElement.Id + "  /></span><span class='m5' id=" + domElement.Id + ">" + domElement.Name + "</span> <div>");
                  });
              }
          });
      });

      function ClearAddRelatedBoardFields() {
          $('#txtAddRelative').val('');
          $('#AddRelative').empty();
      }

      function BindProvideMemberAccess() {

          var CommunityId = $.urlParam('id');

          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.SLP_EditCommunity.GetSelectedMembers}',
              CommunityId,
              BindSelectedMembers
          );

          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.SLP_EditCommunity.GetAvailableMembers}',
              CommunityId,
              BindAvailableMembers
          );
      }

      $("#KPIMoveRight,#KPIMoveLeft").unbind().bind("click", function (event) {
    debugger;
          var id = $(event.target).attr("id");
          var selectFrom = id == "KPIMoveRight" ? "#KPI_Left" : "#KPI_Right";
          var moveTo = id == "KPIMoveRight" ? "#KPI_Right" : "#KPI_Left";
          MoveListBox(selectFrom, moveTo);
          if (selectFrom == "#KPI_Left") {
              $("#searchtext_kpileft").val("");
              $("#searchtext_kpileft").trigger("keyup");
          }
          else {
              $("#searchtext_kpiright").val("");
              $("#searchtext_kpiright").trigger("keyup");
          }
      });

      $("#KPIMoveAllRight,#KPIMoveAllLeft").unbind().bind("click", function (event) {
          var id = $(event.target).attr("id");
          var selectFrom = id == "KPIMoveAllRight" ? "#KPI_Left" : "#KPI_Right";
          var moveTo = id == "KPIMoveAllRight" ? "#KPI_Right" : "#KPI_Left";
          MoveAllListBox(selectFrom, moveTo);
      });

      function MoveListBox(selectFrom, moveTo) {
debugger;
          var selectedItems = $(selectFrom).find("option:selected");
          if (selectedItems.length > 0) {
              $('span.error-keyup-2').remove();
              
              
              if(selectFrom=="#KPI_Left")
              {
              $('#HdnKPI_Left option[value="'+$(selectFrom).find("option:selected").val()+'"]').remove();
              }
              else if(selectFrom=="#KPI_Right")
              {
              $('#HdnKPI_Right option[value="'+$(selectFrom).find("option:selected").val()+'"]').remove();
              }
              $(selectFrom).find("option:selected").remove().appendTo(moveTo);
               //$('selectFrom  option:selected').remove().appendTo(moveTo);
              //$(moveTo).append(selectedItems);
              //$(selectFrom).find("option:selected").remove();
              Sort(moveTo);
              Sort(selectFrom);
          }
          else {
              $('span.error-keyup-2').remove();
              $(selectFrom).after("<span class='error error-keyup-2' style='color:red;'>Please Select at least one user</span>");
          }
      }

      function MoveAllListBox(selectFrom, moveTo) {
          $('span.error-keyup-2').remove();
          var selectedItems = $(selectFrom).find("option");
          var output = [];
          $.each(selectedItems, function (key, e) {
              output.push('<option value="' + e.value + '" title="' + e.text + '">' + e.text + '</option>');
          });
          $(moveTo).append(output.join(""));
          selectedItems.remove();
          Sort(moveTo);
      }



      function SearchListBox(TextBox, MainListBox, HdnListBox, SecondListBox) {
      debugger;
          $("#" + TextBox).css({ "background-image": "url(../Content/img/loader.gif)", "background-position": "right", "background-repeat": "no-repeat", "background-size": "contain" });
          var textbox = $("#" + TextBox).val();
          var listbox = $('#' + MainListBox).find("option");
          var hdnlist = $('#' + HdnListBox).find("option");
          if (textbox == "") {
              $("#" + TextBox).css({ "background-image": "none" });
          }
          var resultMarkup = "";
          if (listbox.length != hdnlist.length) {

              $.each(hdnlist, function (indexA, valueA) {
                  $.each($('#' + SecondListBox).find("option"), function (indexB, valueB) {

                      if (valueA.value == valueB.value) {
                          valueA.selected = "selected";
                      }
                  });
              });
              $('#' + HdnListBox).find("option:selected").remove();
          }

          if (listbox.length > hdnlist.length || (listbox.length < hdnlist.length && $('#' + HdnListBox).find("option").length == 0)) {
              $('#' + HdnListBox).empty();
              $.each($('#' + MainListBox).find("option"), function (index, e) {
                  resultMarkup += '<option value="' + e.value + '">' + e.text + '</option>';
              });
              $('#' + HdnListBox).html(resultMarkup);
          }

          resultMarkup = "";
          var Items = $('#' + HdnListBox).find("option");
          for (var childIndex = 0; childIndex < Items.length; childIndex++) {

              if (Items[childIndex].text.toLowerCase().indexOf(textbox.toLowerCase()) == 0 || Items[childIndex].text.toLowerCase().indexOf(textbox.toLowerCase()) > -1) {
                  resultMarkup += '<option value="' + Items[childIndex].value + '">' + Items[childIndex].text + '</option>';
              }
          }
          $('#' + MainListBox).empty();
          $('#' + MainListBox).html(resultMarkup);
          if (resultMarkup == "") {
              $("#" + TextBox).css({ "background-image": "none" });
          }
          setTimeout(function () { $("#" + TextBox).css({ "background-image": "none" }); }, 300);
      }

      function BindSelectedMembers(result, event) {


          $('#KPI_Right').empty();

          var output = [];
          $.each(result, function (key, e) {
              output.push('<option value="' + e.Id + '" title="' + e.Name + '">' + e.Name + '</option>');
          });
          $('#KPI_Right').append(output.join(""));
      }

      function BindAvailableMembers(result, event) {


          $('#KPI_Left').empty();

          var output = [];
          $.each(result, function (key, e) {
              output.push('<option value="' + e.Id + '" title="' + e.Name + '">' + e.Name + '</option>');
          });
          $('#KPI_Left').append(output.join(""));
      }

      function SaveOrUpdateMembers(data) {
debugger;
          var strValue = '';
          $("#KPI_Right > option").each(function () {
              if (strValue == '') {
                  strValue = $(this).val();
              }
              else {
                  strValue = strValue + ',' + $(this).val();
              }
          });

          $('[id$=txtUserMemberIds]').val(strValue);
      }

      function Sort(elementId) {

          // Convert the listbox options to a javascript array and sort (ascending)
          var sortedList = $.makeArray($(elementId + " option"))
              .sort(function (a, b) {
                  return $(a).text() < $(b).text() ? -1 : 1;
              });
          // Clear the options and add the sorted ones
          $(elementId).empty().html(sortedList);
      }

      function ScrollToRelativePosition(positionId) {
          $("html, body").animate({ scrollTop: $('#' + positionId).offset().top }, 1000);
      }

      function SubmitAddBoardSearch(event) {
          if (event.keyCode == 13) {

              var txtSearch = $('#txtAddRelative').val();
              if (txtSearch == '') {
                  document.getElementById('dvReleatedBoardErrorMsg').innerHTML = "Enter Value For Search";
                  $('[id$=dvReleatedBoardErrorMsg]').show();
                  event.preventDefault();
                  event.stopPropagation();
                  return false;
              }
              else {

                  SearchAddRelatedBoard();
                  event.preventDefault();
                  event.stopPropagation();
                  return false;
              }
              //return true;
          }
      }

      function AddRelCommunityBoards() {

          ClearAddRelatedBoardFields();
          $('#dvReleatedBoardErrorMsg').empty();
          $('#dvReleatedBoardErrorMsg').hide();
          $('#AddBoards').modal('show');
      }

      function ShowBoardRating(data) {

          var BoardID = $(data).attr('data-boardLBid');

          //$('#' + data.id).css("cursor", "default");

          $('#' + BoardID).show();
      }

      function HideBoardRating(data) {
          var BoardID = $(data).attr('data-boardLBid');

          $('#' + BoardID).hide();
      }
      function functionTargetUrl(data) {
      debugger;
          var TopicID = "anchor_" + $(data).attr('data-ID');
          var TopicURL = $(data).attr('data-URL');
          var PPTTopicURL=decodeURIComponent(TopicURL);

          //var PPTTopicURL = unescape(TopicURL);
          //PPTTopicURL=encodeURIComponent(PPTTopicURL);
          if(PPTTopicURL.indexOf('amp;')!=-1)
          {
          PPTTopicURL=PPTTopicURL.replace(/amp;/g,'');
          }

          $('[id$=' + TopicID + ']').attr('href', PPTTopicURL);
      }

      function EditopenNewWindow() {
          $('#errorMsgForEdit').empty();
          $('#errorMsgForEdit').hide();
          //var TestURL = $('[id$=LearningTopic]').val();
          var TestURL = $('#lblTopicType').text();
          if (TestURL == "Video") {
              var srcurl1 = $.trim($('[id$=txtEditVideoURL]').val());
              var isUrlValid = isValidUrl(srcurl1);
              if ((srcurl1 != '') && (isUrlValid)) {
                  if (srcurl1.indexOf("youtube.com") > -1) {
                      $('#errorMsgForEdit').empty();
                      if (srcurl1.indexOf("www") == -1) {
                          srcurl1 = "www." + srcurl1;

                      }
                      if (srcurl1.indexOf("https") == -1) {
                          if (srcurl1.indexOf("http") == -1) {
                              srcurl1 = 'https://' + srcurl1;
                          }
                      }
                      if (isValidUrl(srcurl1)) {

                          $('#EditTopicVideo').show();
                          $('[id$=EditVideoURL]').show();
                          $('[id$=novideo]').hide();


                          srcurl1 = srcurl1.replace("watch?v=", "embed/");
                          srcurl1 = srcurl1.replace("http:", "https:");
                          $('#EditVideoURL').attr('src', srcurl1);
                          $('#EditVideoURL').reload(true);
                      }

                      else {
                          $('#errorMsgForEdit').append('Enter Valid URL');
                          $('#errorMsgForEdit').append('<br/>');
                          if ($('#errorMsgForEdit')[0].children.length > 0) {
                              $("#errorMsgForEdit").show();
                              $('#EditTopicVideo').hide();
                              $('#errorMsgForEdit').css('display', 'block');

                              return false;
                          }


                      }

                  }

              }

              else {
                  if ($('[id$=txtEditVideoURL]').val() == '') {

                      $('#errorMsgForEdit').append('Enter URL');
                      $('#errorMsgForEdit').append('<br/>');
                  }
                  if ((!isUrlValid) && $('[id$=txtEditVideoURL]').val() != '') {
                      $('#errorMsgForEdit').append('Enter Valid URL');
                      $('#errorMsgForEdit').append('<br/>');
                  }
                  if ($('#errorMsgForEdit')[0].children.length > 0) {
                      $("#errorMsgForEdit").show();
                      $('#errorMsgForEdit').css('display', 'block');

                      return false;
                  }
              }

          }
          else {

              // var href = $('[id$=txtEditVideoURL]').val();
              // if (href != '') {
              // if (href.indexOf('http://') > -1) {
              // href = href.replace('http://', 'http://')
              // }
              // else if (href.indexOf('www.') > -1) {
              // href = href.replace('www.', 'https://')
              // }
              // else if (href.indexOf('https://') > -1) {
              // href = href.replace('https://', 'https://')
              // }
              // else if (href.indexOf('http://') <= -1 && href.indexOf('www.') <= -1) {
              // href = 'http://' + href;
              // }

              // //var link = $('<a href="http://' + href + '" />');
              // var link = $('<a href="' + href + '" />');
              // link.attr('target', '_blank');
              // window.open(link.attr('href'));
              // }
              EditTestLinkUrl();
          }
      }

      function EditTestLinkUrl() {
          $('#errorMsgForEdit').empty();
          $('#errorMsgForEdit').hide();
          var href = $('[id$=txtEditVideoURL]').val();
          if (href != '') {
          if(href.length>255)
          {
            $('#errorMsgForEdit').append('URL length should be 255 characters');
            $('#errorMsgForEdit').append('<br/>');
          }
          else
          {
              if ((href.startsWith('https://')) || (href.startsWith('http://'))) {
                  var link = $('<a href="' + href + '" />');
                  link.attr('target', '_blank');
                  window.open(link.attr('href'));

              }
              else {
                  $('#errorMsgForEdit').append('Unfortunately we were not able to accept this URL. Please make sure it is a valid URL (starting with https:// or http://) and try again.');
                  $('#errorMsgForEdit').append('<br/>');

              }
          }
         }
          else {
              $('#errorMsgForEdit').append('Enter Url. Please make sure it is a valid URL (starting with https:// or http://) and try again.');
              $('#errorMsgForEdit').append('<br/>');
          }

          if ($('#errorMsgForEdit')[0].children.length > 0) {
              $("#errorMsgForEdit").show();
              $('#errorMsgForEdit').css('display', 'block');

              return false;
          }
      }


      function NavigateUrl(data) {

          var TopicID = "linkDoc_" + $(data).attr('data-ID');
          var TopicURL = $(data).attr('Data-Url');

          var PPTTopicURL = unescape(TopicURL);
debugger;

          $('[id$=' + TopicID + ']').attr('href', PPTTopicURL);
      }

      function OpenContributorNamePopup() {

          $('#dvContributorsList').empty();
          $('[id$=txtSearchUsers]').val('');
          $('[id$=dvctrbtrErrorMsg]').hide();
          $('#UserNamePopUp').modal('show');

          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.FetchContributorsList}',
                    $.urlParam('id'),
                    DisplayContributorsList);
      }

      function DisplayContributorsList(result, event) {

          var resultSet = JSON.stringify(result);

          $('#hdnSearchResult').val(resultSet);

          if (result.length > 0) {
              for (var icnt = 0; icnt < result.length; icnt++) {
                  $('#dvContributorsList').append("<div id='trigger' ><span><input type='radio' name='RelatedContributorSearch' value=" + result[icnt].Id + "  /></span><span class='m5' id=" + result[icnt].Id + ">" + result[icnt].Name + "</span> <div>");
              }
          }

          $('#txtSearchUsers').focus();
      }

      function SaveOrAddContributor(data) {

          var strRel = '';

          $('input[name="RelatedContributorSearch"]:checked').each(function () {
              if (strRel == '') {
                  strRel = $(this).val();
              }
              else {
                  strRel = strRel + ',' + $(this).val();
              }
          });

          $('[id$=hdncontributorlist]').val(strRel);

          if (strRel == '') {
              $('[id$=dvctrbtrErrorMsg]').empty();
              $('[id$=dvctrbtrErrorMsg]').append('Select at least one user');
              $('[id$=dvctrbtrErrorMsg]').append('<br/>');
              $('[id$=dvctrbtrErrorMsg]').show();

              event.preventDefault();
              return false;
          }
          else {
              $('[id$=dvctrbtrErrorMsg]').hide();
              $('[id$=btnSaveContributor]').click();
          }
      }

      function functionTextSearchUser(event) {

          if (event.keyCode == 13) {
              event.preventDefault();
              return false;
          }
      }

      function OpenChangeNamePopup() {

          $('#divChangeOwnerResult').empty();
          $('[id$=txtSearchOwner]').val('');
          $('[id$=spnChangeOwnerErrorMsg]').hide();
          $('#dvChangeOwnerModal').modal('show');

          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.FetchContributorsList}',
                    $.urlParam('id'),
                    DisplayOwnersList);
      }

      function DisplayOwnersList(result, event) {

          var resultSet = JSON.stringify(result);

          $('#txtOwnerSearchResult').val(resultSet);

          if (result.length > 0) {
              for (var icnt = 0; icnt < result.length; icnt++) {
                  $('#divChangeOwnerResult').append("<div id='trigger' ><span><input type='radio' name='RelatedOwnerSearch' value=" + result[icnt].Id + "  /></span><span class='m5' id=" + result[icnt].Id + ">" + result[icnt].Name + "</span> <div>");
              }
          }
          $('#txtSearchOwner').focus();
      }

      function SaveOrAddOwner() {
          var strRel = '';

          $('input[name="RelatedOwnerSearch"]:checked').each(function () {
              if (strRel == '') {
                  strRel = $(this).val();
              }
          });

          $('[id$=txtChangeOwnerId]').val(strRel);

          if (strRel == '') {
              $('[id$=spnChangeOwnerErrorMsg]').empty();
              $('[id$=spnChangeOwnerErrorMsg]').append('Select at least one user');
              $('[id$=spnChangeOwnerErrorMsg]').append('<br/>');
              $('[id$=spnChangeOwnerErrorMsg]').show();

              event.preventDefault();
              return false;
          }
          else {
              $('[id$=spnChangeOwnerErrorMsg]').hide();
              $('[id$=btnSaveOrUpdateOwner]').click();
          }
      }

      function OpenAssociatedModalPopUp(data) {

          var DocType = $(data).attr('Data-DocType');
          var Url = $(data).attr('Data-Url');

          if (DocType == 'PDF') {
              ShowPDF(Url);
          }
          else if (DocType == 'PPT') {
              ShowPPTX(Url);
          }
          else if (DocType == 'DOC') {

          }
          else if (DocType == 'XLS') {
              ShowXLSX(Url);
          }
          else if (DocType == 'TXT') {
              ShowTXT(Url);
          }
          else if (DocType == 'OTHER') {
              ShowHTML(Url);
          }
      }

      function ShowPDF(data) {

          //var pdfURL = $(data).attr('Data-Url');

          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'block';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappPDF' } };

          m.payload.url = data;
          m.payload.contenttype = 'application/pdf';
          Sfdc.canvas.controller.publish(m);
          $('#modalPreviewRequired').modal('show');
      }

      function ShowDOCX(data) {

          //var pdfURL = $(data).attr('Data-Url');

          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'block';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappDOCX' } };

          m.payload.url = data;
          m.payload.contenttype = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';
          Sfdc.canvas.controller.publish(m);
          $('#modalPreviewRequired').modal('show');
      }
      function ShowPPTX(data) {

          //var pdfURL = $(data).attr('Data-Url');

          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'block';


          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappPPTX' } };

          m.payload.url = data;
          m.payload.contenttype = 'application/vnd.openxmlformats-officedocument.presentationml.presentation';
          Sfdc.canvas.controller.publish(m);

          $('#modalPreviewRequired').modal('show');
      }

      function ShowXLSX(data) {

          //var pdfURL = $(data).attr('Data-Url');

          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'block';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappXLSX' } };

          m.payload.url = data;
          m.payload.contenttype = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
          Sfdc.canvas.controller.publish(m);
      }

      function ShowHTML(data) {


          //var pdfURL = $(data).attr('Data-Url');

          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'block';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappHTML' } };

          //var urlText = pdfURL;
          //if (url.indexOf("https") == -1) {
          //    urlText = url.replace("http:", "https:");
          //}

          m.payload.url = data;
          m.payload.contenttype = 'html';
          Sfdc.canvas.controller.publish(m);
          $('#modalPreviewRequired').modal('show');
      }

      function ShowTXT(url) {

          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'block';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappTXT' } };

          m.payload.url = url;
          m.payload.contenttype = 'text/plain';
          Sfdc.canvas.controller.publish(m);
          $('#modalPreviewRequired').modal('show');
      }

      function functionOpenVideo(data) {


          var videoNameHeading = $(data).attr('Data-Name');

          var videoURL = $(data).attr('Data-Url');

          $('#frameVideo').attr('src', videoURL);
          $('#videoHeading').text(videoNameHeading);

          $('#VideoPopUp').modal('show');

      }

      function CommunityExportToExcel() {

          var CommunityId = $.urlParam('id');

          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.SLP_EditCommunity.GetCommunityMemberDetailsExcel}',
              CommunityId,
              ExportToExcelResult
          );


      }

      function ExportToExcelResult(result, event) {

          var CommName = $('[id$=txtCommunityname]').val();
          if (CommName.length > 30) {
              CommName = CommName.substr(0, 30);
          }

          var tabla = '<html  xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"><head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>' + CommName + '</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml></head> <body> <table id="tblExport"><tr>';
          tabla += '<th>FirstName</th><th>LastName </th><th>Name</th><th>Email</th><th>Role</th><th>Business Group</th><th>Region</th><th> Community Role</th> </tr>';
          for (var iCnt = 0; iCnt < result.length; iCnt++) {
              tabla += '<tr>';
              tabla += '<td> ' + result[iCnt].FirstName + ' </td>';
              tabla += '<td> ' + result[iCnt].LastName + ' </td>';
              tabla += '<td> ' + result[iCnt].Name + ' </td>';
              tabla += '<td> ' + result[iCnt].Email + ' </td>';
              if (result[iCnt].Role != undefined) {
                  tabla += '<td> ' + result[iCnt].Role + ' </td>';
              }
              else {
                  tabla += '<td></td>';
              }
              if (result[iCnt].BusinessGrp != undefined) {
                  tabla += '<td> ' + result[iCnt].BusinessGrp + ' </td>';
              }
              else {
                  tabla += '<td></td>';
              }
              if (result[iCnt].Region != undefined) {
                  tabla += '<td> ' + result[iCnt].Region + ' </td>';
              }
              else {
                  tabla += '<td></td>';
              }

              tabla += '<td> ' + result[iCnt].ContributororMem + ' </td>';
              tabla += '</tr>';
          }

          tabla += '</table></body></html>';

          var dateT = new Date();
          CommName = CommName + '_' + dateT.format("d-M-Y");

          var filename = CommName + '.xls';   //'Community Name.xls';

          var link = document.createElement('a');
          var mimeType = 'application/xls';

          var blob = new Blob([tabla], { type: mimeType });
          var url = URL.createObjectURL(blob);
          link.href = url;

          link.setAttribute('download', filename);
          link.click();

      }
      
      function SearchLearningBoard() {
          //$('#AddLearningSearch').empty();
          $('#ExternalSearch').empty();
          //$('#TopicResult').text('0');
          //$('#SearchRes').text('0');
          $('#BtnSaveSearchTopics').hide();
          var searchData = $('#txtLearningBrd').val();
          var QueryStringId = $.urlParam('id');
          if (searchData.length==0) {
              document.getElementById('emptySearchTopic').innerHTML = "Enter Value For Search";
              $('[id$=emptySearchTopic]').show();
              //document.getElementById('emptySearchTopic').style.display = 'block';
              event.preventDefault();
              event.stopPropagation();
              return false;
          }
          else {
              $('#dvExternalSearch').css('display','block');
              $('#SearchRes').text('0');
              $('#divSearchTopicResult').show();
              //$('#AddLearningSearch').show();
              $('[id$=emptySearchTopic]').empty();
              $('[id$=emptySearchTopic]').hide();
               Visualforce.remoting.Manager.invokeAction(
                 '{!$RemoteAction.SLP_EditCommunity.Externalsearch}',
                 searchData,
                 QueryStringId,
                  DisplayExternalSearch
              );

          }
      
      }
                
      function DisplayExternalSearch(result, event) 
      {
          var count=0;
          $('#ExternalSearch').empty();
          $('#ExternalSearch').append("<div>");
          var IdolHtml='';
          $('#divSearchTopicResult').hide();  
          $('#divSearchTopicResult').css('display','none');          
            
          for (var icnt = 0; icnt < result.length; icnt++)
          {
              var DescSummary=result[icnt].Summary;
              
              if(result[icnt].Url!='')
              {  
                  IdolHtml = ($.parseHTML(DescSummary)[0].data).replace('<font color=red>','').replace('</font>','');
                  count++;              
                               
                  $('#ExternalSearch').append("<div><span class='m5'> <a href="+result[icnt].Url +"  data-url="+result[icnt].Url+" id='SearchLinkUrl' />"+ 
                      " </span> <br/><span class='searchPopU'>" + result[icnt].Title  + " </span><br><span  class='LinkDesc'>"+ IdolHtml +" </span>"+
                      "<input type='hidden' class='LinkSummary' value="+"\""+result[icnt].Summary+"\""+"/><div><input type='button' data-url="+result[icnt].Url+" data-Title='" + result[icnt].Title  + "' data-Desc="+"\""+result[icnt].Summary+"\""+"  class='btnAthena btn-primary btnAthenaPopP' value='Add' onclick='CreateIdolSearchTopic(this)'/></div>"+
                      "</div><hr/> ");
              }
                    
          }
          
          $('#SearchRes').val(count);
          $('#SearchRes').text(count);
            
          $('#ExternalSearch').append("</div>");
            
          // }
            
      }
      
      function CreateIdolSearchTopic(data)
      {
      debugger;
        $('#txtLearningBrd').val('');
      if($('[id$=InputCheckbox1]').is(':checked')==true)
      $('[id$=InputCheckbox1]').trigger('click');
      if($('[id$=InputCheckbox2]').is(':checked')==true)
      $('[id$=InputCheckbox2]').trigger('click');
      if($('[id$=InputCheckbox3]').is(':checked')==true)
      $('[id$=InputCheckbox3]').trigger('click');
  
          $('#DivDuplicateIdolTName').empty(); 
          $('#DivDuplicateIdolTName').hide();
          var categoryId= $('[id$=lblCategory]').val();
          var CtgryName= $('[id$=lblCategory]').text();
          //'lblGblCtgry'
          $('[id$=TopicCtrgy]').val(categoryId);
          $('[id$=lblGblCtgry]').val(categoryId);
          $('[id$=lblGblCtgry]').text(CtgryName);
      
          $('#GlobalSearch').modal('show');
          //$($($($($($('[id$=IdolSearchRadio]')[0].children)[0].children)[0].children)[0].children)[0]).attr('checked','checked');
          //$('[id$=UploadSearchUrl]').show();
          $('[id$=DefaultSearchUrl]').show();
          $('[id$=TopicCtrgy]').hide();
          $('[id$=lblGblCtgry]').show();
          //var SearchLinkUrl=$('#SearchLinkUrl').attr('data-url');
          var SearchLinkUrl=$(data).attr('data-url');
          var SearchTitle=$(data).attr('data-Title');  //Commented by Komala
          //var SearchTitle=$($(this).parent().parent()[0]).find('span.searchPopU').text();
          //var SearchTitle=$('.LinkSummary').val();
          var LinkDesc=$(data).attr('data-Desc').replace(/(<([^>]+)>)/ig,""); 
          $('[id$=SearchTopicNm]').val(SearchTitle);
          $('[id$=SearchTopicDesc]').val(LinkDesc);
          $('[id$=SearchLinkUrl]').val(SearchLinkUrl);
          $('#GlobalSearch').modal('show');
      }
      
      function VerifyDuplicateTopicName(btnSave) {
            
          var TName=document.getElementById('{!$Component.EditTopic.txtTopic}').value;
          var CommunityId = $.urlParam('id');
          //var TName = $('#txtTopic').attr('data-TName');
          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateTopicName}',
                   TName,
                   CommunityId,
                   VerifyTopicDuplName
               );
      }

      function VerifyTopicDuplName(result,event) {
            
          $('#showDuplicateTName').empty();
          $('#showDuplicateTName').hide();
          $('#emptyImageUpLoad').hide();
          if (result>0) {
            
              $('#showDuplicateTName').append('Duplicate Content Name');
              $('#showDuplicateTName').append('<br/>');
              if ($('#showDuplicateTName')[0].children.length > 0) {
                  $("#showDuplicateTName").show();
                  $('#showDuplicateTName').css('display', 'block');
                
                  return false;
              }
          }
      }
      
      function SearchTopic(event){
           
          if (event.keyCode == 13) {
              //$('#AddLearningSearch').empty();
              $('#ExternalSearch').empty();
        
              //$('#TopicResult').text('0');
              $('#SearchRes').text('0');
              $('#BtnSaveSearchTopics').hide();
              var searchData = $('#txtLearningBrd').val();
              var QueryStringId = $.urlParam('id');
              if (searchData.length == 0) {
                  document.getElementById('emptySearchTopic').innerHTML = "Enter Value For Search";
                  document.getElementById('emptySearchTopic').style.display = 'block';
                  event.preventDefault();
                  event.stopPropagation();
                  return false;
              }
              else {
                  $('#divSearchTopicResult').show();
                  //$('#AddLearningSearch').show();
                  $('#emptySearchTopic').hide();
                  $('[id$=emptySearchTopic]').empty();
                  document.getElementById('emptySearchTopic').style.display = 'none';
                  Visualforce.remoting.Manager.invokeAction(
                 '{!$RemoteAction.SLP_EditCommunity.Externalsearch}',
                 searchData,
                 QueryStringId,
                  DisplayExternalSearch
              );
              }
      
          }
      }
      
      
       function funcIdolCreateTopic()
      {       

          var TName=document.getElementById('{!$Component.EditTopic.SearchTopicNm}').value;
          var CommunityId = $.urlParam('id');
          //var TName = $('#txtTopic').attr('data-TName');
          Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.SLP_EditCommunity.VerifyDuplicateTopicName}',
                   TName,
                   CommunityId,
                   VerifyIdolLinkTName
               );

      }

    function VerifyIdolLinkTName(result,event) {
         
          $('#DivDuplicateIdolTName').empty();
          if (result>0) {
            
              $('#DivDuplicateIdolTName').append('Duplicate Content Name');
              $('#DivDuplicateIdolTName').append('<br/>');
              //ValidateCreateIdolSearchTopic();
              $('[id$=DivDuplicateIdolTName]').show();
              
              $("html, body").animate({ scrollTop: $('#DivDuplicateIdolTName').offset().top }, 1000);
          }
          else
          {
              ValidateCreateIdolSearchTopic();
          }
       
      }


      function ValidateCreateIdolSearchTopic()
      {
          
          $('#DivDuplicateIdolTName').empty();

          var TName= $('[id$=SearchTopicNm]').val();
            
          var TDesc=$('[id$=SearchTopicDesc]').val();
               
          if (TName=='') {
              $('#DivDuplicateIdolTName').append('Enter Content Name');
              $('#DivDuplicateIdolTName').append('<br/>');
          }
          if (TDesc=='') {
              $('#DivDuplicateIdolTName').append('Enter Content Description');
              $('#DivDuplicateIdolTName').append('<br/>');
          }         
          
          if ($('#DivDuplicateIdolTName')[0].children.length > 0) {
              $("#DivDuplicateIdolTName").show();
              $('#DivDuplicateIdolTName').css('display', 'block');
               
              return false;
          }
          else {
              $("#DivDuplicateIdolTName").hide();
              $('[id$=btnIdolSave]').click();
              return true;
          }

      }
      
      function openLinkInNewWindow()
      {
        debugger;
        var url= $('[id$=SearchLinkUrl]').val();
        if(url=='')
        {
        $('#DivDuplicateIdolTName').html('Enter url to test');
        $('#DivDuplicateIdolTName').show();
        $('#DivDuplicateIdolTName').css('display', 'block');
        return false;
        }
        else
        {
        window.open(url, '_blank');
        }
      }
        
      function openLinkInNewWindow1()
      {
        debugger;
        var url= $('[id$=InputTextURL]').val();
        if(url=='')
        {
        $('#emptyImageUpLoad').html('Enter url to test');
        $('#emptyImageUpLoad').show();
        $('#emptyImageUpLoad').css('display', 'block');
        return false;
        }
        else if(url.indexOf('youtube')!=-1){
                          $('#emptyImageUpLoad').hide();
                          $('[id$=testvideo]').show();
                          $('[id$=novideo]').hide();
           
                          url= url.replace("watch?v=", "embed/");
                          url= url.replace("http:", "https:");
                          $('#testvideo').attr('src', url);
                          $('#testvideo').reload(true);
                      }
        else
        {
        $('#emptyImageUpLoad').hide();
        $('#emptyImageUpLoad').css('display', 'none');
        if (!/^(f|ht)tps?:\/\//i.test(url)) {
          url = "http://" + url;
        }
        window.open(url, '_blank');
        }
      }
    </script>
  </body>
  <!-- END BODY -->
  </html>
</apex:page>