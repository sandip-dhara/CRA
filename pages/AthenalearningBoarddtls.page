<apex:page controller="AthenaLearningBoardDtls" showheader="false" action="{!InserSession}" standardstylesheets="true" doctype="html-5.0" applybodytag="false" applyhtmltag="false">
  <!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
  <!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
  <!--[if !IE]><!-->
  <html lang="en">
  <!--<![endif]-->
  <!-- BEGIN HEAD -->
  <head>
  <meta charset="utf-8" />
  <title>View Board</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta content="" name="description" />
  <meta content="" name="hp" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/css/bootstrap.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/css/bootstrap-responsive.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/font-awesome/css/font-awesome.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/icomoon/iconMoon.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style-responsive.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style-default.css')}" />
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/jquery-1.8.3.min.js')}"/>
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/data-tables/DT_bootstrap.css')}" />
  <apex:includeScript value="{!URLFOR($Resource.OpenFile)}"/>
  <script>
  
                              $(document).ready(function(){
                                  var operatingSystem=navigator.appVersion;
                                  operatingSystem=operatingSystem.substring(0,operatingSystem.indexOf("\)")+1);
                                  $('[id$=hdnOperatingSystem]').val(operatingSystem);
                                  $('[id$=hdnBrowser]').val(FindBrowserVersion());
                                  $('[id$=hdnShareOperatingSystem]').val(operatingSystem);
                                  $('[id$=hdnShareBrowser]').val(FindBrowserVersion());
                                  $('[id$=hdnShareDeviceType]').val('Desktop');
                                  
                                  $('[id$=hdnRateOperatingSystem]').val(operatingSystem);
                                  $('[id$=hdnRateDeviceType]').val('Desktop');
                                  $('[id$=hdnRateBrowser]').val(FindBrowserVersion());
                                  
                                  $('[id$=hdnContRateOperatingSystem]').val(operatingSystem);
                                  $('[id$=hdnContRateDeviceType]').val('Desktop');
                                  $('[id$=hdnContRateBrowser]').val(FindBrowserVersion());
                                  debugger;  //Indrapal
                              });
      function FindBrowserVersion()
      {
          debugger
          var nVer = navigator.appVersion;
          var nAgt = navigator.userAgent;
          var browserName  = navigator.appName;
          var fullVersion  = ''+parseFloat(navigator.appVersion); 
          var majorVersion = parseInt(navigator.appVersion,10);
          var nameOffset,verOffset,ix;
          if ((verOffset=nAgt.indexOf("Opera"))!=-1) {
              browserName = "Opera";
              fullVersion = nAgt.substring(verOffset+6);
              if ((verOffset=nAgt.indexOf("Version"))!=-1) 
                  fullVersion = nAgt.substring(verOffset+8);
          }
              // In MSIE, the true version is after "MSIE" in userAgent
          else if ((verOffset=nAgt.indexOf("MSIE"))!=-1) {
              browserName = "Microsoft Internet Explorer";
              fullVersion = nAgt.substring(verOffset+5);
          }
              // In Chrome, the true version is after "Chrome" 
          else if ((verOffset=nAgt.indexOf("Chrome"))!=-1) {
              browserName = "Chrome";
              fullVersion = nAgt.substring(verOffset+7);
          }
              // In Safari, the true version is after "Safari" or after "Version" 
          else if ((verOffset=nAgt.indexOf("Safari"))!=-1) {
              browserName = "Safari";
              fullVersion = nAgt.substring(verOffset+7);
              if ((verOffset=nAgt.indexOf("Version"))!=-1) 
                  fullVersion = nAgt.substring(verOffset+8);
          }
              // In Firefox, the true version is after "Firefox" 
          else if ((verOffset=nAgt.indexOf("Firefox"))!=-1) {
              browserName = "Firefox";
              fullVersion = nAgt.substring(verOffset+8);
          }
              // In most other browsers, "name/version" is at the end of userAgent 
          else if ( (nameOffset=nAgt.lastIndexOf(' ')+1) < (verOffset=nAgt.lastIndexOf('/')) ) {
              browserName = nAgt.substring(nameOffset,verOffset);
              fullVersion = nAgt.substring(verOffset+1);
              if (browserName.toLowerCase()==browserName.toUpperCase()) {
                  browserName = navigator.appName;
              }
          }
          else
          {
              browserName= nAgt;
              fullVersion="None";
          }
          // trim the fullVersion string at semicolon/space if present
          if ((ix=fullVersion.indexOf(";"))!=-1)
              fullVersion=fullVersion.substring(0,ix);
          if ((ix=fullVersion.indexOf(" "))!=-1)
              fullVersion=fullVersion.substring(0,ix);

          majorVersion = parseInt(''+fullVersion,10);
          if (isNaN(majorVersion)) {
              fullVersion  = ''+parseFloat(navigator.appVersion); 
              majorVersion = parseInt(navigator.appVersion,10);
          }
          var BrowserVer='';
          if(fullVersion=='None')
          {
              BrowserVer=browserName;
          }
          else
          {
              BrowserVer=browserName+' '+fullVersion;
          }
          return BrowserVer;
      }
      
     
      function GetOSName(data)
      {
          debugger;
          if(data.indexOf('Windows 95')!=-1) return 'Windows 95';
                                     
          else if(data.indexOf('Windows 98')!=-1) return 'Windows 98';

          else if(data.indexOf('Windows NT 5.0')!=-1 || data.indexOf('Windows 2000')!=-1) return 'Windows 2000';

          else if(data.indexOf('Windows NT 5.1')!=-1 || data.indexOf('Windows XP')!=-1) return 'Windows XP';

          else if(data.indexOf('Windows NT 5.2')!=-1) return 'Windows Server 2003';
  
          else if(data.indexOf('Windows NT 6.0')!=-1) return 'Windows Vista';

          else if(data.indexOf('Windows NT 6.1')!=-1) return 'Windows 7';
          else if(data.indexOf('Windows NT 6.2')!=-1) return 'Windows 8';

          else if(data.indexOf('Windows NT 4.0')!=-1 || data.indexOf('WinNT4.0')!=-1 || data.indexOf('WinNT')!=-1) return 'Windows NT 4.0';

          else if(data.indexOf('Windows ME')!=-1) return 'Windows ME';
  
          else if(data.indexOf('OpenBSD')!=-1) return 'Open BSD';
  
          else if(data.indexOf('SunOS')!=-1) return 'Sun OS';
  
          else if(data.indexOf('Linux')!=-1 || data.indexOf('X11')!=-1) return 'Linux';
  
          else if(data.indexOf('Mac_PowerPC')!=-1 || data.indexOf('Macintosh')!=-1) return 'Mac OS';
  
          else if(data.indexOf('QNX')!=-1) return 'QNX';
  
          else if(data.indexOf('BeOS')!=-1) return 'BeOS';
  
          else if(data.indexOf('OS/2')!=-1) return 'OS/2';
          else return navigator.userAgent;
  
      }
      
     
      function LogDownloadMetrics(link,fileType,id,name)
      {
      $("#lnkDownloadFile").removeAttr('href');
          OpenPopUp(link);
          var BoardNm=  $('#divBoardName').attr('title');
          var DeviceType='Desktop';
          var operatingSystem=navigator.appVersion;
          operatingSystem=operatingSystem.substring(0,operatingSystem.indexOf("\)")+1);
          var browserVersion=FindBrowserVersion();
          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.AthenaLearningBoardDtls.LogDownloadMetrics}',                      
                    link,
                    fileType,
                    id,
                    name,
                    GetOSName(operatingSystem),
                    browserVersion,
                    BoardNm,
                  DeviceType,                   
                    DoNothing
                );
      }
      
      
      function LogDownloadImageMetrics(link,id,name,action)
      {
          debugger;
          var BoardNm=  $('#divBoardName').attr('title');
          var operatingSystem=navigator.appVersion;
          var DeviceType='Desktop';
          operatingSystem=operatingSystem.substring(0,operatingSystem.indexOf("\)")+1);
          var browserVersion=FindBrowserVersion();
          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.AthenaLearningBoardDtls.LogDownloadImageMetrics}',                      
                    link,
                    id,
                    name,
                    action,                      
                    GetOSName(operatingSystem),
                     browserVersion,
                      BoardNm,
                      DeviceType,     
                    DoNothing
                );
      }
      
      function DoNothing()
      {
          return true;
      }
  </script>
  </head>
  <!-- END HEAD -->
  <!-- BEGIN BODY -->
  <body>
  
  <!-- BEGIN HEADER -->
  <input type="hidden" id="hdnShareLearningBoardId"/>
  <input type="hidden" id="hdnShareLearningBoardName"/>
  <input type="hidden" id="hdnContentId"/>
  <input type="hidden" id="hdnContentName"/>
  <header>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-fluid"> 
        <!-- <a class="HpLogo"> 
          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/insight_web_logo.png')}" style="width:220px" alt="HP Logo"/></a>    --> 
          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/HP_Blue_Logo.png')}" alt="HP Logo" styleclass="HpLogo"/>
         <!-- </a>-->
          <div class="nav mtop20">
            <h1 class="h1fontS">insight</h1>
            <h3>Information - on your terms</h3>
          </div>
          <ul class="nav pull-right top-menu">
            <!-- BEGIN USER LOGIN DROPDOWN -->
            <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Welcome <span class="username colorBlue">{!LoggedinUserDtls.Name}</span> <span>
              <apex:image url="{!LoggedinUserDtls.FullPhotoUrl}" styleClass="userImage" alt="no_username"/>
              </span> 
              <!--<b class="caret"></b>--> 
              </a>
              <ul class="dropdown-menu extended logout">
                <li><a href="https://{!getSfInstance}/apex/AthenaUserProfile?id={!LoggedinUserDtls.id}">My Profile</a></li>
                <li><a href="https://{!getSfInstance}/apex/SLP_EditUserProfile?id={!LoggedinUserDtls.id}">Edit Profile</a></li>
                <li><a href="https://{!getSfInstance}/secur/logout.jsp">Log Out</a></li>
              </ul>
            </li>
            <!-- END USER LOGIN DROPDOWN -->
          </ul>
          <c:SLP_SearchCustomComponent InputString="View Board Page"/>
          <div class="alert alert-error topSearchEr" style="display:none;" id="err_msg"> </div>
        </div>
        
        <!-- <div class="alert alert-error span4 pull-right mr30" style="display:none" id="err_msg">
       </div>--> 
      </div>
    </div>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-fluid menunavBar"> <a class="icon-home topNavIcon" href="https://{!getSfInstance}/apex/slp_activity" title="Home"></a> <a class="icon-book topNavIcon"  href="https://{!getSfInstance}/apex/AthenaSocialLearning" title="Library"></a>
          <apex:OutputPanel rendered="{!IsLearningBoardCreator}"> <a class="icon-file-text-alt topNavIconC" href="https://{!getSfInstance}/apex/AthenacreatelearningBoard" title="Create Board"><span class="icon-plus NaviconPlus"></span></a> <a class="icon-group topNavIconCom" href="https://{!getSfInstance}/apex/SLP_createcommunity" title="Create Community"><span class="icon-plus NaviconPlus"></span></a> </apex:OutputPanel>
          <apex:outputPanel rendered="{!IsUserRoleMappingVisible}"> <a class="topNavRoll topNavIconCom" href="https://{!getSfInstance}/apex/SLP_UserRoleAndExpertiseMapping" title="User Role & Expert Mapping"><span class="NaviconPlus"></span></a> </apex:outputPanel>
          <!--<a class="icon-question-sign topNavIcon pull-right" href="https://ea2013.sharepoint.hp.com/teams/esplm/SitePages/Social Learning.aspx" target="_blank" title="Help"></a> --> 
        </div>
      </div>
    </div>
  </header>
  <!-- END HEADER --> 
  <!-- BEGIN CONTAINER -->
  <div id="container" class="row-fluid"> 
    <!-- BEGIN PAGE -->
    <div id="main-content">
      <div class="BDbg">
        <div class="BDheading">
          <div class="span8"> <span style="{!IF((NavCommunityId==null),"display:none","display:block")}">
            <h2>Community: <a href="https://{!getSfInstance}/apex/SLP_ViewCommunity?id={!NavCommunityId}">{!NavCommunityName}</a></h2>
            </span>
            <div id="divBoardName"  style="dispaly:none" title='{!LearningBoardDtls.LBName}'></div>
            <h2> <span class="colorDarkBlue"> Board : </span> {!LearningBoardDtls.LBName}</h2>
            
          </div>
          <div class="span4 BoardFormbtn" >
            <apex:form >
            
            
              <apex:outputPanel rendered="{!IsBoardEditor}"> <a id="btnEditor" class="btnAthena btn-primary" href="https://{!getSfInstance}/apex/AthenaEditLearningBoardDtls?id={!LearningBoardDtls.LbId}">Edit Board</a> </apex:outputPanel>
            </apex:form>
            <span class="mr10 pull-right p01 joinUnjoin" style="margin-top: 4px;">
            <apex:outputPanel rendered="{!!IsOwnerOrContributor}"> 
              <!--<apex:form >
                     <apex:commandButton id="btnfollow" value="Join" styleclass="btnAthena btn-primary shareBtn"  action="{!followBoard}" rendered="{!!IsFollowBoard}"/>
                     <!--<apex:commandButton id="btnUnfollow" value="Leave" styleclass="btnAthena btn-primary shareBtn"  action="{!unfollowBoard}" rendered="{!IsFollowBoard}"/>
              </apex:form>-->
              <apex:outputPanel rendered="{!IsMember}"> <a class="btnAthena btn-primary mr_5" id="" onClick="functionCommunityLeave(this)" target="_top">Leave</a> </apex:outputPanel>
              <apex:outputPanel rendered="{!!IsMember}">
                <apex:outputPanel rendered="{!!IsRequested}">
                  <apex:form >
                   <apex:inputText id="jhdnShareOperatingSystem" style="display:none"  value="{!ShareOperatingSystem}"/>
                  <apex:inputText id="jhdnShareBrowser" style="display:none"  value="{!ShareBrowser}"/>
                  <apex:inputText id="jhdnShareDeviceType" style="display:none"  value="{!ShareDeviceType}"/>
                  <!-- <input type="button" class="btnAthena btn-primary"   value="Join"  id="joinBrd"   /> -->
                    <apex:commandlink styleClass="btnAthena btn-primary"   value="Join" action="{!JoinBoard}" id="btnfollow" target="_top"  onclick="SetBrowserInfo(this);"></apex:commandlink>
                  </apex:form>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!IsRequested}"> <span class="btnAthena btn-primary mr_5" target="_top" style="cursor:default">Requested</span> </apex:outputPanel>
              </apex:outputPanel>
            </apex:outputPanel>
            </span> <span class="mr10 pull-right p05" style="padding-top:2px">
            <apex:outputPanel rendered="{!IsBoardPublic}"> 
              <!--<apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/Public.png')}" alt="Public" title="Public"/>--> 
              <span class="pull-right m5" target="_top" style="cursor:default; color:black;font-weight:bold; ">Public</span> </apex:outputPanel>
            <apex:outputPanel rendered="{!!IsBoardPublic}"> 
              <!--<apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/Private.png')}" alt="Private" title="Private"/>--> 
              <span class="pull-right m5" target="_top" style="cursor:default; color:black;font-weight:bold;">Private</span> </apex:outputPanel>
            </span> </div>
        </div>
        <div class="container-fluid">
          <div class="row-fluid mtop10">
            <div class="span8">
              <div class="PositionR">
                <apex:outputPanel rendered="{!!LearningBoardDtls.StaticImage}"> 
                  <!-- <img src="data:{!LearningBoardDtls.AttContentType};base64,{!LearningBoardDtls.Attbody}" /> -->
                  <apex:image url="{!URLFOR($Action.Attachment.Download, LearningBoardDtls.AttachmentId)}" styleClass="BoardDetailImage" />
                </apex:outputPanel>
                <apex:outputPanel rendered="{!LearningBoardDtls.StaticImage}"> <img src='{!LearningBoardDtls.DefaultImageName}' class="BoardDetailImage" /> 
                  <!-- <apex:image url="{!URLFOR($Resource.athena_images, 'images/antena_defaultImgLearning.png')}"/>--> 
                </apex:outputPanel>
                <div class="BoardTit">
                  <div class="span8">
                    <h4>{!LearningBoardDtls.LBSubTitle}</h4>
                  </div>
                  <div class="span4">
                    <apex:form styleClass="EfollowForm" >
                      <apex:outputPanel rendered="{!!isloggedUser}">
                        <apex:inputhidden id="hdnOperatingSystem" value="{!OperatingSystem}"/>
                        <apex:inputhidden id="hdnBrowser" value="{!Browser}"/>
                        <apex:inputhidden id="hdnUserName" value="{!UserName}"/>
                        <apex:inputhidden id="hdnDeviceType" value="{!DeviceType}"/>
                        <apex:commandButton id="CommandButton1" value="Follow" styleclass="btnAthena mtop6  followBtn"  action="{!followOwner}" rendered="{!!IsFollowOwner}"/>
                        <apex:commandButton id="CommandButton2" value="Unfollow" styleclass="btnAthena mtop6  followBtn"  action="{!unfollowOwner}" rendered="{!IsFollowOwner}"/>
                      </apex:outputPanel>
                    </apex:form>
                    <div class="hpit_athena_ca-item-personName colorWhite mtop5 pull-right"> <a class="hpit_athena_ca_itemLink" href="/apex/AthenaUserProfile?id={!LearningBoardOwnerDtls.id}"> {!IF(len(LearningBoardOwnerDtls.Name)>20,(LEFT(LearningBoardOwnerDtls.Name,20) + '...'),LearningBoardOwnerDtls.Name)}</a> </div>
                    <div class="hpit_athena_ca-item-personPhoto pull-right">
                      <apex:image url="{!LearningBoardOwnerDtls.FullPhotoUrl}" width="35" height="35" alt="no_username_small."/>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!--<div id="divPDFCanvas" style="display:none">
             <apex:canvasApp canvasId="cappPDF" applicationName="SLP_File_Download" width="100%" height="600px" scrolling="yes" />
        </div>-->
            <div class="span4">
              <div class="BDdetailHeight">
                <div>
                  <apex:outputText value="{!LearningBoardDtls.LBShortDescription}" escape="false"></apex:outputText>
                  <apex:outputPanel rendered="{!IsReadMore}"> <a class="" data-toggle="modal" href="#LBreadmore"> Read more </a> </apex:outputPanel>
                </div>
                <div class="tagBack" style="display:none;">
                  <ul class="tags">                   
                    <apex:repeat value="{!LBAssociatedTags}" var="asTag" >
                      <li class="tag"> {!asTag} </li>
                    </apex:repeat>
                  </ul>
                  <!-- <a class="pull-right m5">More tags</a>  --> 
                </div>
              </div>              
              <div id="LBreadmore" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                <div class="modal-header">
                  <h3>Learning Board Description</h3>
                </div>
                <div class="modal-body readmoreHpop" style="white-space: pre-line;"> 
                  
                  <!--{!SUBSTITUTE(SUBSTITUTE(LearningBoardDtls.LBDescription,"\n", "<br/>"),"\r","<br/>" )}--> 
                  
                  <!--{!LearningBoardDtls.LBDescription}-->
                  
                  <apex:outputText value="{!LearningBoardDtls.LBDescription}"></apex:outputText>
                </div>
                <div class="modal-footer">
                  <button class="btnAthena" data-dismiss="modal" aria-hidden="true">Cancel</button>
                </div>
              </div>
              <div id="TopicReadMore" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                <div class="modal-header">
                  <h3>Learning  Description</h3>
                </div>
                <div class="modal-body">
                  <div id="Topic"></div>
                </div>
                <div class="modal-footer">
                  <button class="btnAthena" data-dismiss="modal" aria-hidden="true">Cancel</button>
                </div>
              </div>
              <div>
                <apex:form id="formRating">
                  <div style="display:none">
                    <apex:inputText id="txtRatingUserInput" value="{!UserRating}" />
                  </div>
                </apex:form>
              </div>
              <div id="dvSetRating"></div>
              <div class='icon-external-link p05 a_pointer' title='Rating History' id="dvBoardOwnerOrContributor"  style="display:none" onclick='ShowHideRatingForOwnerBoard(this)'></div>
              <span class="ratingDes">{!BoardRatersCount} People Rated and Avg Rating {!UserBoardRating}</span>
              <div id="dvRatingModalStatic" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
                <apex:form id="form1">
                  <div class="modal-header">
                    <h3 id="BoardRating">Rating</h3>
                  </div>
                  <div class="modal-body" id="dvstaticOwnerOrContributor" style="display:none">
                    <div style="display:none">
                      <apex:inputText id="txtRatingModalUserInput" value="{!UserRating}" />
                    </div>
                    <div class="span4 ml0">
                      <label>User Rating</label>
                    </div>
                    <div class="span5"> <span>
                      <div id="dvModalRating"></div>
                      </span> </div>
                    <div class="span5 ml0">
                      <label>User Comment <span class="ratingDes">(Optional)</span></label>
                    </div>
                    <div>
                      <apex:inputTextarea id="txtRatingComment"  rows="3"  styleclass="span12" style="height: 110px; width: 97%;" value="{!userRatingComment}" title="User Rating Comment"  onkeyup="RestrictCharacters(this)"/>
                    </div>
                    <span id="counter"></span>
                    <div>
                                         
                        <apex:inputhidden id="hdnRateOperatingSystem" value="{!OperatingSystem}"/> 
                        <apex:inputhidden id="hdnRateBrowser" value="{!Browser}"/>
                        <apex:inputhidden id="hdnRateDeviceType" value="{!DeviceType}"/>
                        <apex:commandLink Styleclass="btnAthena btn-primary btnAthenaPopP pull-right"  action="{!SaveUserRating}" value="Rate It!" > </apex:commandLink>
                        <button class="btnAthena pull-right" data-dismiss="modal" aria-hidden="true" onClick="functionCancelRating()">Cancel</button>
                    
                    </div>
                  </div>
                  <div class="modal-footer">
                    <div id="dvRatingHistory" style="height:300px; overflow:auto;">
                      <apex:repeat value="{!RatingHistory}" var="rateHstry" >
                        <div class="clearB ptop10 clearfix ratingPopSep">
                          <div class="ratingPopHist ratingPopHistL">
                            <apex:image width="35" height="35" url="{!rateHstry.UserHistoryPhotoUrl}"  styleClass="hpit_athena_ca-item-personPhoto"/>
                          </div>
                          <div class="ratingTopPopL">
                            <div>{!rateHstry.UserHistoryName}</div>
                            <div>{!rateHstry.UserHistoryComment}</div>
                            <div> <span class="ratingDes">{!rateHstry.UserDate} </span><span id='{!rateHstry.UserHistoryId}' class="ratingTopPopR"></span></div>
                          </div>
                          <script>

                              $(document).ready(function () {
                                  debugger;                                 
                                  var UserScore = '{!rateHstry.UserHistoryRating}';
                                  $('#{!rateHstry.UserHistoryId}').raty({
                                      cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                                      cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                                      starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                                      starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                                      starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                                      readOnly: true,
                                      score: UserScore
                                  });
                              });
                                </script> 
                        </div>
                      </apex:repeat>
                    </div>
                    <div style="display:none" id="dvstaticRatingCancel">
                      <button aria-hidden="true" data-dismiss="modal" class="btnAthena pull-right" type="button">Cancel</button>
                    </div>
                  </div>
                </apex:form>
              </div>
              <!--<div class="BoardBtns"> <button class="btnOrange mr5" id="lrngBoardShare" onClick="OpenLearningBoardShare()">Share</button> </div>-->
              <div class="BoardBtns"> <button class="icon-share conBottomBtn conBottomBtn_B pull-right" id="lrngBoardShare" data-BoardId ="{!LearningBoardDtls.LbId}" data-BoardName ="{!LearningBoardDtls.LbName}" onClick="ShareLearningBoard(this)" title='Share'></button></div>
              <div id="DivShareModelPopup" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
                <apex:form id="formShareHeader">
                  <div class="modal-header">
                    <h3>Share</h3>
                  </div>
                  <div class="modal-body">
                    <div class="span5 ml0">
                      <label>User Email</label>
                    </div>
                    <div class="span5"> <span>
                      <apex:inputText id="txtEmailinputUser" value="{!HeaderShareEmail}" />
                      </span> </div>
                    <div class="alert alert-error span4 pull-right mr30" style="display:none" id="EmailValidate"> </div>
                  </div>
                  <div class="modal-footer">
                    <button class="btnAthena EbtnLess" data-dismiss="modal" aria-hidden="true"  onclick="funcClearShareEamil()" >Cancel</button>
                    <input type="button" class="btnAthena btn-primary btnAthenaPopP"  value="Send"  id="SendEmail"  onclick="ValidateShareEmail(this)"/>
                    <apex:commandLink Styleclass="btnAthena btn-primary btnAthenaPopP"  style="display:none" action="{!ShareLearningBoard}" value="Send" id="btnBoardEmail">
                      <apex:param name="q" value="{!LearningBoardDtls.LBid}" assignTo="{!ShareHeaderBoardId}"/>
                    </apex:commandLink>
                  </div>
                </apex:form>
              </div>
              
              <!--Suman Start code here-->
              <div id="VideoPopUp" class="modal hide fade modalUploadView" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                <div class="modal-header">
                  <!--<h3 id="videoHeading"></h3>-->
                    <h3 id="videoPopupHeading">Preview: If you are experiencing problems with this preview <a id="previewVideo" href="#" target="_blank">click here</a> to open in new tab</h3>
                </div>
                <div class="modal-body">
                  <iframe id="frameVideo" class='EBaddTopicLF' frameborder='0'   scrolling='no'></iframe>
                </div>
                <div class="modal-footer">
                  <button class="btnAthena EbtnLess" data-dismiss="modal" aria-hidden="true" onClick="functionCloseDialog()">Cancel</button>
                </div>
              </div>
              
              <!-- Commented By Komala <div id="modalPreviewRequired" class="modal hide fade modalUploadView" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
              <div class="modal-header">
                <h3>Preview</h3>
            </div>
              <div class="modal-body">
              <div id="cappPDF">
                 <apex:canvasApp canvasId="cappPDF" applicationName="SLP_File_Download" />
                 </div>
                 <div id="cappTXT">    
                 <apex:canvasApp canvasId="cappTXT" applicationName="SLP_File_Download" />
                 </div>
                 <div id="cappXLSX">
                 <apex:canvasApp canvasId="cappXLSX" applicationName="SLP_File_Download" />
                 </div>
                  <div id="cappHTML"> --> 
              <!--<apex:canvasApp canvasId="cappHTML" applicationName="SLP_File_Download" />--> 
              <!-- Commented By Komala     <iframe id="cappHTMLFrame"></iframe>
                 </div>
                  <div id="cappDOCX">
                 <apex:canvasApp canvasId="cappDOCX" applicationName="SLP_File_Download" />
                 </div>
                  <div id="cappPPT">
                 <apex:canvasApp canvasId="cappPPT" applicationName="SLP_File_Download" />
                 </div>
              </div>
              <div class="modal-footer">
                <button class="btnAthena" data-dismiss="modal" aria-hidden="true" onclick="functionCloseDialog()">Cancel</button>
              </div>
           </div> -->
              <div id="modalPreviewRequired" class="modal hide fade modalUploadView" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
                <div class="modal-header">
                  <h3 id="previewDocs" style="display:none">Preview: If you are experiencing problems with this preview <a id="previewLink" href="#" target="_blank">click here</a> to download </h3>
                  <h3 id="preivewHeading" style="display:none">Preview: If you are experiencing problems with this preview <a id="previewHeading" href="#" target="_blank">click here</a> to open in new tab</h3>
                </div>
                <div class="modal-body">
                  <iframe id="frameFileUrl" class='EBaddTopicLF' frameborder='0' style="display:none;" scrolling='yes'></iframe>
                  <div id="cappHTML" style="dispaly:none;"> 
                    <!--<apex:canvasApp canvasId="cappHTML" applicationName="SLP_File_Download" />-->
                    <iframe id="cappHTMLFrame" class='EBaddTopicLF' frameborder='0' scrolling='yes'></iframe>
                  </div>
                </div>
                <div class="modal-footer">
                  <button class="btnAthena" data-dismiss="modal" aria-hidden="true" onClick="functionCloseDialog()">Cancel</button>
                </div>
              </div>
              
              <div id="shareToUsers" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static" style="width:650px; left:46.5%; top:0"> 
                <div class="modal-header">
                  <h3>Select Users From Your Network</h3>
                </div>
                <div class="modal-body">
                  <div  id="divShareFeedItem"> </div>
                </div>
                <apex:form id="SlpActv">
                  <div class="modal-footer">                    
                    <button class="btnAthena" data-dismiss="modal" aria-hidden="true">Cancel</button>
                    <input type="button" class="btnAthena btn-primary btnAthenaPopP" data-FeedItmId="123"  value="Share"  id="CategorySave"  onclick="SaveUsers(this);" />
                    <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"  style="display:none"   action="{!SaveNetworkUsers}"  value="Share" id="SActivityShare"/>
                  </div>
                  <apex:inputText id="hdnShareOperatingSystem" style="display:none"  value="{!ShareOperatingSystem}"/>
                  <apex:inputText id="hdnShareBrowser" style="display:none"  value="{!ShareBrowser}"/>
                  <apex:inputText id="hdnShareDeviceType" style="display:none"  value="{!ShareDeviceType}"/>
                  <apex:inputText id="hdnSelectedUsrsId" style="display:none"  value="{!SelectedUsrs}"/>
                  <apex:inputText id="hdnShareComment" style="display:none"  value="{!hdnSharecmt}"/>
                  <apex:inputText id="hdnContentShareId" style="display:none"  value="{!ContentShareId}"/>
                  <apex:inputText id="hdnShareContentFlag" style="display:none"  value="{!hdnShareContentFlag}"/>
                  <apex:inputText id="hdnShareTopicName" style="display:none"  value="{!ShareTopicName}"/>
                </apex:form>
             </div>
            </div>
          </div>
        </div>
      </div>
      <div class="container-fluid">
        <div class="row-fluid mtop20">
          <div class="span8">
            <div class="TABclass">
              <ul class="nav nav-tabs" id="myTabs">
                <li id="liBoardContent" class="active"><a href="#BoardContent" data-toggle="tab">Content</a></li>
                <li id="liChat"><a href="#BoardChat" data-toggle="tab">Chat</a></li>
                <li id="liRelatedBoards"><a href="#RelatedBoards" data-toggle="tab">Related Boards</a></li>
                <li id="liRelatedCommunities"><a href="#RelatedCommunities" data-toggle="tab">Related Communities</a></li>                
              </ul>
              <div class="tab-content" id="dvTabContent">
                <div class="tab-pane active" id="BoardContent">
                  <div>
                    <div class="panel-group" id="accordion">
                      <div class="" id="DivLearnings"> </div>
                    </div>
                  </div>
                </div>
                <div class="tab-pane" id="BoardChat">
                  <div>
                    <chatter:feed entityid="{!LearningBoardDtls.LBid}" />
                  </div>
                </div>
                <!-- ----------------- -->
                <div class="tab-pane" id="RelatedCommunities">
                    <div class="tab-pane fade active in">
                        <div>
                            <apex:repeat value="{!RelatedCommunitys}" var="brdRslt">
                                <script>
                                    var listCommRelatedIds=new Array();
                                    var Id = '{!brdRslt.CMid}';
                                    var RatingNbr = '{!brdRslt.AvgRating}';
                                    listCommRelatedIds.push({ "ID": Id, "RatingNbr": RatingNbr });
                                </script>
                                <div class="hpit_athena_ca-item hpit_athena_ca-item-2">
                                    <div class="hpit_athena_ca-item-main">
                                        <div class="hpit_athena_ca-item-firstHalf">
                                        <div class="{!IF((brdRslt.IsActive==true),"hpit_athena_ca-item-topBar hpit_athena_ca-item-topBarG","hpit_athena_ca-item-topBarInactive")}">
                                            <div class="hpit_athena_ca-item-topBarDateComStar">
                                                <apex:OutputText value="{0,date,MMM dd}">
                                                <apex:param value="{!brdRslt.CMCrtDate}"/>
                                                </apex:outputtext>
                                                <div class="starred starredY"></div>
                                            </div>                                           
                                            <div class='ratingDispalyL' id='ratingBoard_{!brdRslt.CMid}' style="display:none;"></div>
                                            <div class="hpit_athena_ca-item-topBarChat">
                                                <div class="hpit_athena_ca-item-topBarChatImg">
                                                    <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/hpit_athena_chatIcon.png')}" width="14" height="14" alt="hpit_athena_chatIcon"/>
                                                </div>
                                                <div class="hpit_athena_ca-item-topBarChatValue"> {!brdRslt.CMNoOfComments} </div>
                                            </div>
                                        </div>
                                        <div class="ca-icon"> 
                                            <a class="hpit_athena_ca_itemLink ratingMouseOver" href="/apex/SLP_ViewCommunity?id={!brdRslt.CMid}">
                                                <apex:outputPanel rendered="{!!brdRslt.StaticImage}">
                                                    <apex:image url="{!URLFOR($Action.Attachment.Download, brdRslt.AttachmentId)}" />
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!brdRslt.StaticImage}"> <img src='{!brdRslt.DefaultImageName}'/> </apex:outputPanel>
                                            </a> 
                                        </div>
                                    </div>
                                    <a class="a_underNone">
                                        <div class="hpit_athena_ca-item-BottomBar"> 
                                        <a class="hpit_athena_ca_itemA" href="/apex/SLP_ViewCommunity?id={!brdRslt.CMid}">
                                            <h3>{!brdRslt.CMName}</h3>
                                        </a> </div>
                                    </a>
                                    <div class="hpit_athena_ca-item-SecondHalf">
                                        <div class="hpit_athena_ca-item-person cf">
                                            <div class="hpit_athena_ca-item-personPhoto">
                                                <apex:image value="{!brdRslt.boardOwnerPhotoUrl}" width="35" height="35" alt="no_username_small"/>
                                            </div>
                                            <a class="a_underNone">
                                                <div class="hpit_athena_ca-item-personName"> <a class="hpit_athena_ca_itemLink" href="/apex/AthenaUserProfile?id={!brdRslt.CMOwnerID}"> {!brdRslt.CMOwnerName} </a> </div>
                                            </a>
                                            <div class='hpit_athena_ca-item-personName hpit_athena_ca-item-personD hpit_athena_ca-item-personNameS'>{!IF((brdRslt.CMOwnerTitle==null),'',brdRslt.CMOwnerTitle)}</div>
                                        </div>
                                        <div class="hpit_athena_ca-item-PersonPost">
                                            <p>{!brdRslt.CMDescription}</p>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </apex:repeat>
                        </div>
                    </div>
                </div>
                <!-- ------------ -->
                <div class="tab-pane" id="RelatedBoards">                    
                    <div class="tab-pane fade active in">
                        <div>
                            <apex:repeat value="{!RelatedLearningBoards}" var="brdRslt">
                            <script>
                                var Id = '{!brdRslt.LBid}';
                                var RatingNbr = '{!brdRslt.AvgRating}';
                                listBoardRelatedIds.push({ "ID": Id, "RatingNbr": RatingNbr });
                            </script>
                            <div class="hpit_athena_ca-item hpit_athena_ca-item-2">
                                <div class="hpit_athena_ca-item-main">
                                    <div class="hpit_athena_ca-item-firstHalf">
                                        <div class="{!IF((brdRslt.IsActive==true),"hpit_athena_ca-item-topBar","hpit_athena_ca-item-topBarInactive")}">
                                            <div class="hpit_athena_ca-item-topBarDate">
                                                <apex:OutputText value="{0,date,MMM dd}">
                                                <apex:param value="{!brdRslt.LBCrtDate}"/>
                                                </apex:outputtext>
                                            </div>
                                            <div class='ratingDispalyL' id='ratingBoard_{!brdRslt.LBid}' style="display:none;"></div>
                                            <div class="hpit_athena_ca-item-topBarChat">
                                                <div class="hpit_athena_ca-item-topBarChatImg">
                                                    <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/hpit_athena_chatIcon.png')}" width="14" height="14" alt="hpit_athena_chatIcon"/>
                                                </div>
                                                <div class="hpit_athena_ca-item-topBarChatValue"> {!brdRslt.LBNoOfComments} </div>
                                            </div>
                                        </div>
                                        <div class="ca-icon"> 
                                            <a class="hpit_athena_ca_itemLink ratingMouseOver" href="/apex/AthenaLearningBoardDtls?id={!brdRslt.LBid}" id= "anchorBoard_{!brdRslt.LBid}" data-boardLBid = 'ratingBoard_{!brdRslt.LBid}'>
                                                <apex:outputPanel rendered="{!!brdRslt.StaticImage}">
                                                    <apex:image url="{!URLFOR($Action.Attachment.Download, brdRslt.AttachmentId)}" />
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!brdRslt.StaticImage}"> <img src='{!brdRslt.DefaultImageName}'/> </apex:outputPanel>
                                            </a> 
                                        </div>
                                    </div>
                                    <a class="a_underNone">
                                        <div class="hpit_athena_ca-item-BottomBar"> 
                                        <a class="hpit_athena_ca_itemA" href="/apex/AthenaLearningBoardDtls?id={!brdRslt.LBid}">
                                            <h3>{!brdRslt.LBName}</h3>
                                        </a> </div>
                                    </a>
                                    <div class="hpit_athena_ca-item-SecondHalf">
                                        <div class="hpit_athena_ca-item-person cf">
                                            <div class="hpit_athena_ca-item-personPhoto">
                                                <apex:image value="{!brdRslt.boardOwnerPhotoUrl}" width="35" height="35" alt="no_username_small"/>
                                            </div>
                                            <a class="a_underNone">
                                                <div class="hpit_athena_ca-item-personName"> <a class="hpit_athena_ca_itemLink" href="/apex/AthenaUserProfile?id={!brdRslt.LBOwnerID}"> {!brdRslt.LBOwnerName} </a> </div>
                                            </a>
                                            <div class='hpit_athena_ca-item-personName hpit_athena_ca-item-personD hpit_athena_ca-item-personNameS'>{!IF((brdRslt.LBOwnerTitle==null),'',brdRslt.LBOwnerTitle)}</div>
                                        </div>
                                        <div class="hpit_athena_ca-item-PersonPost">
                                            <p>{!brdRslt.LBDescription}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </apex:repeat>
                        </div>                      
                    </div>                  
                </div> 
              </div>
            </div>
          </div>
          <div class="span4"> 
            <!--<div class="row-fluid ">
            <div class="hpit_athena_rightDiv span12"> 
                Members
                <hr />
                <apex:repeat value="{!Followers}" var="follow" > 
                    <a href="https://{!getSfInstance}/apex/AthenaUserProfile?id={!follow.id}" title="{!follow.Name}" class="hpit_athena_ca-item-personPhoto"> <apex:image width="35" height="35" url="{!follow.FullPhotoUrl}"  /></a>
                </apex:repeat>
            </div>
          </div>
          <div class="row-fluid ">
            <div class="hpit_athena_rightDiv span12"> Contributors 
               <hr />
             
                  <apex:repeat value="{!Contributors}" var="cont" > 
                 <a href="https://{!getSfInstance}/apex/AthenaUserProfile?id={!cont.id}" title="{!cont.Name}" class="hpit_athena_ca-item-personPhoto"> <apex:image width="35" height="35" url="{!cont.FullPhotoUrl}"  /></a>
                </apex:repeat>
              </div>
          </div>--> 
            <!-- START By Suman Contributors & Members -->
            
            <div class="row-fluid">
              <div class="hpit_athena_rightDiv span12">
                <div>
                  <p><span ><a class="aActive" id="aContriMembers" onClick="CommunityContMember()"> Members<span id="ConMemCnt"></span></a></span></p>
                </div>
                <div class="row-fluid colorGrey"> <span class="span3 text-center"><a class="aActive" id="aAToZ" onClick="AToZSort(this)"> A-Z </a><span class="BorderR">&nbsp;</span></span> <span class="span3 text-center"><a class="colorGrey" id="aRoleName" onClick="RoleSort(this)"> Role </a><span class="BorderR">&nbsp;</span></span> <span class="span3 text-center"><a class="colorGrey" id="aRegion" onClick="RegionSort()"> Region </a><span class="BorderR">&nbsp;</span></span> <span class="span3 text-center"><a class="colorGrey" id="aBusinessGrp" onClick="BusinessGroupSort()"> Business Group </a></span> </div>
                <div style="overflow: auto; width: auto; max-height:442px;">
                  <ul class="item-list scroller padding" data-always-visible="1">
                    <div id="divContMember"> </div>
                  </ul>
                </div>
              </div>
            </div>
            
            <!-- END By Suman Contributors & Members --> 
            
            <!-- START By Komala Related Communities -->
            <!--<div class="row-fluid " id="dvRelatedCommunities">
              <div class="hpit_athena_rightDiv span12"> Related Communities
                <hr />
                <apex:repeat value="{!GetRelatedCommunities}" var="clb" > <a class="hpit_athena_ca_itemLink" href="/apex/SLP_ViewCommunity?id={!clb.CommunityId}">
                  <p class="hpit_athena_rightHeading" style="margin:0"> <span style="font-size:15px" >{!clb.CommunityName}</span> </p>
                  </a>
                  <p style="margin:0"><span style="color:#7A7878"> {!clb.OwnerName}</span></p>
                  <a class="hpit_athena_ca_itemLink" href="/apex/SLP_ViewCommunity?id={!clb.CommunityId}">
                  <p>
                    <apex:outputPanel rendered="{!!clb.StaticImage}"> 
                      <apex:image url="{!URLFOR($Action.Attachment.Download, clb.AttachmentId)}"  width="220" height="162" />
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!clb.StaticImage}"> <img src='{!clb.DefaultImageName}' width="220" height="162"/> 
                    </apex:outputPanel>
                  </p>
                  </a>
                  <hr />
                </apex:repeat>
              </div>
            </div>-->
            <!-- END By Komala Related Communities -->
            <!--<div class="row-fluid " id="dvRelatedBoards">
              <div class="hpit_athena_rightDiv span12"> Related boards
                <hr />
                <apex:repeat value="{!RelatedLearningBoards}" var="rlb" > <a class="hpit_athena_ca_itemLink" href="/apex/AthenaLearningBoardDtls?id={!rlb.Lbid}">
                  <p class="hpit_athena_rightHeading" style="margin:0"> <span style="font-size:15px" >{!rlb.LBName}</span> </p>
                  </a>
                  <p style="margin:0"><span style="color:#7A7878"> {!rlb.LBOwnerName}</span></p>
                  <a class="hpit_athena_ca_itemLink" href="/apex/AthenaLearningBoardDtls?id={!rlb.Lbid}">
                  <p>
                    <apex:outputPanel rendered="{!!rlb.StaticImage}">
                      <apex:image url="{!URLFOR($Action.Attachment.Download, rlb.AttachmentId)}"  width="220" height="162" />
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!rlb.StaticImage}"> <img src='{!rlb.DefaultImageName}' width="220" height="162"/> </apex:outputPanel>
                  </p>
                  </a>
                  <hr />
                </apex:repeat>-->
                
                <!--    <div>
                       <apex:repeat value="{!RelatedLearningBoards}" var="brdRslt">
                           <div class="hpit_athena_ca-item hpit_athena_ca-item-2">
                              <div class="hpit_athena_ca-item-main">
                                <div class="hpit_athena_ca-item-firstHalf">
                                  <div class="hpit_athena_ca-item-topBar">
                                    <div class="hpit_athena_ca-item-topBarDate">
                                         <apex:OutputText value="{0,date,MMM dd}">
                                            <apex:param value="{!brdRslt.LBCrtDate}"/>
                                         </apex:outputtext>
                                    </div>
                                    <div class="hpit_athena_ca-item-topBarChat">
                                      <div class="hpit_athena_ca-item-topBarChatImg">
                                          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/hpit_athena_chatIcon.png')}" width="14" height="14" alt="hpit_athena_chatIcon"/>
                                      </div>
                                      <div class="hpit_athena_ca-item-topBarChatValue">
                                      </div>
                                    </div>
                                  </div>
                                  <div class="ca-icon"> 
                                      <a class="hpit_athena_ca_itemLink ratingMouseOver" href="/apex/AthenaLearningBoardDtls?id={!brdRslt.LBid}" id= "anchorBoard_{!brdRslt.LBid}" data-boardLBid = 'ratingBoard_{!brdRslt.LBid}'>
                                        <apex:outputPanel rendered="{!!brdRslt.StaticImage}"> 
                                            <apex:image url="{!URLFOR($Action.Attachment.Download, brdRslt.AttachmentId)}" />
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!brdRslt.StaticImage}">
                                           <img src='{!brdRslt.DefaultImageName}'/>                            
                                        </apex:outputPanel>
                                    </a>
                                  </div>
                                </div>
                                <a class="a_underNone">
                                    <div class="hpit_athena_ca-item-BottomBar">
                                         <a class="hpit_athena_ca_itemA" href="/apex/AthenaLearningBoardDtls?id={!brdRslt.LBid}">
                                            <h3>{!brdRslt.LBName}</h3>
                                         </a>
                                    </div>
                                </a>
                                <div class="hpit_athena_ca-item-SecondHalf">
                                  <div class="hpit_athena_ca-item-person cf">
                                    <div class="hpit_athena_ca-item-personPhoto">
                                        <apex:image value="{!brdRslt.OwnerPhotoUrl}" width="35" height="35" alt="no_username_small"/>
                                    </div>
                                    <a class="a_underNone">
                                        <div class="hpit_athena_ca-item-personName">
                                             <a class="hpit_athena_ca_itemLink" href="/apex/AthenaUserProfile?id={!brdRslt.LBOwnerID}">
                                                {!brdRslt.LBOwnerName}
                                             </a>
                                        </div>
                                    </a>
                                   <div class='hpit_athena_ca-item-personName hpit_athena_ca-item-personD hpit_athena_ca-item-personNameS'>{!IF((brdRslt.LBOwnerTitle==null),'',brdRslt.LBOwnerTitle)}</div>
                                  </div>
                                  <div class="hpit_athena_ca-item-PersonPost">
                                    <p>{!brdRslt.LBDescription}</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                       </apex:repeat>             
                </div>--> 
                
                <!--  <p> Sales goals to the next level</p> --> 
              <!--</div>
            </div>-->
          </div>
        </div>
      </div>
    </div>
    <!-- END PAGE --> 
  </div>
  <div class="slide-out-div"  style="display:none"> <a class="handle" href="http://link-for-non-js-users">Content</a>
    <apex:form id="ChatterFeedBack">
      <p>What do you like?</p>
      <apex:inputText Styleclass="inputW" value="{!ChatterLike}" id="theTextInput"/>
      <p>What need to be improved?</p>
      <apex:inputTextarea id="newDesc" Styleclass="inputW" value="{!ChatterImprovement}"/>
      <p/>
      <apex:commandButton value="Send" Styleclass="btnAthena shareBtn btn-primary" action="{!AddToChatterComment}"/>
    </apex:form>
  </div>
  <div id="DivTopicShareModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
    <apex:form id="formTopic">
      <div class="modal-header">
        <h3>Share</h3>
      </div>
      <div class="modal-body">
        <div style="display:none">
          <apex:inputText id="txtTopicId" value="{!ShareTopicId}" />
        </div>
        <div class="span5 ml0">
          <label>User Email</label>
        </div>
        <div class="span5"> <span>
          <apex:inputText id="txtInputEmailTopic" value="{!HeaderShareEmail}" />
          </span> </div>
        <div class="alert alert-error span4 pull-right mr30" style="display:none" id="EmailValidateTopic"> </div>
      </div>
      <div class="modal-footer">
        <button class="btnAthena EbtnLess" data-dismiss="modal" aria-hidden="true">Cancel</button>
        <input type="button" class="btnAthena btn-primary btnAthenaPopP"  value="Send"  id="Button1"  onclick="ValidateTopicShareEmail(this)"/>
        <apex:commandLink Styleclass="btnAthena btn-primary btnAthenaPopP" style="display:none" action="{!ShareTopicLearningBoard}" value="Send" id="SendTopicSharedEmail"> </apex:commandLink>
      </div>
    </apex:form>
  </div>
  <div>
    <apex:form id="form2">
      <div style="display:none">
        <apex:inputText id="txtUserTopicRating" value="{!UserTopicRating}" />
      </div>
    </apex:form>
  </div>
  <div id="dvModalTopic" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true">
    <apex:form id="form3">
      <div class="modal-header">
        <h3 id="TopicRating">Rating</h3>
      </div>
      <div class="modal-body" >
        <div id="OwnerOrContributorTopicRating"> </div>
        <div id="NotOwnerOrContributorTopicRating" style="display:none">
          <div style="display:none">
            <apex:inputText id="txtModalTopicUserRating" value="{!UserTopicRating}" />
            <apex:inputText id="txtLearningBoardTopicID" value="{!LearningBoardTopicID}" />
            <apex:inputText id="txtTopicDivRating" />
            <apex:inputText id="txtTopicScore" />
            <apex:inputText id="txtCategoryName" />
          </div>
          <div class="ratingpopL ml0">
            <label>User Rating</label>
          </div>
          <div class="ratingpopR"> <span>
            <div id="divModalTopicUserRating"></div>
            </span> </div>
          <div class="span5 ml0">
            <label>User Comment <span class="ratingDes">(Optional)</span></label>
          </div>
          <div>
            <apex:inputTextarea id="txtUserTopicRatingComment"  rows="3"  styleclass="span12" style="height: 110px; width: 97%;" value="{!userTopicRatingComment}" title="User Rating Comment"  onkeyup="RestrictTopicCharacters(this)"/>
          </div>
          <span id="topicCounter"></span>
          <div>
          <apex:inputhidden id="hdnContRateOperatingSystem" value="{!OperatingSystem}"/> 
                        <apex:inputhidden id="hdnContRateBrowser" value="{!Browser}"/>
                        <apex:inputhidden id="hdnContRateDeviceType" value="{!DeviceType}"/>
            <apex:commandLink Styleclass="btnAthena btn-primary btnAthenaPopP pull-right"  onclick="AssignCategoryName()"  action="{!SaveTopicUserRating}" value="Rate It!" > </apex:commandLink>
            <button class="btnAthena pull-right" data-dismiss="modal" aria-hidden="true" onClick="functionTopicCancelRating()">Cancel</button>
          </div>
        </div>
        <div id="dvTopicFooter" style="height:300px; overflow:auto;"> </div>
      </div>
      <div class="modal-footer" style="display:none" id="dvCancelRatingHistory">
        <button aria-hidden="true" data-dismiss="modal" class="btnAthena pull-right" type="button">Cancel</button>
      </div>
    </apex:form>
  </div>
  <div id="dvModalLeave" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static">
    <apex:form >
      <div id="Div3" style="Display:none"> 
        <!--<apex:inputText id="txtContributorId" value="{!ContributorId}" />--> 
      </div>
      <div class="modal-header">
        <h3>Are you sure you want to leave the board?</h3>
      </div>
      <div class="modal-body">
        <p> </p>
      </div>
      <div class="modal-footer">
        <input type="button" class="btnAthena" data-dismiss="modal" aria-hidden="true" value="No" />
        <apex:commandButton styleclass="btnAthena btn-primary"  action="{!LeaveCommunity}" value="Yes" id="CommandButton3"/>
      </div>
    </apex:form>
  </div>
  <apex:form >
    <apex:inputHidden value="{!hdnTopicCatName}" id="hdnTopicCatName"/>
    <apex:inputText id="InputText1" style="display:none" />
    <apex:inputText id="hdnContentCtgyName" style="display:none" />
    <apex:inputText id="hdnTopicName" style="display:none" />
  </apex:form>
  <input type="hidden" id="hdnSetPosition" />
  <!-- END CONTAINER --> 
  <form>
    <a id="lnkDownloadFile" target="_blank"></a>
  </form>
  <!-- BEGIN FOOTER -->
  <div id="footer"> © Hewlett-Packard Development Company, L.P.     |     HP Restricted </div>
  <!-- END FOOTER --> 
  
  <!-- BEGIN JAVASCRIPTS --> 
  <!-- Load javascripts at bottom, this will reduce page load time
         -->
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/js/bootstrap.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/jquery-ui/jQuery_UI_1_10_3.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/typeahead.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/jquery.feedback_me.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/raty/ratyViewJs.js')}" />
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/data-tables/jquery.dataTables.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/data-tables/DT_bootstrap.js')}"/>

  <!-- ie8 fixes --> 
  <!--[if lt IE 9]>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/excanvas.js')}"/>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/respond.js')}"/>
   <![endif]--> 
  
  <!--common script for all pages-->
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/common-scripts.js')}"/>
  <apex:includeScript value="{!$Resource.athena_canvas_controller}"/>
  
  <!-- END JAVASCRIPTS --> 
  <script  type="text/javascript">     

      function getCookie(cname) {

          var name = cname + "=";
          var ca = document.cookie.split(';');
          for (var i = 0; i < ca.length; i++) {
              var c = ca[i].trim();
              if (c.indexOf(name) == 0) return c.substring(name.length, c.length);
          }
          return "";
      }

      function TopicDialog(data) {
          var Description = $(data).attr('data-topicDesc');

      }


      $('.popovers').popover();

      $('#accordion1').collapse({
          toggle: false
      }).on('show', function (e) {
          $(e.target).parent().find(".icon-chevron-down").removeClass("icon-chevron-down").addClass("icon-chevron-up");
      }).on('hide', function (e) {
          $(e.target).parent().find(".icon-chevron-up").removeClass("icon-chevron-up").addClass("icon-chevron-down");
      });

      // Utility; parse out parameter by name from URL query string
      $.urlParam = function (name) {

          var resultData = '';
          var results = new RegExp('[\\?&]' + name + '=([^&#]*)')
              .exec(window.location.href);
          if (results == null) {
              resultData = '';
          }
          else {
              resultData = results[1] || 0;
          }
          return resultData;
      }



      function LoadLearningBoard() {
          var LearningBoardId = $.urlParam('id');

          Visualforce.remoting.Manager.invokeAction(
              '{!$RemoteAction.AthenaLearningBoardDtls.getLrngWithCat}',
              LearningBoardId,
              DisplayLearnings
          );
      }

      function ShowHideCategory(data) {

          if ($(data).parent().find(".icon-plus-sign-alt").hasClass("icon-plus-sign-alt")) {
              $(data).parent().find(".icon-plus-sign-alt").removeClass("icon-plus-sign-alt").addClass("icon-check-minus");
          }
          else {
              $(data).parent().find(".icon-check-minus").removeClass("icon-check-minus").addClass("icon-plus-sign-alt");
          }



      }

      function ShowHideChatter(data) {

          if ($(data).parent().find(".icon-plus-sign-alt").hasClass("icon-plus-sign-alt")) {
              $('#DivChatterLB').show();
              $(data).parent().find(".icon-plus-sign-alt").removeClass("icon-plus-sign-alt").addClass("icon-check-minus");
          }
          else {
              $('#DivChatterLB').hide();
              $(data).parent().find(".icon-check-minus").removeClass("icon-check-minus").addClass("icon-plus-sign-alt");
          }



      }

      function getQueryString(sParam) {

          var sPageURL = window.location.search.substring(1);
          var sURLVariables = sPageURL.split('&');

          for (var i = 0; i < sURLVariables.length; i++) {
              var sParameterName = sURLVariables[i].split('=');
              if (sParameterName[0].toUpperCase() == sParam.toUpperCase()) {
                  return sParameterName[1];
              }
          }
      }

      function in_array(array, id) {

          for (var i = 0; i < array.length; i++) {
              if (array[i].Lid == id) {
                  return true;
              }
          }
          return false;
      }


      function DisplayLearningBoardTopics(result, event) {
          debugger
          var lstTopicIds = new Array();
          $('#DivLearnings').empty();
          
          for (var icount = 0; icount < result.length; icount++) {
              if (result[icount].lstlrngs.length > 0) {
                  //var spacehref = result[icount].CategoryName.replace(/ /g, "_");
                  var spacehref = result[icount].CategoryName.replace(/([~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,.\/? ])+/g, '-').replace(/^(-)+|(-)+$/g, '');
                  var hrefurl = '#' + spacehref;
                  var generateLearning = ("<div class='panel panel-default'> <div class='panel-heading'>" +
                  "<h4 class='panel-title'> <a   onclick='ShowHideCategory(this)'  class='accordion-toggle a_underNone' data-toggle='collapse' data-parent='#accordion' href='" + hrefurl + "'> <span class='icon-plus-sign-alt'></span> " + result[icount].CategoryName + " </a>  </h4>" +
                        "</div>");
                  $('#DivLearnings').append(generateLearning);
                  var generateL = ("<div id='" + spacehref + "' class='panel-collapse collapse'>");

                  var GenerateUrl = '';
                  var generateLText = '';
                  var IntegrateContent = '';
                  var generateVideo = '';
                  var LinkRelatedPDF = '';
                  var clientFacing = '';
                  var practiceApproved = '';
                  var NextDviToComplete = '';
                  IntegrateContent = generateL;


                  for (var icnt = 0; icnt < result[icount].lstlrngs.length; icnt++) {

                      // Push Id, AverageCount, ReadOnly Variables to and Array for Rating's on Individual Topic
                      var LShortDescription = result[icount].lstlrngs[icnt].LShortDescription;

                      LShortDescription = LShortDescription.replace(/[^\011\012\015\040-\177]/g, function (x) {
                          return '&#' + x.charCodeAt(0) + ';'
                      })
                      LShortDescription = $($.parseHTML(LShortDescription)).text();

                      var tID = 'ratingFeatured_' + result[icount].lstlrngs[icnt].Lid;
                      var AverageRating = result[icount].lstlrngs[icnt].AvgRating;
                      var RatersCount = result[icount].lstlrngs[icnt].RatersCount;
                      var IsReadOnly = result[icount].lstlrngs[icnt].BtnshowHideEdit;
                      var CtgryNm = result[icount].CategoryName;
                      lstTopicIds.push({ "Id": tID, "Rating": AverageRating, "RateCount": RatersCount, "IsReadOnly": IsReadOnly, "CategoryName": CtgryNm });

                      //var spacehrefLearning = result[icount].lstlrngs[icnt].LName.replace(/ /g, "_");
                      var spacehrefLearning = $.trim(result[icount].lstlrngs[icnt].LName).replace(/([~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,.\/? ])+/g, '-').replace(/^(-)+|(-)+$/g, '');
                      var hrefurlLearning = '#' + spacehrefLearning;
                      var DefaultTags="No Tags Associated";
                      var sliptTagsData='';
                      if (result[icount].lstlrngs[icnt].LType == 'Text') {
                          var description = result[icount].lstlrngs[icnt].LShortDescription;
                          var display = '';

                          if (description.length > 150) {
                              display = "display:block";
                          }
                          else {
                              // Commented By Komala hrefurlLearning = "#";
                              display = "display:none";
                          }
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                         
                          var MainDivStart= ("<div class='panel-body topicEdit clearB clearfix PositionR'>"+
                            "<div class='span12 borderB'>");
                          MainDivStart+= ("<div class='span4'>"+
                                          "<div class='m10'><a class='' data-toggle='modal' href= " + hrefurlLearning + "> <img src=" + result[icount].lstlrngs[icnt].DefaultImageName + " class='EBaddTopicL'  /></a>  </div>"+
                                          "</div>");
                          MainDivStart+=  "<div class='span8'>";

                          MainDivStart+= ("<div class='leftDisplayCon span8 pull-left'>"+
                                          "<div class='span12'>"+
                                          "<div class='m10 pr20'>");
                          var IsReadMore='';
                          if (result[icount].lstlrngs[icnt].StrDescLength > 0) {
                              IsReadMore=  ("<a class='' data-toggle='modal' href=" + hrefurlLearning + "> Read more </a>" );
                          
                          }
                          if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES')
                          {
                              var DisplayFormat = ("<a class='' data-toggle='modal' href='#' data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowTXT(" + "\"" + hrefurlLearning + "\"" + ")'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                              "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+"  </p>" );
                              MainDivStart += DisplayFormat;
                          }
                          else
                          {
                              var DisplayFormat = ("<a class='' data-toggle='modal' href='" + hrefurlLearning + "'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                              "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+"  </p>" );
                              MainDivStart += DisplayFormat;
                          }
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
        
                          MainDivStart += ("<div class='iconRightTop span4 pull-left'>"+
                                          "<div class='clearfix clearB'>");
                                              
                          
                          if (result[icount].lstlrngs[icnt].ClientFacing) {
                      
                              var clientFacing = ("<div class=' iconDisplayBG'> <span class='icon-clientfacing_new iconPublish' title='Client-Facing' ></span> </div>");
                              MainDivStart += clientFacing;
                          }
                     
                          if (result[icount].lstlrngs[icnt].PracticeApproved) {
                              var HPCrt = ( "<div class=' iconDisplayBG'> <span class='icon-certified iconPublish ml_1' title='Practice-Approved' ></span> </div>");
                              MainDivStart += HPCrt;
                          }
                          MainDivStart+= ("</div>"+
                                       "</div>");
        
                          //if (result[icount].lstlrngs[icnt].StrDescLength > 0) {
                          //  var IsReadMore=  ("<a class='' data-toggle='modal' href=" + hrefurlLearning + "> Read more </a>" );
                          //MainDivStart+=IsReadMore;
                          //}
                          // MainDivStart+= ("<a class='' data-toggle='modal' style=" + display + " href='" + hrefurlLearning + "'> Read more </a>");
                          MainDivStart+= "<div class='leftDisplayCon span8 pull-left ml0 p10'>";
                          var AfterTags = ("<div  data-categoryName='" + CtgryNm + "'  data-score=" + AverageRating + " id='ratingFeatured_" + result[icount].lstlrngs[icnt].Lid + "'></div>");

                          if (IsReadOnly) {
                              var ReadonlyHistory = "<div class='icon-external-link p05 a_pointer' title='Rating History' data-topicId=" + result[icount].lstlrngs[icnt].Lid + " onclick='ShowHideRatingForOwner(this)'></div>";
                              AfterTags += ReadonlyHistory;
                          }

                          var afterRating = ("<span class='ratingDes'>" + RatersCount + " People Rated and Avg Rating " + AverageRating + "</span>" +
                                             "<div class='tagBack' style='display:none;'><ul class='tags'><li class='tag'>" + result[icount].lstlrngs[icnt].Tags + " </li></ul></div>" +
                                             "<div><img src=" + result[icount].lstlrngs[icnt].OwnerPhoto + "  height='35' width='35' class='Br20' /> <a id='aTopicName' class='hpit_athena_ca_itemLink' href='/apex/AthenaUserProfile?id=" + result[icount].lstlrngs[icnt].TopicOwnerId + "'> " + result[icount].lstlrngs[icnt].LOwnerName + " </a> </div>" +
                                             "<div id='" + spacehrefLearning + "' class='modal hide fade PositionF' tabindex='-1' role='dialog' aria-labelledby='myModalLabel1' aria-hidden='true' data-backdrop='static'>" +
                                             "<div class='modal-header'>" +
                                             "<h3>Content Description</h3>" +
                                             "</div>" +
                                             "<div class='modal-body readmoreHpop'>" +
                                             "<p style='white-space: pre-line;'> " +
                                             "" + result[icount].lstlrngs[icnt].LDescription + "" +
                                             "</p>" +
                                             "</div>" +
                                             "<div class='modal-footer'>" +
                                             "<button class='btnAthena' data-dismiss='modal' aria-hidden='true'>Cancel</button>" +
                                             "</div>" +
                                             "</div>" );
                                             

                          AfterTags += afterRating;
                          MainDivStart+=AfterTags;

                          MainDivStart+=" </div>";
                          
                          MainDivStart+="<div class='iconRight span4 pull-left'>";
                          MainDivStart+="<div class='clearB clearfix mtop20 p5'>";
        
                      
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                          MainDivStart+= ("<a href='#'>" +
                                                 "<button id = TopicId_"+ ShareTopicID +" class='icon-share conBottomBtn conBottomBtn_B pull-right' data-catName=" + escape(CtgryNm) + " data-TopicId='" + ShareTopicID + "' onclick='ShareTopicLearningBoard(this)' title='Share' ></button></a>" );
                                                     
                                                                              
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          
                          
                          MainDivStart+= "</div>";
                          MainDivStart+= "</div>";
                          MainDivStart+="</div> ";
                          IntegrateContent +=MainDivStart;

                      }
                      else if ((result[icount].lstlrngs[icnt].LType == 'Link or Document') || (result[icount].lstlrngs[icnt].LType == 'Upload Document')) {

                          var LinkTopicID = result[icount].lstlrngs[icnt].Lid;
                          var description = result[icount].lstlrngs[icnt].LShortDescription;
                          var display = '';

                          if (description.length > 150) {
                              display = "display:block";
                          }
                          else {
                              display = "display:none";
                          }

                          var IsURLExist = result[icount].lstlrngs[icnt].LURL;

                          var linkNameURL = '';
                          if(result[icount].lstlrngs[icnt].LURL!=null)
                          {                         
                              if (result[icount].lstlrngs[icnt].LURL.indexOf("prime31.sharepoint.hp.com/teams/social%20learning/FileRepoWS/Uploads") != -1)
                              {
                                  linkNameURL = "https://it-services-gw-itg.external.hp.com/gw/esit/sfdc/idol.dev/action=View&NoACI=true&OutputType=RAW&IgnoreCache=true&reference=" +escape(result[icount].lstlrngs[icnt].LURL);  
                              }
                              else if (result[icount].lstlrngs[icnt].LURL.indexOf("intranet.hp.com/enterpriseservices/ww") != -1)
                              {
                                  linkNameURL = "https://it-services-gw-itg.external.hp.com/gw/esit/sfdc/idol.dev/action=View&NoACI=true&OutputType=RAW&IgnoreCache=true&reference=" +escape(result[icount].lstlrngs[icnt].LURL);  
                              }
                              else
                              {
                                  linkNameURL = result[icount].lstlrngs[icnt].LURL;  
                              }
                          }
                          
                          var MainDivStart= ("<div class='panel-body topicEdit clearB clearfix PositionR'>"+
                        "<div class='span12 borderB'>");
                          MainDivStart+= ("<div class='span4'>"+
                                          "<div class='m10'><a id = linkDoc_" + LinkTopicID + " target='_blank' data-ID = " + LinkTopicID + " Data-Url = " + linkNameURL + " onclick = 'NavigateUrl(this)'> <img src=" + result[icount].lstlrngs[icnt].DefaultImageName + " class='EBaddTopicL' /></a></div>"+
                                          "</div>");
                          MainDivStart+=  "<div class='span8'>";

                          MainDivStart+= ("<div class='leftDisplayCon span8 pull-left'>"+
                                          "<div class='span12'>"+
                                          "<div class='m10 pr20'>");
                          var IsReadMore= '';
                          if (result[icount].lstlrngs[icnt].StrDescLength > 0) {
                              IsReadMore=  ("<a class='' data-toggle='modal' href=" + hrefurlLearning + "> Read more </a>" );
                          
                          }
                          if (IsURLExist != undefined) {

                              if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                                  MainDivStart+= ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " Data-Url = " + linkNameURL + " Data-DocType = " + result[icount].lstlrngs[icnt].DocType + " onclick = 'OpenAssociatedModalPopUp(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                               "<p style='white-space: pre-line;'> " + LShortDescription + " "+ IsReadMore +" </p>");

                              }
                              else {
                                  MainDivStart+= ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " target='_blank' Data-Url = " + linkNameURL + " onclick = 'NavigateUrl(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                                "<p style='white-space: pre-line;'> " + LShortDescription + " "+ IsReadMore +" </p>" );

                              }

                          }
                          else {
                              MainDivStart+= ("<h4>" + result[icount].lstlrngs[icnt].LName + " </h4>" +
                                                "<p style='white-space: pre-line;'> " + LShortDescription + " "+ IsReadMore +" </p>" );
                                            

                          }
    
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
        
                          MainDivStart += ("<div class='iconRightTop span4 pull-left'>"+
                                          "<div class='clearfix clearB'>");                        
                          if (result[icount].lstlrngs[icnt].ClientFacing) {
                      
                              var clientFacing = ("<div class=' iconDisplayBG'> <span class='icon-clientfacing_new iconPublish' title='Client-Facing' ></span> </div>");
                              MainDivStart += clientFacing;
                          }
                      
                          if (result[icount].lstlrngs[icnt].PracticeApproved) {
                              var HPCrt = ( "<div class=' iconDisplayBG'> <span class='icon-certified iconPublish ml_1' title='Practice-Approved' ></span> </div>");
                              MainDivStart += HPCrt;
                          }
                          MainDivStart+= ("</div>"+
                                       "</div>");
        
                         
                          // MainDivStart+= ("<a class='' data-toggle='modal' style=" + display + " href='" + hrefurlLearning + "'> Read more </a>");
        
        
                          MainDivStart+= "<div class='leftDisplayCon span8 pull-left ml0 p10'>";
                          var rating=("<div  id='ratingFeatured_" + result[icount].lstlrngs[icnt].Lid + "'></div>");
                          MainDivStart+=rating;

                    
                          MainDivStart+=("<div  data-categoryName='" + CtgryNm + "'  data-score=" + AverageRating + " id='ratingFeatured_" + result[icount].lstlrngs[icnt].Lid + "'></div>");

                          if (IsReadOnly) {
                              MainDivStart+= "<div class='icon-external-link p05 a_pointer' title='Rating History' data-topicId=" + result[icount].lstlrngs[icnt].Lid + " onclick='ShowHideRatingForOwner(this)'></div>";
                          }

                          MainDivStart+= ("<span class='ratingDes'>" + RatersCount + " People Rated and Avg Rating " + AverageRating + "</span>" +
                                            "<div class='tagBack' style='display:none;'><ul class='tags'><li class='tag'>" + result[icount].lstlrngs[icnt].Tags + " </li></ul></div>" +
                                            "<div><img src=" + result[icount].lstlrngs[icnt].OwnerPhoto + "  height='35' width='35' class='Br20' /> <a id='aTopicName' class='hpit_athena_ca_itemLink' href='/apex/AthenaUserProfile?id=" + result[icount].lstlrngs[icnt].TopicOwnerId + "'> " + result[icount].lstlrngs[icnt].LOwnerName + " </a> </div>" +
                                            "<div id='" + spacehrefLearning + "' class='modal hide fade PositionF' tabindex='-1' role='dialog' aria-labelledby='myModalLabel1' aria-hidden='true' data-backdrop='static'>" +
                                            "<div class='modal-header'>" +
                                            "<h3>Content Description</h3>" +
                                            "</div>" +
                                            "<div class='modal-body readmoreHpop'>" +
                                            "<p style='white-space: pre-line;'> " +
                                            "" + result[icount].lstlrngs[icnt].LDescription + "" +
                                            "</p>" +
                                            "</div>" +
                                            "<div class='modal-footer'>" +
                                            "<button class='btnAthena' data-dismiss='modal' aria-hidden='true'>Cancel</button>" +
                                            "</div>" +
                                            "</div>");
  
                          MainDivStart+=" </div>";
        
                          MainDivStart+="<div class='iconRight span4 pull-left'>";
                          MainDivStart+="<div class='clearB clearfix mtop20 p5'>";
        
                          <!-- PDF -->
                          if(result[icount].lstlrngs[icnt].LURL!=null)
                          {                         
                              if (result[icount].lstlrngs[icnt].LURL.indexOf("prime31.sharepoint.hp.com/teams/social%20learning/FileRepoWS/Uploads") != -1)
                              {
                                  result[icount].lstlrngs[icnt].LURL="https://it-services-gw-itg.external.hp.com/gw/esit/sfdc/idol.dev/action=View&NoACI=true&OutputType=RAW&IgnoreCache=true&reference=" +result[icount].lstlrngs[icnt].LURL;  
                              }
                              else if (result[icount].lstlrngs[icnt].LURL.indexOf("intranet.hp.com/enterpriseservices/ww") != -1)
                              {
                                  result[icount].lstlrngs[icnt].LURL = "https://it-services-gw-itg.external.hp.com/gw/esit/sfdc/idol.dev/action=View&NoACI=true&OutputType=RAW&IgnoreCache=true&reference=" + result[icount].lstlrngs[icnt].LURL;  
                              }
                          }
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                          MainDivStart+= ("<a href='#'>" +
                                                 "<button id = TopicId_"+ ShareTopicID +" class='icon-share conBottomBtn conBottomBtn_B pull-right' data-catName=" + escape(CtgryNm) + " data-TopicId='" + ShareTopicID + "' onclick='ShareTopicLearningBoard(this)' title='Share'></button></a>" );
                          if (result[icount].lstlrngs[icnt].DocType == 'PDF') {
                                    
                                                
                              var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                              if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {

                                  MainDivStart+= ("<span class='detailDoc'> <a id= anchor_" + ShareTopicID + " data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowPDF(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <span class='icon-dload-pdf conBottomBtn pull-right' title='Download File' /> </a> </span>");
                            
                              }
                              else {

                                  MainDivStart+= ("<span class='detailDoc'><a  href='javascript:void(0);' id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + result[icount].lstlrngs[icnt].LURL + " onclick='functionTargetUrl(this)'> <span class='icon-dload-pdf conBottomBtn pull-right'  title='Download File' /> </a></span>");
                              }

                          }
                          else if (result[icount].lstlrngs[icnt].DocType == 'PPT') {

                              var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                              MainDivStart+= ("<span class='detailDoc'><a href='javascript:void(0);' id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + result[icount].lstlrngs[icnt].LURL + " onclick='functionTargetUrl(this)'> <span class='icon-dload-powerpoint conBottomBtn pull-right' title='Download File'  /> </a> </span> ");
                          }
                          else if (result[icount].lstlrngs[icnt].DocType == 'DOC') {
                              var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                              MainDivStart+= ("<span class='detailDoc'><a href='javascript:void(0);' id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + result[icount].lstlrngs[icnt].LURL + " onclick='functionTargetUrl(this)'> <span class='icon-dload-word conBottomBtn pull-right' title='Download File' /> </a> </span> ");
                          }
                          else if (result[icount].lstlrngs[icnt].DocType == 'XLS') {
                              var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                              MainDivStart+= ("<span class='detailDoc'><a href='javascript:void(0);' id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + result[icount].lstlrngs[icnt].LURL + " onclick='functionTargetUrl(this)'> <span class='icon-dload-excel conBottomBtn pull-right' title='Download File' /> </a> </span> ");
                          }
                          else if (result[icount].lstlrngs[icnt].DocType == 'TXT') {
                              var ShareTopicID = result[icount].lstlrngs[icnt].Lid;

                              MainDivStart+= ("<span class='detailDoc'> ");
                          
                              if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                              
                                  MainDivStart+= ("<a href='javascript:void(0);' id= anchor_" + ShareTopicID + " data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowTXT(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <span class='icon-dload-text conBottomBtn pull-right' title='Download File' /> </a> </span>");
                             
                              }
                              else {
                                  MainDivStart+= ("<a href='javascript:void(0);'   id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + result[icount].lstlrngs[icnt].LURL + " onclick='functionTargetUrl(this)'> <span class='icon-dload-text conBottomBtn pull-right' title='Download File' /> </a> </span>");
                              
                              }

                          }
                          else if (result[icount].lstlrngs[icnt].DocType == 'OTHER') {
                              var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                              MainDivStart+= ("<span class='detailDoc'> ");
                              if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                                  MainDivStart+= ("<a href='javascript:void(0);' id= anchor_" + ShareTopicID + "  data-ID = " + ShareTopicID + " data-URL= " + escape(result[icount].lstlrngs[icnt].LURL) + " onclick='ShowHTML(" + "\"" + result[icount].lstlrngs[icnt].LURL + "\"" + ")'> <span class='icon-link conBottomBtn conBottomBtn_B pull-right'  title='Visit Page'  /> </a></span> ");
                              }
                              else {
                                  MainDivStart+= ("<a  href='javascript:void(0);'  id= anchor_" + ShareTopicID + " target='_blank' data-ID = " + ShareTopicID + " data-URL= " + result[icount].lstlrngs[icnt].LURL + " onclick='functionTargetUrl(this)'> <span class='icon-link conBottomBtn conBottomBtn_B pull-right'  title='Visit Page' /> </a></span> ");
                              }
                          }
                 
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+=" </div>";
                          IntegrateContent +=MainDivStart;
                      }


                      else if (result[icount].lstlrngs[icnt].LType == 'Video') {

                          var description = result[icount].lstlrngs[icnt].LShortDescription;
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                          var display = '';
                          if (description.length > 150) {
                              display = "display:block";
                          }
                          else {
                              display = "display:none";
                          }
                          
                          var someText = "<a id = linkDoc_"+ result[icount].lstlrngs[icnt].Lid +" style='display:none'></a><a id= video_" + result[icount].lstlrngs[icnt].Lid + ">" + result[icount].lstlrngs[icnt].LName + "</a>";
                          var MainDivStart= ("<div class='panel-body topicEdit clearB clearfix PositionR'>"+
                        "<div class='span12 borderB'>");
                          MainDivStart+= ("<div class='span4'>"+
                                          "<div class='m10'><iframe src=" + result[icount].lstlrngs[icnt].LURL + " class='hpit_athena_detailPostIfram EBaddTopicLF' frameborder='0'   scrolling='no' ></iframe> </div>"+
                                          "</div>");
                          MainDivStart+=  "<div class='span8'>";

                          MainDivStart+= ("<div class='leftDisplayCon span8 pull-left'>"+
                                          "<div class='span12'>"+
                                          "<div class='m10 pr20'>");
                          var IsReadMore= '';
                          if (result[icount].lstlrngs[icnt].StrDescLength > 0) {
                              IsReadMore=  ("<a class='' data-toggle='modal' href=" + hrefurlLearning + "> Read more </a>" );
                          
                          }
                           var IsURLExist = result[icount].lstlrngs[icnt].LURL;
                          if (IsURLExist != undefined) {

                              if (result[icount].lstlrngs[icnt].PreviewRequired == 'YES') {
                                  MainDivStart+= ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " Data-Url = " + escape(result[icount].lstlrngs[icnt].LURL) + " Data-DocType = " + result[icount].lstlrngs[icnt].DocType + " onclick = 'OpenAssociatedModalPopUp(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                               "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                              }
                              else {
                                  MainDivStart+= ("<a id = linkDoc_" + LinkTopicID + " data-ID = " + LinkTopicID + " target='_blank' Data-Url = " + result[icount].lstlrngs[icnt].LURL + " onclick = 'NavigateUrl(this)'><h4>" + result[icount].lstlrngs[icnt].LName + " </h4></a>" +
                                                "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                              }

                          }
                          else {
                              MainDivStart+= ("<h4>" + result[icount].lstlrngs[icnt].LName + " </h4>" +
                                                "<p style='white-space: pre-line;'> " + LShortDescription + " "+IsReadMore+" </p>");

                          }
    
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
        
                          MainDivStart += ("<div class='iconRightTop span4 pull-left'>"+
                                          "<div class='clearfix clearB'>");                        
                          if (result[icount].lstlrngs[icnt].ClientFacing) {
                      
                              var clientFacing = ("<div class=' iconDisplayBG'> <span class='icon-clientfacing_new iconPublish' title='Client-Facing' ></span> </div>");
                              MainDivStart += clientFacing;
                          }
                      
                          if (result[icount].lstlrngs[icnt].PracticeApproved) {
                              var HPCrt = ( "<div class=' iconDisplayBG'> <span class='icon-certified iconPublish ml_1' title='Practice-Approved' ></span> </div>");
                              MainDivStart += HPCrt;
                          }
                          MainDivStart+= ("</div>"+
                                       "</div>");
        
                         
       
                          // MainDivStart+=("<a class='' data-toggle='modal' style=" + display + " href='" + hrefurlLearning + "'> Read more </a>");
        
        
                          MainDivStart+= "<div class='leftDisplayCon span8 pull-left ml0 p10'>";
                          var rating=("<div  id='ratingFeatured_" + result[icount].lstlrngs[icnt].Lid + "'></div>");
                          MainDivStart+=rating;

                    
                          MainDivStart+=("<div  data-categoryName='" + CtgryNm + "'  data-score=" + AverageRating + " id='ratingFeatured_" + result[icount].lstlrngs[icnt].Lid + "'></div>");

                          if (IsReadOnly) {
                              MainDivStart+= "<div class='icon-external-link p05 a_pointer' title='Rating History' data-topicId=" + result[icount].lstlrngs[icnt].Lid + " onclick='ShowHideRatingForOwner(this)'></div>";
                          }

                          MainDivStart+= ("<span class='ratingDes'>" + RatersCount + " People Rated and Avg Rating " + AverageRating + "</span>" +
                                            "<div class='tagBack' style='display:none;'><ul class='tags'><li class='tag'>" + result[icount].lstlrngs[icnt].Tags + " </li></ul></div>" +
                                            "<div><img src=" + result[icount].lstlrngs[icnt].OwnerPhoto + "  height='35' width='35' class='Br20' /> <a id='aTopicName' class='hpit_athena_ca_itemLink' href='/apex/AthenaUserProfile?id=" + result[icount].lstlrngs[icnt].TopicOwnerId + "'> " + result[icount].lstlrngs[icnt].LOwnerName + " </a> </div>" +
                                            "<div id='" + spacehrefLearning + "' class='modal hide fade PositionF' tabindex='-1' role='dialog' aria-labelledby='myModalLabel1' aria-hidden='true' data-backdrop='static'>" +
                                            "<div class='modal-header'>" +
                                            "<h3>Content Description</h3>" +
                                            "</div>" +
                                            "<div class='modal-body readmoreHpop'>" +
                                            "<p style='white-space: pre-line;'> " +
                                            "" + result[icount].lstlrngs[icnt].LDescription + "" +
                                            "</p>" +
                                            "</div>" +
                                            "<div class='modal-footer'>" +
                                            "<button class='btnAthena' data-dismiss='modal' aria-hidden='true'>Cancel</button>" +
                                            "</div>" +
                                            "</div>");
  
                          MainDivStart+=" </div>";
        
                          MainDivStart+="<div class='iconRight span4 pull-left'>";
                          MainDivStart+="<div class='clearB clearfix mtop20 p5'>";
        
                          if(result[icount].lstlrngs[icnt].LURL!=null)
                          {                         
                              if (result[icount].lstlrngs[icnt].LURL.indexOf("prime31.sharepoint.hp.com/teams/social%20learning/FileRepoWS/Uploads") != -1)
                              {
                                  result[icount].lstlrngs[icnt].LURL="https://it-services-gw-itg.external.hp.com/gw/esit/sfdc/idol.dev/action=View&NoACI=true&OutputType=RAW&IgnoreCache=true&reference=" +result[icount].lstlrngs[icnt].LURL;  
                              }
                          }
                          var ShareTopicID = result[icount].lstlrngs[icnt].Lid;
                          MainDivStart+= ("<a href='#'>" +
                                                 "<button id = TopicId_"+ ShareTopicID +" class='icon-share conBottomBtn conBottomBtn_B pull-right' data-catName=" + escape(CtgryNm) + " data-TopicId='" + ShareTopicID + "' onclick='ShareTopicLearningBoard(this)' title='Share' ></button></a>" );
                                                     
                          var videoIcon = ("<a src='" + result[icount].lstlrngs[icnt].LURL + "'  href='" + result[icount].lstlrngs[icnt].LURL + "' target='_blank' ><span  class='icon-video-camera conBottomBtn conBottomBtn_B pull-right'  title='Play Video' /></a>");
                          MainDivStart+=videoIcon;
                                                     
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+="</div>";
                          MainDivStart+=" </div>";
                          IntegrateContent +=MainDivStart;

                      }
                  }

                  var LastDiv = "</div>";
                  IntegrateContent += LastDiv;
                  $('#DivLearnings').append(IntegrateContent);
              }


          }
          // Looping through the Topic Ids and assigning the assocaited average count to the same.
          for (var iL = 0; iL < lstTopicIds.length; iL++) {

              $('#' + lstTopicIds[iL].Id).raty({
                  cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                  cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                  starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                  starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                  starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                  readOnly: lstTopicIds[iL].IsReadOnly,
                  score: lstTopicIds[iL].Rating,
                  click: function (score, evt) {
                      //alert('ID: ' + $(this).attr('id') + "\nscore: " + score + "\nevent: " + evt);

                      var BoardOrTopicId = $(this).attr('id');
                      var BoardOrTopicScore = score;

                      var TopicValue = BoardOrTopicId.split('_')
                      var BoardTopicId = TopicValue[1];

                      $('[id$=txtUserTopicRating]').val(BoardOrTopicScore);
                      $('[id$=txtModalTopicUserRating]').val(BoardOrTopicScore);

                      $('#divModalTopicUserRating').raty({
                          cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                          cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                          starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                          starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                          starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                          score: $('[id$=txtModalTopicUserRating]').val(),
                          click: function (score, evt) {
                              var BoardOrTopicId = $(this).attr('id');
                              var BoardOrTopicScore = score;

                              var TopicValue = BoardOrTopicId.split('_')
                              var BoardTopicId = TopicValue[1];

                              $('[id$=txtUserTopicRating]').val(BoardOrTopicScore);
                              $('[id$=txtModalTopicUserRating]').val(BoardOrTopicScore);
                          }
                      });

                      $('[id$=txtLearningBoardTopicID]').val(TopicValue[1]);

                      $('[id$=txtTopicDivRating]').val(BoardOrTopicId);
                      $('[id$=txtTopicScore]').val($(this).attr('data-score'));
                      $('[id$=txtCategoryName]').val($(this).attr('data-categoryName'));

                      Visualforce.remoting.Manager.invokeAction(
                          '{!$RemoteAction.AthenaLearningBoardDtls.GetTopicRatingHistory}',
                          BoardTopicId,
                          GenerateTopicHistory
                      );
                      $('#NotOwnerOrContributorTopicRating').show();
                      $('#OwnerOrContributorTopicRating').hide();
                      $('#dvModalTopic').modal('show');
                  }
              });
          }
      }


      function DisplayLearnings(result, event) {

          var TopicId = getQueryString('topicId');

          //var TopicId = $.urlParam('topicId');
          DisplayLearningBoardTopics(result, event);

          if (TopicId != undefined)
          {
              var ContentName = '';
              for (var iLoop = 0; iLoop < result.length; iLoop++)
              {
                  if (in_array(result[iLoop].lstlrngs, TopicId))
                  {

                      var spacehref = result[iLoop].CategoryName.replace(/([~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,.\/? ])+/g, '-').replace(/^(-)+|(-)+$/g, '');
                      var hrefurl = '#' + spacehref;
                      $(hrefurl).addClass('in');
                      var ahref = $('a[href="#' + spacehref + '"]')
                      ShowHideCategory(ahref);
                      ContentName = 'linkDoc_' + TopicId;
                      break;
                  }
              }
              ScrollToRelativePosition(ContentName);
          }
          else {
              debugger
              var TopicCategoryName = '';
              if (getCookie('TopicCatName') != '')
              {
                  TopicCategoryName = getCookie('TopicCatName');
              }

              var CategoryHidden = $('[id$=txtCategoryName]').val();

              if (CategoryHidden != "")
              {
                  var spacehref = CategoryHidden.replace(/([~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,.\/? ])+/g, '-').replace(/^(-)+|(-)+$/g, '');
                  var hrefurl = '#' + spacehref;
                  $(hrefurl).addClass('in');
                  var ahref = $('a[href="#' + spacehref + '"]')
                  ShowHideCategory(ahref);
                  ScrollToRelativePosition($('[id$=hdnShareTopicName]').val());
              }
              else if (TopicCategoryName != '' && $('[id$=hdnShareContentFlag]').val() == 'Y')
              {
                  var spacehref = TopicCategoryName.replace(/([~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,.\/? ])+/g, '-').replace(/^(-)+|(-)+$/g, '');
                  var hrefurl = '#' + spacehref;
                  $(hrefurl).addClass('in');
                  var ahref = $('a[href="#' + spacehref + '"]')
                  ShowHideCategory(ahref);
                  ScrollToRelativePosition($('[id$=hdnShareTopicName]').val());
              }
          }
      }


      $(document).ready(function () {

          //alert('{!loggedInUserId}');
          LoadLearningBoard();
          $('input.typeahead-devs').typeahead({
              name: 'accounts',
              local: ['']
          });


          // Rating should be set to readonly if the logged in user & owner is the same for a board
          var isReadOnly = false;

          if ('{!IsOwnerOrContributor}' == 'true') {
              isReadOnly = true;
              $('#dvBoardOwnerOrContributor').show();
          }
          else if ('{!IsOwnerOrContributor}' == 'false') {
              isReadOnly = false;
          }


          if (isReadOnly == true) {
              $('[id$=dvstaticOwnerOrContributor]').hide();
              $('[id$=BoardRating]').text('Rating History');
          }
          else if (isReadOnly == false) {
              $('[id$=dvstaticOwnerOrContributor]').show();
          }

          $('[id$=txtRatingComment]').val('');
          $('[id$=counter]').hide();
          $('[id$=txtUserTopicRatingComment]').val('');

          //Header board details Rating initialization

          $('#dvSetRating').raty({
              cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
              cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
              starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
              starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
              starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
              readOnly: isReadOnly,
              score: '{!UserBoardRating}',
              click: function (score, evt) {

                  $('[id$=txtRatingUserInput]').val(score);
                  $('[id$=txtRatingModalUserInput]').val(score);
                  $('#dvModalRating').raty({
                      cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                      cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                      starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                      starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                      starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                      score: score,
                      click: function (score, evt) {

                          $('[id$=txtRatingUserInput]').val(score);
                          $('[id$=txtRatingModalUserInput]').val(score);
                      }
                  });

                  $('#dvRatingModalStatic').modal('show');
              }
          });
          debugger

          var isBoardPulic = false;
          var isOwnerOrContributor = false;
          var isMember = false;

          if ('{!IsBoardPublic}' == 'true') {
              isBoardPulic = true;
          }
          else if ('{!IsBoardPublic}' == 'false') {
              isBoardPulic = false;
          }

          if ('{!IsOwnerOrContributor}' == 'true') {
              isOwnerOrContributor = true;
          }
          else if ('{!IsOwnerOrContributor}' == 'false') {
              isOwnerOrContributor = false;
          }

          if ('{!IsMember}' == 'true') {
              isMember = true;
          }
          else if ('{!IsMember}' == 'false') {
              isMember = false;
          }

          if (isBoardPulic == true || isOwnerOrContributor == true || isMember == true) {debugger
              $('#accordion').show();
              $('#dvChatter').show();
              
              //$('#liRelatedCommunities').show();
              //$('#liRelatedBoards').show();

              //$('#liChat').show();
              //$('#liBoardContent').show();

              $('#liRelatedCommunities, #liRelatedBoards, #liChat, #liBoardContent, #myTabs, #dvTabContent').show();

              //$('#dvRelatedCommunities').show();
              //$('#dvRelatedBoards').show();
          }
          else if (isBoardPulic == false || isOwnerOrContributor == false || isMember == false) {debugger
              $('#accordion').hide();
              $('#dvChatter').hide();
              
              $('#liRelatedCommunities, #liRelatedBoards, #liChat, #liBoardContent, #myTabs, #dvTabContent').hide();
              
              //$('#dvRelatedCommunities').hide();
              //$('#dvRelatedBoards').hide();
          }
          var relatedBoardCount = {!relatedBoardCount};
          var relatedCommunityCount = {!relatedCommunity};                    
          if(relatedBoardCount > 0){
              $('#liRelatedBoards').show();            
          }
          else{
              $('#liRelatedBoards').hide();            
          }
          if(relatedCommunityCount>0){
              $('#liRelatedCommunities').show();
          }
          else{
              $('#liRelatedCommunities').hide();
          }
      });

      $('.collapse').on('shown.bs.collapse', function () {
          $(this).parent().find(".icon-plus-sign-alt").removeClass("icon-plus-sign-alt").addClass("icon-check-minus");
      }).on('hidden.bs.collapse', function () {
          $(this).parent().find(".icon-check-minus").removeClass("icon-check-minus").addClass("icon-plus-sign-alt");
      });

    </script> 
  <script type="text/javascript">


      function OpenLearningBoardShare() {
          $('#DivShareModelPopup').modal('show');
      }

      function OpenTopicSharePopup(data) {

          var TopicID = $(data).attr('data-TopicId');
          $('[id$=txtTopicId]').val(TopicID);

          $('#DivTopicShareModal').modal('show');
      }

      $(document).ready(function () {
          CommunityContMember();
          $('[id$=hdnDeviceType]').val("Desktop");
          $('.slide-out-div').tabSlideOut({
              tabHandle: '.handle',                              //class of the element that will be your tab
              pathToTabImage: '{!FeedButtonPath} ',          //path to the image for the tab (optionaly can be set using css)
              imageHeight: '122px',                               //height of tab image
              imageWidth: '40px',                               //width of tab image    
              tabLocation: 'right',                               //side of screen where tab lives, top, right, bottom, or left
              speed: 300,                                        //speed of animation
              action: 'click',                                   //options: 'click' or 'hover', action to trigger animation
              topPos: '200px',                                   //position from the top

              fixedPosition: false                               //options: true makes it stick(fixed position) on scroll
          });

          $('.publishericon').hide();
          debugger;

          //Resetting the Feedback form input elements
          document.getElementById('{!$Component.ChatterFeedBack.theTextInput}').value = "";
          document.getElementById('{!$Component.ChatterFeedBack.newDesc}').value = "";

          if (document.getElementById('publisherAttachRypplePost') != null) {
              document.getElementById('publisherAttachRypplePost').style.display = 'none';
              document.getElementById('publisherDropdown').style.display = 'none';
          }
          document.getElementById('{!$Component.formShareHeader.txtEmailinputUser}').value = "";
          document.getElementById('{!$Component.formTopic.txtInputEmailTopic}').value = "";

          $('#publishersharebutton').val('Post');




      });

      function funcClearShareEamil() {
          document.getElementById('{!$Component.formShareHeader.txtEmailinputUser}').value = "";
          document.getElementById('{!$Component.formTopic.txtInputEmailTopic}').value = "";
      }


      // Issue: if the URL contains espace sequences like "Sachin's The New Style of IT_a6wZ00000008qVdIAI.pptx" then the URL will throw error. 
      // Fix: Escaping the special characters will resolve the issue.
      function functionTargetUrl(data) {
          debugger
          var TopicID = "anchor_" + $(data).attr('data-ID');
          var id=$(data).attr('data-ID');
          var name=$(data).attr('data-Name');
          var type=$(data).attr('data-Type')+' '+ 'Document Click';
          
          var TopicURL = $(data).attr('data-URL');

          var PPTTopicURL = unescape(TopicURL);
          //OpenPopUp(PPTTopicURL);
          //$('[id$=' + TopicID + ']').attr('href', PPTTopicURL);
          
          LogDownloadMetrics(PPTTopicURL,type,id,name);
          //return false;
      }


      function functionCancelRating() {

          var UserScore = 0;
          if (('{!UserBoardRating}' == '')) {
              UserScore = 0; n
          }
          else if ('{!UserBoardRating}' != '') {
              UserScore = '{!UserBoardRating}';
          }

          $('#dvModalRating').raty({
              cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
              cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
              starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
              starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
              starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
              score: UserScore,
              click: function (score, evt) {
                  $('[id$=txtRatingUserInput]').val(score);
                  $('[id$=txtRatingModalUserInput]').val(score);
              }
          });

          $('#dvSetRating').raty({
              cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
              cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
              starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
              starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
              starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
              score: '{!UserBoardRating}',
              click: function (score, evt) {

                  $('[id$=txtRatingUserInput]').val(score);
                  $('[id$=txtRatingModalUserInput]').val(score);
                  $('#dvModalRating').raty({
                      cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                      cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                      starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                      starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                      starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                      score: $('[id$=txtRatingModalUserInput]').val(),
                      click: function (score, evt) {
                          $('[id$=txtRatingUserInput]').val(score);
                          $('[id$=txtRatingModalUserInput]').val(score);
                      }
                  });

                  $('#dvRatingModalStatic').modal('show');
              }
          });
      }

      function GenerateTopicHistory(result, event) {

          var ListTopicId = new Array();

          $('#dvTopicFooter').empty();

          for (var i = 0; i < result.length; i++) {

              var LearningTopicID = result[i].UserHistoryId;
              var LearningTopicScore = result[i].UserHistoryRating;
              var comment = '';

              if (result[i].UserHistoryComment == '' || result[i].UserHistoryComment == null) {
                  comment = '';
              }
              else {
                  comment = result[i].UserHistoryComment;
              }

              ListTopicId.push({ "Id": LearningTopicID, "Rating": LearningTopicScore });

              var generateLText = ("<div class='clearB ptop10 clearfix' style='border-bottom:1px solid #eee'>" +
                                  "<div class='ratingPopHist ratingPopHistL'>" +
                                  "<img src=" + result[i].UserHistoryPhotoUrl + " width='35' height='35' class='hpit_athena_ca-item-personPhoto'/></div>" +
                                  "<div class='ratingTopPopL'>" +
                                  "<div>" + result[i].UserHistoryName + "</div>" +
                                  "<div>" + comment + "</div>" +
                                  "<div> <span class='ratingDes'>" + result[i].UserDate + "</span><span id='Span1' class='ratingTopPopR'></span><span id=" + result[i].UserHistoryId + " class='ratingTopPopR'></span></div></div></div>");

              $('#dvTopicFooter').append(generateLText);
          }

          for (var iL = 0; iL < ListTopicId.length; iL++) {

              $('#' + ListTopicId[iL].Id).raty({
                  cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                  cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                  starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                  starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                  starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                  readOnly: true,
                  score: ListTopicId[iL].Rating
              });
          }
      }

      function GenerateBoardHistory(result, event) {

          var ListTopicId = new Array();

          $('#dvTopicFooter').empty();

          for (var i = 0; i < result.length; i++) {

              var LearningTopicID = result[i].UserHistoryId;
              var LearningTopicScore = result[i].UserHistoryRating;
              var comment = '';

              if (result[i].UserHistoryComment == '' || result[i].UserHistoryComment == null) {
                  comment = '';
              }
              else {
                  comment = result[i].UserHistoryComment;
              }

              ListTopicId.push({ "Id": LearningTopicID, "Rating": LearningTopicScore });

              var generateLText = ("<div class='clearB ptop10 clearfix' style='border-bottom:1px solid #eee'>" +
                                  "<div class='ratingPopHist ratingPopHistL'>" +
                                  "<img src=" + result[i].UserHistoryPhotoUrl + " width='35' height='35' class='hpit_athena_ca-item-personPhoto'/></div>" +
                                  "<div class='ratingTopPopL'>" +
                                  "<div>" + result[i].UserHistoryName + "</div>" +
                                  "<div>" + comment + "</div>" +
                                  "<div> <span class='ratingDes'>" + result[i].UserDate + "</span><span id='Span1' class='ratingTopPopR'></span><span id=" + result[i].UserHistoryId + " class='ratingTopPopR'></span></div></div></div>");

              $('#dvTopicFooter').append(generateLText);
          }

          for (var iL = 0; iL < ListTopicId.length; iL++) {

              $('#' + ListTopicId[iL].Id).raty({
                  cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                  cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                  starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                  starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                  starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                  readOnly: true,
                  score: ListTopicId[iL].Rating
              });
          }
      }


      function functionTopicCancelRating() {

          var id = $('[id$=txtTopicDivRating]').val();
          var score = $('[id$=txtTopicScore]').val();
          $('[id$=txtUserTopicRatingComment]').val('');

          $('#divModalTopicUserRating').raty({
              cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
              cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
              starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
              starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
              starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
              score: score,
              click: function (score, evt) {

                  var BoardOrTopicId = $(this).attr('id');
                  var BoardOrTopicScore = score;

                  var TopicValue = BoardOrTopicId.split('_')
                  var BoardTopicId = TopicValue[1];

                  $('[id$=txtUserTopicRating]').val(BoardOrTopicScore);
                  $('[id$=txtModalTopicUserRating]').val(BoardOrTopicScore);
              }
          });


          $('#' + id).raty({
              cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
              cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
              starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
              starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
              starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
              score: score,
              click: function (score, evt) {

                  var BoardOrTopicId = $(this).attr('id');
                  var BoardOrTopicScore = score;

                  var TopicValue = BoardOrTopicId.split('_')
                  var BoardTopicId = TopicValue[1];

                  $('[id$=txtUserTopicRating]').val(BoardOrTopicScore);
                  $('[id$=txtModalTopicUserRating]').val(BoardOrTopicScore);

                  $('#divModalTopicUserRating').raty({
                      cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                      cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                      starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                      starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                      starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                      score: $('[id$=txtModalTopicUserRating]').val(),
                      click: function (score, evt) {

                          var BoardOrTopicId = $(this).attr('id');
                          var BoardOrTopicScore = score;

                          var TopicValue = BoardOrTopicId.split('_')
                          var BoardTopicId = TopicValue[1];

                          $('[id$=txtUserTopicRating]').val(BoardOrTopicScore);
                          $('[id$=txtModalTopicUserRating]').val(BoardOrTopicScore);
                      }
                  });

                  $('[id$=txtLearningBoardTopicID]').val(TopicValue[1]);

                  $('[id$=txtTopicDivRating]').val(BoardOrTopicId);
                  $('[id$=txtTopicScore]').val($(this).attr('data-score'));

                  Visualforce.remoting.Manager.invokeAction(
                      '{!$RemoteAction.AthenaLearningBoardDtls.GetTopicRatingHistory}',
                      BoardTopicId,
                      GenerateTopicHistory
                  );

                  $('#NotOwnerOrContributorTopicRating').show();
                  $('#OwnerOrContributorTopicRating').hide();
                  $('#dvModalTopic').modal('show');
              }
          });
      }

      function RestrictCharacters(data) {

          var characters = 100;

          if ($(data).val().length > characters) {
              $(data).val($(data).val().substr(0, characters));
          }

          var remaining = characters - $(data).val().length;
          $('[id$=counter]').html("You have <strong>" + remaining + "</strong> characters remaining");
          if (remaining <= 10) {
              $('[id$=counter]').show();
              $('[id$=counter]').css("color", "red");
          }
          else {
              $('[id$=counter]').hide();
              $('[id$=counter]').css("color", "black");
          }
      }

      function RestrictTopicCharacters(data) {
          var characters = 100;

          if ($(data).val().length > characters) {
              $(data).val($(data).val().substr(0, characters));
          }

          var remaining = characters - $(data).val().length;
          $('[id$=topicCounter]').html("You have <strong>" + remaining + "</strong> characters remaining");
          if (remaining <= 10) {
              $('[id$=topicCounter]').show();
              $('[id$=topicCounter]').css("color", "red");
          }
          else {
              $('[id$=topicCounter]').hide();
              $('[id$=topicCounter]').css("color", "black");
          }
      }

      function functionCommunityLeave(data) {

          $('#dvModalLeave').modal('show');
      }

      function ShowHideRatingForOwner(data) {

          var BoardTopicId = $(data).attr('data-topicId');
          Visualforce.remoting.Manager.invokeAction(
                             '{!$RemoteAction.AthenaLearningBoardDtls.GetTopicRatingHistory}',
                             BoardTopicId,
                             GenerateTopicHistory
                         );
          $('#NotOwnerOrContributorTopicRating').hide();
          $('#OwnerOrContributorTopicRating').show();
          $('#dvCancelRatingHistory').show();
          $('#TopicRating').text('Rating History');
          $('#dvModalTopic').modal('show');
      }

      function ShowHideRatingForOwnerBoard(data) {
          //var BoardId = $.urlParam('id');
          //Visualforce.remoting.Manager.invokeAction(
          //                   '{!$RemoteAction.AthenaLearningBoardDtls.GetBoardRatingHistory}',
          //                   BoardId,
          //                   GenerateBoardHistory
          //               );
          //$('#NotOwnerOrContributorTopicRating').hide();
          //$('#OwnerOrContributorTopicRating').show();
          //$('#TopicRating').text('Rating History');
          //$('#dvModalTopic').modal('show');

          $('[id$=dvstaticOwnerOrContributor]').hide();
          $('[id$=BoardRating]').text('Rating History');
          $('#dvstaticRatingCancel').show();
          $('#dvRatingModalStatic').modal('show');
      }

      function ValidateShareEmail(data) {

          $('#EmailValidate').empty();
          var RegularExpression = new RegExp(/^[0-9A-Za-z\.\-\_]*[@][Hh][Pp][.][Cc][Oo][Mm]$/);
          var userEmailId = $('[id$=txtEmailinputUser]').val();
          if (userEmailId.search(RegularExpression) == -1) {
              var ErrorMessage = "Please enter User Email in the format - john.doe@hp.com";
              $('#EmailValidate').append(ErrorMessage);
              $('#EmailValidate').append('<br/>');
              $('#EmailValidate').show();
          }
          else {
              $('#EmailValidate').hide();
              $('[id$=btnBoardEmail]').click();
          }
      }

      function ValidateTopicShareEmail(data) {

          $('#EmailValidateTopic').empty();
          var RegularExpression = new RegExp(/^[0-9A-Za-z\.\-\_]*[@][Hh][Pp][.][Cc][Oo][Mm]$/);
          var userEmailId = $('[id$=txtInputEmailTopic]').val();
          if (userEmailId.search(RegularExpression) == -1) {
              var ErrorMessage = "Please enter User Email in the format - john.doe@hp.com";
              $('#EmailValidateTopic').append(ErrorMessage);
              $('#EmailValidateTopic').append('<br/>');
              $('#EmailValidateTopic').show();
          }
          else {
              $('#EmailValidateTopic').hide();
              $('[id$=SendTopicSharedEmail]').click();
          }
      }

      function AssignCategoryName() {

          var ctgryNm = $('[id$=txtCategoryName]').val();
          console.debug('ctgryNm--------'+ctgryNm);
          $('[id$=hdnTopicCatName]').val(ctgryNm);
      }

      function NavigateUrl(data)
      {
          debugger
          var TopicID = "linkDoc_" + $(data).attr('data-ID');
          var id=$(data).attr('data-ID');
          var name=$(data).attr('data-Name');
          var isImage=$(data).attr('data-Image');
          var TopicURL = $(data).attr('Data-Url');
          
          var PPTTopicURL = unescape(TopicURL);
        $("#lnkDownloadFile").removeAttr('href');
        OpenPopUp(PPTTopicURL);
          //$('[id$=' + TopicID + ']').attr('href', PPTTopicURL);
          var fileType='';
          if(isImage.indexOf('yes')!=-1)
          {
              if($(data).attr('data-Type').toUpperCase()=='OTHER')
              {
                  fileType='Content Image Click - Web Link';
              }
              else
              {
                  fileType='Content Image Click - '+$(data).attr('data-Type');
              }
              LogDownloadImageMetrics(PPTTopicURL,id,name,fileType);
          }
          else
          {
              if($(data).attr('data-Type').toUpperCase()=='OTHER')
              {
                  fileType='Content Name Click - Web Link';
              }
              else
              {
                  fileType='Content Name Click - '+$(data).attr('data-Type');
              }
              LogDownloadImageMetrics(PPTTopicURL,id,name,fileType);
          }
      }

      function OpenAssociatedModalPopUp(data) {

          var DocType = $(data).attr('Data-DocType');
          var Url = $(data).attr('Data-Url');
$("#lnkDownloadFile").removeAttr('href');
       
          var id = $(event).attr('data-PositionID');

          $('#hdnSetPosition').val(id);

          if (DocType == 'PDF') {
              ShowPDF(data, Url);
              OpenPopUp(Url);
          }
          else if (DocType == 'PPT') {
              ShowPPTX(Url);
              OpenPopUp(Url);
          }
          else if (DocType == 'DOC') {
              ShowDOCX(Url);
              OpenPopUp(Url);
          }
          else if (DocType == 'XLS') {
              ShowXLSX(Url);
              OpenPopUp(Url);
          }
          else if (DocType == 'TXT') {
              ShowTXT(data, Url);
              OpenPopUp(Url);
          }
          else if (DocType == 'OTHER')
          {
              $('#previewDocs').hide();
              $('#preivewHeading').show();
              $('#previewHeading').attr('href', Url);
              ShowHTML(data, Url);
          }
      }

      function ShowPDF(event, data) {

          //var pdfURL = $(data).attr('Data-Url');
          var id = $(event).attr('data-PositionID');

          $('#hdnSetPosition').val(id);
          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'block';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappPDF' } };

          m.payload.url = data;
          //m.payload.url = 'https://ensv.hp.com/sales/sam/docs/sam-1-3908/en/EMEA-ABS-Masterclass---SAP-HANA.pdf';
          m.payload.contenttype = 'application/pdf';
          Sfdc.canvas.controller.publish(m);
          $('#modalPreviewRequired').modal('show');
      }

      //function ShowPDF(url) {
      //    debugger;
      //    document.getElementById('modalPreviewRequired').style.display = 'block';
      //    document.getElementById('cappPDF').style.display = 'block';
      //    document.getElementById('cappTXT').style.display = 'none';
      //    document.getElementById('cappXLSX').style.display = 'none';
      //    //document.getElementById('divDOCXCanvas').style.display = 'none';
      //    //document.getElementById('divHTMLCanvas').style.display = 'none';
      //    //document.getElementById('divVideoCanvas').style.display = 'none';
      //    //document.getElementById('divXLSXCanvas').style.display = 'none';
      //    //document.getElementById('divPPTXCanvas').style.display = 'none';

      //    var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappPDF' } };

      //    m.payload.url = url;
      //    //m.payload.url= 'http://prime31.sharepoint.hp.com/teams/social%20learning/FileRepoWS/Uploads/a6wZ00000008r4xIAA/EMEA-ABS-Masterclass---SAP-HANA.pdf';
      //    m.payload.contenttype = 'application/pdf';
      //    //alert(JSON.stringify(m));
      //    Sfdc.canvas.controller.publish(m);
      //    $('#modalPreviewRequired').modal('show');
      //}

      function ShowDOCX(data) {

          // var pdfURL = $(data).attr('Data-Url');

          //document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          //document.getElementById('cappDOCX').style.display = 'block';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappDOCX' } };

          m.payload.url = data;
          m.payload.contenttype = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document';
          Sfdc.canvas.controller.publish(m);
          //$('#modalPreviewRequired').modal('show');
      }
      function ShowPPTX(data) {

          //var pdfURL = $(data).attr('Data-Url');

          // document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          //document.getElementById('cappPPT').style.display = 'block';


          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappPPT' } };

          m.payload.url = data;
          //   m.payload.url= 'http://prime31.sharepoint.hp.com/teams/social%20learning/FileRepoWS/Uploads/a8CZ0000000CbccMAC/Athena%20-PLM%20Web%20Service%20Specification.pptx';
          // m.payload.url= 'http://prime31.sharepoint.hp.com/teams/social%20learning/FileRepoWS/Uploads/a6wZ00000008rNBIAY/ESIT%20FY14%20Q1%20Mobility%20Campaign%20-%20Scrum.pptx';
          // m.payload.contenttype = 'application/vnd.ms-powerpoint';
          m.payload.contenttype = 'vnd.ms-powerpoint.presentation.macroEnabled.12';

          //m.payload.contenttype = 'application/vnd.openxmlformats-officedocument.presentationml.presentation';
          Sfdc.canvas.controller.publish(m);

          //$('#modalPreviewRequired').modal('show');
      }

      function ShowXLSX(data) {

          //var pdfURL = $(data).attr('Data-Url');

          // document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          //document.getElementById('cappXLSX').style.display = 'block';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappXLSX' } };

          m.payload.url = data;
          m.payload.contenttype = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
          Sfdc.canvas.controller.publish(m);
          //$('#modalPreviewRequired').modal('show');
      }

      function ShowHTML(data, url) {

          var id = $(event).attr('data-PositionID');

          $('#hdnSetPosition').val(id);
          //var pdfURL = $(data).attr('Data-Url');

          document.getElementById('modalPreviewRequired').style.display = 'block';
          //document.getElementById('cappPDF').style.display = 'none';
          //document.getElementById('cappTXT').style.display = 'none';
          //document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'block';
          //document.getElementById('cappDOCX').style.display = 'none';
          //document.getElementById('cappPPT').style.display = 'none';
          document.getElementById('cappHTMLFrame').style.display = 'block';
          document.getElementById('frameFileUrl').style.display = 'none';
          document.getElementById('cappHTMLFrame').setAttribute('src', '');


          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappHTML' } };

          var urlText = url;
          if (url.indexOf("https") == -1) {
              urlText = url.replace("http:", "https:");
          }


          if (urlText.indexOf("https://www8.hp.com") != -1) {
              urlText = urlText.replace("https://www8.hp.com", "https://ssl.www8.hp.com:");
          }

          $('#cappHTMLFrame').attr('src', urlText);

          //m.payload.url = urlText;
          //m.payload.contenttype = 'html';
          //Sfdc.canvas.controller.publish(m);
          $('#modalPreviewRequired').modal('show');
      }

      function ShowTXT(event, url) {

          var id = $(event).attr('data-PositionID');

          $('#hdnSetPosition').val(id);
          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'block';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'none';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappTXT' } };

          m.payload.url = url;
          m.payload.contenttype = 'text/plain';
          Sfdc.canvas.controller.publish(m);
          $('#modalPreviewRequired').modal('show');
      }

      function functionOpenVideo(data) {

          var id = $(data).attr('data-PositionID');

          $('#hdnSetPosition').val(id);
          var videoNameHeading = $(data).attr('Data-Name');

          var videoURL = $(data).attr('Data-Url');

          $('#frameVideo').attr('src', videoURL);
          //$('#videoHeading').text(videoNameHeading);
          $('#previewVideo').attr('href', videoURL);
          $('#VideoPopUp').modal('show');

      }

      function ShowDocumentToHTML(data) {

          document.getElementById('modalPreviewRequired').style.display = 'block';
          document.getElementById('cappPDF').style.display = 'none';
          document.getElementById('cappTXT').style.display = 'none';
          document.getElementById('cappXLSX').style.display = 'none';
          document.getElementById('cappHTML').style.display = 'block';
          document.getElementById('cappDOCX').style.display = 'none';
          document.getElementById('cappPPT').style.display = 'none';

          var m = { 'name': 'button.click', 'payload': { 'url': 'abc', 'contenttype': 'def' }, 'target': { 'canvas': 'cappHTML' } };

          var predefinedURL = 'https://it-services-gw-csc-itg.external.hp.com/gw/esit/sfdc/idol.dev/action=View&NoACI=true&OutputType=html&EmbedImages=true&reference=';

          predefinedURL += data;

          m.payload.url = predefinedURL;
          m.payload.contenttype = 'html';
          Sfdc.canvas.controller.publish(m);

          $('#modalPreviewRequired').modal('show');
      }

      function functionCloseDialog() {
          var positionID = $('#hdnSetPosition').val();

          if (positionID != '' || positionID != "") {
              $("html, body").animate({ scrollTop: $('#' + positionID).offset().top }, 1000);
          }
      }

      function ScrollToRelativePosition(positionId) {
          debugger;
          $("html, body").animate({ scrollTop: $('#' + positionId).offset().top }, 1000);
      }

      function BusinessGroupSort(data) {
          debugger
          var listCommContMem ='{!ContributorMember}';
          var parseCommContM = $.parseJSON(listCommContMem);
          var Cnt = '(' + parseCommContM.length + ')';
          $('#ConMemCnt').text(Cnt);
          var BGList = BusinessGroupFilter(parseCommContM);
          // Call Sort By Name
          //RegionList.sort(SortByBusinessGroup);
          DisplayContributorMembers(BGList);
          $('#aAToZ,#aContriMembers,#aRegion,#aRoleName').removeClass('aActive').addClass('colorGrey');
          $('#aBusinessGrp').removeClass('colorGrey').addClass('aActive');
      }

      function SortByBusinessGroup(x, y) {

          return ((x.BusinessGroup.toUpperCase() == y.BusinessGroup.toUpperCase()) ? 0 : ((x.BusinessGroup.toUpperCase() > y.BusinessGroup.toUpperCase()) ? 1 : -1));
      }
      function BusinessGroupFilter(data) {
          var RegionArr = [];
          var RegionArrLength = 0;
          for (var iCount = 0; iCount < data.length; iCount++) {
              if (data[iCount].BusinessGroup != null && data[iCount].BusinessGroup != '') {
                  RegionArr[RegionArrLength] = data[iCount];
                  RegionArrLength = RegionArrLength + 1;
              }
          }
          RegionArr.sort(SortByBusinessGroup);
          for (var iCount = 0; iCount < data.length; iCount++) {
              if (data[iCount].BusinessGroup == null || data[iCount].BusinessGroup == '') {
                  RegionArr[RegionArrLength] = data[iCount];
                  RegionArrLength = RegionArrLength + 1;
              }
          }
          return RegionArr;
      }


      function SortByRole(x, y) {

          return (((x.RoleName || "").toUpperCase() == (y.RoleName || "").toUpperCase()) ? 0 : (((x.RoleName || "").toUpperCase() > (y.RoleName || "").toUpperCase()) ? 1 : -1));
      }
      function RoleFilter(data) {
          var RegionArr = [];
          var RegionArrLength = 0;
          for (var iCount = 0; iCount < data.length; iCount++) {
              if (data[iCount].RoleName != null && data[iCount].RoleName != '') {
                  RegionArr[RegionArrLength] = data[iCount];
                  RegionArrLength = RegionArrLength + 1;
              }
          }
          RegionArr.sort(SortByRole);
          for (var iCount = 0; iCount < data.length; iCount++) {
              if (data[iCount].RoleName == null || data[iCount].RoleName == '') {
                  RegionArr[RegionArrLength] = data[iCount];
                  RegionArrLength = RegionArrLength + 1;
              }
          }
          return RegionArr;
      }

      function RoleSort(data) {

          var listCommContMem = '{!ContributorMember}';
          var parseCommContM = $.parseJSON(listCommContMem);
          var Cnt = '(' + parseCommContM.length + ')';
          $('#ConMemCnt').text(Cnt);
          var RegionList = RoleFilter(parseCommContM);
          // Call Sort By Name
          //RegionList.sort(SortByRole);
          DisplayContributorMembers(RegionList);
          $('#aAToZ,#aContriMembers,#aBusinessGrp,#aRegion').removeClass('aActive').addClass('colorGrey');
          $('#aRoleName').removeClass('colorGrey').addClass('aActive');

      }



      function SortByRegion(x, y) {

          return ((x.Region.toUpperCase() == y.Region.toUpperCase()) ? 0 : ((x.Region.toUpperCase() > y.Region.toUpperCase()) ? 1 : -1));
      }
      function RegionFilter(data) {
          var RegionArr = [];
          var RegionArrLength = 0;
          for (var iCount = 0; iCount < data.length; iCount++) {
              if (data[iCount].Region != null && data[iCount].Region != '') {
                  RegionArr[RegionArrLength] = data[iCount];
                  RegionArrLength = RegionArrLength + 1;
              }
          }
          RegionArr.sort(SortByRegion);
          for (var iCount = 0; iCount < data.length; iCount++) {
              if (data[iCount].Region == null || data[iCount].Region == '') {
                  RegionArr[RegionArrLength] = data[iCount];
                  RegionArrLength = RegionArrLength + 1;
              }
          }
          return RegionArr;
      }

      function RegionSort(data) {

          var listCommContMem = '{!ContributorMember}';
          var parseCommContM = $.parseJSON(listCommContMem);
          var Cnt = '(' + parseCommContM.length + ')';
          $('#ConMemCnt').text(Cnt);
          var RegionList = RegionFilter(parseCommContM);
          // Call Sort By Name
          //RegionList.sort(SortByRegion);
          DisplayContributorMembers(RegionList);
          $('#aAToZ,#aContriMembers,#aBusinessGrp,#aRoleName').removeClass('aActive').addClass('colorGrey');
          $('#aRegion').removeClass('colorGrey').addClass('aActive');

      }

      function SortByName(x, y) {

          return ((x.UserName.toUpperCase() == y.UserName.toUpperCase()) ? 0 : ((x.UserName.toUpperCase() > y.UserName.toUpperCase()) ? 1 : -1));
      }


      function AToZSort(data) {

          var listCommContMem = '{!ContributorMember}';
          var parseCommContM = $.parseJSON(listCommContMem);
          var Cnt = '(' + parseCommContM.length + ')';
          $('#ConMemCnt').text(Cnt);
          // Call Sort By Name
          parseCommContM.sort(SortByName);
          DisplayContributorMembers(parseCommContM);
          $('#aRegion,#aContriMembers,#aBusinessGrp,#aRoleName').removeClass('aActive').addClass('colorGrey');
          $('#aAToZ').removeClass('colorGrey').addClass('aActive');


      }

      function DisplayContributorMembers(parseCommContM) {
          $('#divContMember').empty();

          for (var iCount = 0; iCount < parseCommContM.length; iCount++) {
              var DisplayContributorMem = (" <li>");
              DisplayContributorMem += ("<span class='label hpit_athenaListPersonImg'>  <img src=" + parseCommContM[iCount].Userphoto + "  /> </span>");

              DisplayContributorMem += ("<span class='itemLMdes itemLMCom'> ");

              var UserDtls = "/apex/AthenaUserProfile?id=" + parseCommContM[iCount].UserId;
              DisplayContributorMem += (" <span class='bold'><a href=" + UserDtls + "  target='_top'>" + parseCommContM[iCount].UserName + "</a></span>");

              if (parseCommContM[iCount].RoleName != null) {

                  DisplayContributorMem += ("<span> " + parseCommContM[iCount].RoleName + "</span> ");
              }
              if (parseCommContM[iCount].IsExperts) {
                  DisplayContributorMem += (" <span class='DivEx'>Expert</span> ");
              }
              if (parseCommContM[iCount].IsContributor) {
                  DisplayContributorMem += (" <span class='DivEx DivCon'>Contributor</span> ");
              }
              DisplayContributorMem += (" </span>");
              DisplayContributorMem += ("<div class='itemLMCom colorGrey'> ");
              if (parseCommContM[iCount].Region != '' && parseCommContM[iCount].Region != null) {
                  DisplayContributorMem += ("<span>" + parseCommContM[iCount].Region + "</span> ");
              }
              else {
                  DisplayContributorMem += ("<span> &nbsp; </span> ");
              }
              if ((parseCommContM[iCount].Region != '' && parseCommContM[iCount].Region != null) && (parseCommContM[iCount].BusinessGroup != "" && parseCommContM[iCount].BusinessGroup != null)) {
                  DisplayContributorMem += (" | ");
              }
              if (parseCommContM[iCount].BusinessGroup != "" && parseCommContM[iCount].BusinessGroup != null) {
                  DisplayContributorMem += ("<span>" + parseCommContM[iCount].BusinessGroup + "</span> ");
              }
              else {
                  DisplayContributorMem += ("<span> &nbsp; </span> ");
              }

              DisplayContributorMem += ("</div>");
              DisplayContributorMem += ("</li>");
              $('#divContMember').append(DisplayContributorMem);

          }
      }


      function generateRandom(min, max) {
          var arr = [];
          while (arr.length < max) {
              var randNum = Math.floor(Math.random() * (max - min + 1)) + min,
                  found = false;
              for (var i = 0; i < arr.length; i++) {
                  if (arr[i] == randNum) {
                      found = true;
                      break;
                  }
              }
              if (!found) arr[arr.length] = randNum;
          }
          return arr;
      }

      function CommunityContMember() {
          $('#aRegion,#aAToZ,#aBusinessGrp,#aRoleName').removeClass('aActive').addClass('colorGrey');
          $('#aContriMembers').removeClass('colorGrey').addClass('aActive');
          debugger
          var listCommContMem = '{!ContributorMember}';
          debugger
          var parseCommContM = $.parseJSON(listCommContMem);
          //$('#ConMemCnt').val(parseCommContM.length);
          var Cnt = '(' + parseCommContM.length + ')';
          $('#ConMemCnt').text(Cnt);
          DisplayContributorMembers(parseCommContM);
          var $x = $("#divContMember li");

          var orders = generateRandom(0, $x.length - 1);
          // Array.prototype.sort.call($x, function () { 
          //return Math.random() <0.5; 
          //});

          for (var ic = 0; ic < orders.length; ic++) {

              $("#divContMember").append($x[orders[ic]]);
          }
          // orders.each(function (i, $x) {
          //debugger;
          //$("#divContMember").append($x[i]); });
      }

      function ShareLearningBoard(data)
      {
          debugger;
          var LearningBoardID = $(data).attr('data-BoardId');
          $('#hdnShareLearningBoardId').val(LearningBoardID);
          $('#hdnShareLearningBoardName').val($(data).attr('data-BoardName'));

          Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.AthenaLearningBoardDtls.GetNetworkUsersList}', LearningBoardID, ShowNetworkUsers);
      }

      function ShareTopicLearningBoard(data)
      {debugger
          var LearningBoardID = '{!LearningBoardDtls.LbId}';
          var TopicID = $(data).attr('data-TopicId');
          var UniqueShareId = 'linkDoc_' + TopicID;
          var TopicCategoryName = unescape($(data).attr('data-catName'));
          $('[id$=hdnContentCtgyName]').val(TopicCategoryName);
          $('[id$=hdncontentId]').val($(data).attr('data-TopicId'));
          $('[id$=hdnTopicName]').val(UniqueShareId);
          
          $('#hdnContentId').val(TopicID);
          $('#hdnContentName').val(TopicCategoryName);
          Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.AthenaLearningBoardDtls.GetNetworkUsersList}', LearningBoardID, ShowNetworkUsers);
      }

      function ShowNetworkUsers(result, event) {
          debugger
          $('#shareToUsers').modal('show');

          var tblShare = ("<div class='alert-error' id='dvShareContentErrorMessage' style='display:none'></div><table class='table table-striped table-bordered' id='selectUsers'>" +
                                "<thead>" +
                                  "<tr>" +
                                    "<th style='width:8px;'><input type='checkbox' id='selectAll' class='group-checkable' data-set='#selectUsers .checkboxes' onclick = 'ToggleDataTableCheckbox(this)'/></th>" +
                                    "<th>Image</th>" +
                                    "<th>Username</th>" +
                                    "<th class='hidden-phone'>Email Id</th>" +
                                  "</tr>" +
                                "</thead>" +
                                "<tbody>");
          var tbodyShare = '';
          var SFInstance = '{!getSfInstance}';
          for (var iCount = 0; iCount < result.length; iCount++)
          {
              var ShareBody = ("<tr>" +
                               "<td><input type='checkbox' name='chkShare'  value=" + result[iCount].Id + " id='chk_'+result[iCount].Id /></td>"+
                               "<td><div class='hpit_athena_ca-item-personPhoto'><img width='35' height='35' alt='no_username_small' src='" + result[iCount].SmallPhotoUrl + "' /> </div></td>" +
                               "<td><a target=_blank href= https://" + SFInstance + "/apex/AthenaUserProfile?id=" + result[iCount].Id + ">" + result[iCount].Name + "</a></td>" +
                               "<td>" + result[iCount].Email + "</td>" +
                               "</tr>");
              tbodyShare += ShareBody;
          }
          tblShare += tbodyShare;
          var shareEndBody = ("</tbody>" +
          "</table>");
          tblShare += shareEndBody;

          var Comment = ("<div class='control-group bgGrayLight mtop10 activityOption'>" +
                        "<label class='control-label'>Comments <span style='color: #B8B6B6;'>- (optional)</span></label>" +
            "<div class='controls'>" +
             " <textarea rows='3' class='modelTextW' id='txtShareComment'></textarea>" +
              "</div>" +
          "</div>");
          tblShare += Comment;
          $('#divShareFeedItem').empty();
          $('#divShareFeedItem').append(tblShare);

          $('#selectUsers').dataTable({
              "sDom": "<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span6'i><'span6'p>>",
              "sPaginationType": "bootstrap",
              "bSortable": true,
              "aLengthMenu": [[5, 8, 10], [5, 8, 10]],
              "iDisplayLength": 5,
              "aoColumns": [{
                  "bVisible": true
              },{
                  "bVisible": true
              }, {
                  "bVisible": true
              }, {
                  "bVisible": true
              }],
              "oLanguage": {
                  "sLengthMenu": "_MENU_ records per page",
                  "oPaginate": {
                      "sPrevious": "Prev",
                      "sNext": "Next"
                  }
              },

              aoColumnDefs: [
                       { "aTargets": [0], "bSortable": false },
                       { "aTargets": [1], "bSortable": false },
                       { "aTargets": [2], "bSortable": true },
                       { "aTargets": [3], "bSortable": true }]
          });

          jQuery('#selectUsers.group-checkable').change(function () {
              var set = jQuery(this).attr("data-set");
              var checked = jQuery(this).is(":checked");
              jQuery(set).each(function () {
                  if (checked) {
                      $(this).attr("checked", true);
                  } else {
                      $(this).attr("checked", false);
                  }
              });
              jQuery.uniform.update(set);
          });

          jQuery('#selectUsers_wrapper .dataTables_filter input').addClass("input-medium"); // modify table search input
          jQuery('#selectUsers_wrapper .dataTables_length select').addClass("input-mini"); // modify table per page dropdown
          //$('#loading_Modal').modal('hide');
      }

      function ToggleDataTableCheckbox(event) {

          var oTable = $('#selectUsers').dataTable();

          // Get the nodes from the table
          var nNodes = oTable.fnGetNodes();

          if ($('#selectAll').is(':checked')) {
              $('input[type=checkbox]', oTable.fnGetNodes()).attr('checked', true);
          }
          else {
              $('input[type=checkbox]', oTable.fnGetNodes()).attr('checked', false);
          }
      }      
      
      function SaveUsers(data)
      {debugger
          var strRel = '';
          
          var oTable = $('#selectUsers').dataTable();
          var rowcollection =  oTable.$('input[name="chkShare"]:checked', {"page": "all"});
          rowcollection.each(function(index,elem){
              debugger;
              if (strRel == '') {
                  strRel = $(elem).val();
              }
              else {
                  strRel = strRel + ',' + $(elem).val();
              }

          });          

          if (strRel == '')
          {
              $('[id$=dvShareContentErrorMessage]').empty();
              $('[id$=dvShareContentErrorMessage]').text('Select at least one user');
              $('[id$=dvShareContentErrorMessage]').show();
          }
          else
          {
              $('[id$=dvShareContentErrorMessage]').empty();
              $('[id$=dvShareContentErrorMessage]').hide();
              document.cookie = "TopicCatName=" + $('[id$=hdnContentCtgyName]').val();

              $('[id$=hdnShareContentFlag]').val('Y');

              var ShareCmt = $('#txtShareComment').val();
              var TopicId = $('[id$=hdncontentId]').val();

              document.getElementById("{!$Component.SlpActv.hdnSelectedUsrsId}").value = strRel;
              document.getElementById("{!$Component.SlpActv.hdnShareComment}").value = ShareCmt;
              document.getElementById("{!$Component.SlpActv.hdnContentShareId}").value = TopicId;
              document.getElementById("{!$Component.SlpActv.hdnShareTopicName}").value = $('[id$=hdnTopicName]').val();
              
                        
              var operatingSystem=navigator.appVersion;
              operatingSystem=operatingSystem.substring(0,operatingSystem.indexOf("\)")+1);
              $('[id$=hdnShareOperatingSystem]').val(operatingSystem);
              $('[id$=hdnShareBrowser]').val(FindBrowserVersion());
              $('[id$=hdnShareDeviceType]').val('Desktop');

              var button = document.getElementById("{!$Component.SlpActv.SActivityShare}");
              button.click();
          }
      }
          
      function SetBrowserInfo()
      {
          debugger
          var operatingSystem=navigator.appVersion;
          operatingSystem=operatingSystem.substring(0,operatingSystem.indexOf("\)")+1);
        
          $('[id$=jhdnShareOperatingSystem]').val(operatingSystem);
          $('[id$=jhdnShareBrowser]').val(FindBrowserVersion());
          $('[id$=jhdnShareDeviceType]').val('Desktop');
          return true;
          //$('[id$=btnfollow]').click();
      }
      
   </script>
  </body>
  <!-- END BODY -->
  </html>
</apex:page>