<apex:page controller="AV_Activity" showheader="false" standardstylesheets="false" doctype="html-5.0" applybodytag="false" applyhtmltag="false">
  <!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
  <!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->
  <!--[if !IE]><!-->
  <html lang="en">
  <!--<![endif]-->
  <!-- BEGIN HEAD -->
  <head>
  <meta charset="utf-8" />
  <title>Social Learning</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta content="" name="description" />
  <meta content="" name="author" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/css/bootstrap.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/css/bootstrap-responsive.min.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/font-awesome/css/font-awesome.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style-responsive.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/style-default.css')}" />
  <apex:stylesheet value="{!URLFOR($Resource.assets_athena, 'assets_athena/data-tables/DT_bootstrap.css')}" />
   <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/tagit.ui-zendesk.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.css_athena, 'css_athena/jquery.tagit.css')}" />
  </head>
  <!-- END HEAD -->
  <!-- BEGIN BODY -->
  
  <body>
  <!-- BEGIN HEADER -->
  <header>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-fluid"><!-- <a class="HpLogo"> 
          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/insight_web_logo.png')}" style="width:220px" alt="HP Logo"/></a>    -->
          <apex:image url="{!URLFOR($Resource.img_athena, 'img_athena/HP_Blue_Logo.png')}" alt="HP Logo" styleclass="HpLogo"/>
          <!-- </a>-->
          <div class="nav mtop20">
            <h1 class="h1fontS">insight</h1>
            <h3>Information - on your terms</h3>
          </div>
          <ul class="nav pull-right top-menu">
            <!-- BEGIN USER LOGIN DROPDOWN -->
            
            <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown"> Welcome <span class="username colorBlue">{!LoggedinUserDtls.Name}</span> <span>
              <apex:image url="{!LoggedinUserDtls.FullPhotoUrl}" styleClass="userImage" alt="no_username"/>
              </span> </a>
              <ul class="dropdown-menu extended logout">
                <li><a href="https://{!getSfInstance}/apex/AthenaUserProfile?id={!LoggedinUserDtls.id}">My Profile</a></li>
                <li><a href="https://{!getSfInstance}/apex/SLP_EditUserProfile?id={!LoggedinUserDtls.id}">Edit Profile</a></li>
                <li><a href="https://{!getSfInstance}/secur/logout.jsp">Log Out</a></li>
              </ul>
            </li>
            <!-- END USER LOGIN DROPDOWN -->
          </ul>
          <c:SLP_SearchCustomComponent InputString="Activity Page"/>
          <div class="alert alert-error topSearchEr" style="display:none;" id="err_msg"> </div>
        </div>
      </div>
    </div>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-fluid menunavBar"> <a class="icon-book topNavIcon"  href="https://{!getSfInstance}/apex/AthenaSocialLearning" title="Library"></a> <a class="icon-book topNavIcon" style="display:none;"></a> <a class="icon-file-text-alt topNavIconC" href="https://{!getSfInstance}/apex/AthenacreatelearningBoard" title="Create Board"><span class="icon-plus NaviconPlus"></span></a> <a class="icon-group topNavIconCom" href="https://{!getSfInstance}/apex/SLP_createcommunity" title="Create Community"><span class="icon-plus NaviconPlus"></span></a> <a class="topNavRoll topNavIconCom" href="https://{!getSfInstance}/apex/SLP_UserRoleAndExpertiseMapping" title="User Role & Expert Mapping"><span class="NaviconPlus"></span></a> 
          
          <!--  <a class="icon-question-sign topNavIcon pull-right" href="https://ea2013.sharepoint.hp.com/teams/esplm/SitePages/Social Learning.aspx" target="_blank" title="Help"></a>--> 
        </div>
      </div>
    </div>
  </header>
  <!-- END HEADER -->
  
  <div id="container" class="row-fluid"> 
    <!-- BEGIN PAGE -->
    <div id="main-content"> 
      <!-- BEGIN PAGE CONTAINER-->
      <div class="container-fluid">
        <div class="row-fluid">
          <div class="span12">
          <apex:form id="selfRegister">
            <div class="widget box blue">
              <div class="widget-title">
                <h4> <i class="icon-reorder"></i> Set up your profile </h4>
                <span class="tools"> <a id="Expand-Collapse" href="javascript:;" class="icon-minus"></a> </span> </div>
              <div class="widget-body">
                <h1 style="font-size: 21.5px;"> Welcome to HP Insight! </h1>
        
                <hr>
                </hr>
                <div id="pills" class="custom-wizard-pills">
                  <fieldset>
                    <legend id="legendHead"> Profile Update </legend>
                    <div class="clearfix wizardUlDiv">
                      <div class="wizardDivBg"></div>
                      <ul style="position: absolute;z-index: 9999;">
                        <li><a href="#pills-tab1" data-toggle="tab">1</a></li>
                        <li><a href="#pills-tab2" data-toggle="tab">2</a></li>
                        <li><a href="#pills-tab3" data-toggle="tab">3</a></li>
                        <li style="margin-right:0"><a href="#pills-tab4" data-toggle="tab">4</a></li>
                      </ul>
                    </div>
                  </fieldset>
                  <div class="tab-content wizardTabCon"> 
                    <!-- progress bar  
                    <div class="progress progress-success progress-striped active">
                      <div class="bar"></div>
                    </div>-->
                    <!-- progress bar END's --> 
                    
                    <!-- Tab COntent Starts  -->
                    <div class="tab-pane" id="pills-tab1">
                      <span id="spnProfileText">It looks like your profile is not complete. Please fill out the fields below so we can get to know you better.</span>
                      <br/>
                      <input type="hidden" id="hdnIsFirstLogin" value="{!FirstLogin}"  name="firstLogin" />
                      <div class="row-fluid">
                        <div class="span6">
                          <div class="control-group">
                            <label>Title</label>
                            <div class="controls controls-row">
                              <input type="text" id="Title" class="input-block-level" placeholder="Title" value="{!GetTitle}"  name="" />
                            </div>
                          </div>
                         
                           <div class="control-group">
                            <label>Department</label>
                            <div class="controls controls-row">
                              <input type="text" id="Department" class="input-block-level" placeholder="Department" value="{!GetDepartment}"  name="" />
                            </div>
                          </div>
                         <label>Role</label>
                         <div class="control-group">
                         <div class="controls">
                            <input name="tags" id="RoleTags" value="{!GetUserRoleName}" placeholder="Department" class='hide'/>
                        
                            <ul id="RoleTagsTop">
                            </ul>
                        <div style="display:none">
                            <apex:inputText id="txtRole" value="{!Roletags}"  ></apex:inputText>
                        </div>
                        </div>
                        </div>
                        </div>
                        
                        <div class="span6">
                          <div class="control-group">
                         <label>Describe something about yourself</label>
                            <div class="controls controls-row">
                              <textarea id="aboutself" rows="9" class="span12" placeholder="Describe something about yourself">{!GetAboutMe}</textarea>
                            </div>
                          </div>
                        </div>

                          <div class="clearB">
                              <label class="pull-left">Areas of Focus</label>
                        <div class="control-group clearB">
                        <div class="controls">
                            <input name="tags" id="ExpertiseTags" value="{!AssociatedSkills}" placeholder="Department" class='hide'/>
                        <ul id="ExpertiseTagsTop">
                        </ul>
                        <div style="display:none">
                            <apex:inputText id="txtSkills" value="{!skilltags}"  />
                        </div>
                        </div>
                        </div>
                          </div>
                      </div>
                    </div>
                    <div class="tab-pane" id="pills-tab2">
                      <p> Tell us about your interests.</p>
                      <div class="clearfix"> <span class="pull-left span10">
                        <input type="text" placeholder="Type something..." size="20" onKeyDown=" " class="notifyInput span12" name=" " id="searchText" />
                        </span>
                        <div style="margin-top:3px" class="clearfix pull-left"><a class="btnAthena btn-primary topSearchBtn" onClick="GetSearchCommunity()" title="Click here to search" id="btnCommunitySearch" ><span class="icon-search"></span>&nbsp;</a> </div>
                      </div>
                      <div class="clearfix">
                        <h3>Featured communities</h3>
                          <div style="width:100%;"> 
                            <div style="position: relative;margin: 0px 15px 5px 41px;height: 100px;">
                                <div  id="RepeaterFeatureCommunity"> </div>
                            </div>
                          </div>
                        <div id="showSearchResults" style="display:none">
                          <h3 class="clearB">Recommended communities</h3>
                            <div style="width:100%;"> 
                            <div style="position: relative;margin: 0px 15px 5px 41px;height: 100px;">
                                <div id="RepeaterSearchCommunity"> </div>
                                </div>
                                </div>
                        </div>
                        </div>
                        <span id="privateCommunity" style="display:none" >One or more communities you have selected are private.You will get notified once the community owner has approved your request.</span>
                      </div>
                    <div class="tab-pane" id="pills-tab3">
                      <p> We found some people we think you may be interested in connecting with.  Start building your network by checking the box next to their picture..</p>
                        <div style="width:100%;"> 
                            <div style="position: relative;margin: 0px 15px 5px 41px;height: 130px;">

                                <div  id="RepeaterBuildNetworkDiv"> </div>
                        </div>
                            </div>
                    </div>
                    <div class="tab-pane" id="pills-tab4">
                      <span>Congratulations! Your profile is complete. You can now start creating boards and communities to exchange insights with others.</span>
                    </div>
                    
                    <!-- Tab COntent END's  -->
                    <ul class="pager wizard">
                       <li class="next"><a class="btnAthena btn-primary"  href="javascript:;" onclick="return SaveProfileInformation()" id="aNext">Next <span class="icon-angle-right"> </span></a></li>
                        <li class="previous"><a class="pull-right btnAthena" href="javascript:;" onclick="return previousProfileInformation()" id="aPrevious"><span class="icon-angle-left"> </span> Back</a></li>

                    </ul>
                  </div>
                </div>
              </div>
            </div>
            </apex:form>
          </div>    
        </div>
        <div class="row-fluid">
          <div class="span12">
            <h1 class="hpit_AthenaActH1">Featured</h1>
            <div class="hpit_Athena_container mtop10">
              <div class="hpit_Athena_contRowActive" style="width:100%;"> 
                <!--  <div class="hpit_Athena_contRow1Headding">
                        <div class="rotated-text"><span class="rotated-text__inner">Featured</span></div>
                    </div> --> 
                <!--<div id="Div1" class="hpit_athena_ca-conActivity">
                  <div class="hpit_athena_ca-wrapper"  id="RepeaterDiv"> </div>
                </div>-->
                <div id="Div1" style="position: relative;margin: 0px 57px 5px 125px;height: 190px;margin-bottom:-10px">
                  <div style="width: 100%;height: 62%;position: relative; padding-top:10px"  id="RepeaterDiv"> </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- SEARCH BTN -->
        <div class="row-fluid mtop20">
          <div class="span4">
            <div class="activityLeftDiv">
              <div class="mbot20">
                <h3>My Communities</h3>
                <div class="activityDivider"> </div>
                <apex:repeat value="{!DisplayCommunity}" var="commRslt">
                  <div class="communityList mtop10 mbot10 clearB clearfix">
                    <div class="activityComDiv">
                      <apex:outputPanel rendered="{!!commRslt.StaticImage}">
                        <apex:image url="{!URLFOR($Action.Attachment.Download, commRslt.AttachmentId)}" />
                      </apex:outputPanel>
                      <apex:outputPanel rendered="{!commRslt.StaticImage}"> <img src='{!commRslt.DefaultImageName}'/> </apex:outputPanel>
                    </div>
                    <div> <a class="bold" href='/apex/SLP_ViewCommunity?id={!commRslt.Id}'>{!commRslt.Name} </a></div>
                  </div>
                </apex:repeat>
                <!-- <button class="btnOrange">See more Communities</button> --> 
              </div>
              <div class="clearB">
                <hr />
                <h3>My Learning Boards</h3>
                <div class="activityDivider"> </div>
                <apex:repeat value="{!DisplayBoards}" var="BoardRslt">
                  <div class="boardList mtop10 mbot10 clearB clearfix">
                    <div class="activityBrdDiv">
                      <apex:outputPanel rendered="{!!BoardRslt.StaticImage}">
                        <apex:image url="{!URLFOR($Action.Attachment.Download, BoardRslt.AttachmentId)}" />
                      </apex:outputPanel>
                      <apex:outputPanel rendered="{!BoardRslt.StaticImage}"> <img src='{!BoardRslt.DefaultImageName}'/> </apex:outputPanel>
                    </div>
                    <div><a style="font-weight:bold" href='/apex/AthenaLearningBoardDtls?id={!BoardRslt.Id}'> {!BoardRslt.Name}</a> </div>
                  </div>
                </apex:repeat>
                <!-- <button class="btnOrange">See more Boards</button> --> 
              </div>
            </div>
          </div>
          <div class="span8"> 
            <!-- <apex:form id="SlpActhdn">
          <apex:inputhidden id="hdnFeedItemId" value="{!hdnFeedItem}" />
          <apex:inputhidden id="hdnSelectedUsrsId" value="{!SelectedUsrs}" />
          <apex:inputhidden id="hdnShareComment" value="{!hdnSharecmt}" />
          
          </apex:form> -->
            
            <div>
              <h3>Activity Stream</h3>
              <div class="activityDivider"> </div>
              <apex:repeat value="{!GenerateUserCommunityPostAndComments}"  var="CommunityPostComment">
                <div class="activityList mtop10 mbot10 clearfix" id="{!CommunityPostComment.SequenceNo}">
                  <apex:repeat value="{!CommunityPostComment.ListFeedPost}"  var="Post">
                    <div class="activityProfileImg" > <img src=" {!Post.UsrPhoto}" /> </div>
                    <div class="pull-left postComDiv">
                      <apex:outputPanel rendered="{!!CommunityPostComment.IsCommunity}" >
                        <div> <a class="bold" href='/apex/AthenaLearningBoardDtls?id={!CommunityPostComment.BoardOrCommId}'> {!CommunityPostComment.BoardOrCommNm}</a> - <a href='apex/AthenaUserProfile?id={!Post.PostedUserId}'>{!Post.PostedUserName}</a> </div>
                      </apex:outputPanel>
                      <apex:outputPanel rendered="{!CommunityPostComment.IsCommunity}" >
                        <div> <a class="bold" href='/apex/SLP_ViewCommunity?id={!CommunityPostComment.BoardOrCommId}'> {!CommunityPostComment.BoardOrCommNm}</a> - <a href='apex/AthenaUserProfile?id={!Post.PostedUserId}'>{!Post.PostedUserName}</a> </div>
                      </apex:outputPanel>
                      <div class="activityPost"><span class="preLine"> {!Post.PostName} </span>
                        <button class="btnOrange mr5" data-toggle="modal" data-CreatedId='{!Post.PostedUserId}' data-IsComm="{!CommunityPostComment.IsCommunity}"  data-FeedItemId='{!Post.PostId}' data-BrdComm="{!CommunityPostComment.BoardOrCommId}" data-SequenceNo ="{!CommunityPostComment.SequenceNo}" onclick ="UserShareActivity(this)" >Share</button>
                        <div class="colorGrey"> <span class="icon-time"></span> {!Post.PostedDate} </div>
                        <apex:outputPanel rendered="{!Post.IsLink}">
                          <div class="activityLink"> <span class="icon-link"> </span> <a href="{!Post.LinkUrl}">{!Post.Title}</a> </div>
                        </apex:outputPanel>
                      </div>
                    </div>
                    <apex:repeat value="{!Post.lstPostComment}" var="Comment" >
                      <div class="activityComment clearfix clearB" style="margin-left:50px;">
                        <div class="activityProfileImg"> <img src=" {!Comment.CmtUsrPhoto}" /> 
                          <!-- <img src="https://hp--ESIT--c.cs11.content.force.com/profilephoto/729Z0000000Crpk/T" />  --> 
                        </div>
                        <div class="pull-left activityProfileWidth"><span>
                          <div><a>{!Comment.CmtUserNm}</a> </div>
                          </span>
                          <div class="activityPost"> <span class="preLine"> {!Comment.CommentName} </span> </div>
                          <div class="colorGrey"> <span class="icon-time"></span> {!Comment.CommentedDate} </div>
                          <apex:outputPanel rendered="{!Comment.IsLink}">
                            <div class="activityLink"> <span class="icon-link"> </span> <a href="{!Comment.LinkUrl}">{!Comment.CommentBody}</a> </div>
                          </apex:outputPanel>
                        </div>
                      </div>
                    </apex:repeat>
                  </apex:repeat>
                </div>
              </apex:repeat>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- modal popup  -->
  <div id="shareToUsers" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel1" aria-hidden="true" data-backdrop="static" style="width:650px; left:46.5%; top:0"> 
    <!-- <form class="form-horizontal" action="#"> -->
    <div class="modal-header">
      <h3>Select Users From Your Network</h3>
    </div>
    <div class="modal-body">
      <div  id="divShareFeedItem"> </div>
    </div>
    <!-- </form> -->
    <apex:form id="SlpActv">
      <div class="modal-footer">
        <button class="btnAthena" data-dismiss="modal" aria-hidden="true">Cancel</button>
        <input type="button" class="btnAthena btn-primary btnAthenaPopP" data-FeedItmId="123"  value="Share"  id="CategorySave"  onclick="SaveShare(this)" />
        <apex:commandButton styleclass="btnAthena btn-primary btnAthenaPopP"  style="display:none"   action="{!SharedComment}"  value="Share" id="SActivityShare"/>
      </div>
      <apex:inputText id="hdnFeedItemId" style="display:none"  value="{!hdnFeedItem}"/>
      <apex:inputText id="hdnSelectedUsrsId" style="display:none"  value="{!SelectedUsrs}"/>
      <apex:inputText id="hdnShareComment" style="display:none"  value="{!hdnSharecmt}"/>
      <apex:inputText id="hdnBoradOrComm" style="display:none"  value="{!hdnBoardComm}"/>
      <apex:inputText id="hdnIsComm" style="display:none"  value="{!IshdnComm}"/>
      <apex:inputText id="hdnActivitySequence" style="display:none"  value="{!ActivitySequenceNo}"/>
    </apex:form>
  </div>
  <input type="hidden" id="hdnSetPosition" />
  <!-- BEGIN FOOTER -->
  <div id="footer"> © Hewlett-Packard Development Company, L.P.     |     HP Restricted </div>
  <!-- END FOOTER --> 
  
  <!-- BEGIN JAVASCRIPTS --> 
  <!-- Load javascripts at bottom, this will reduce page load time
         --> 
  
  <!--<apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/jquery-1.8.3.min.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/js/bootstrap.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/jquery-ui/jQuery_UI_1_10_3.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/typeahead.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/jquery.feedback_me.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/raty/ratyViewJs.js')}" />--> 
  <!-- ie8 fixes --> 
  <!--[if lt IE 9]>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/excanvas.js')}"/>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/respond.js')}"/>
   <![endif]--> 
  
  <!--common script for all pages-->
  
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/jquery-1.8.3.min.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap/js/bootstrap.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/jquery-ui/jQuery_UI_1_10_3.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/data-tables/jquery.dataTables.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/data-tables/DT_bootstrap.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/bootstrap-wizard/jquery.bootstrap.wizard.min.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.assets_athena, 'assets_athena/raty/ratyViewJs.js')}"/>
  <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/common-scripts.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/tag-it.js')}"/>
  <!-- ie8 fixes --> 
  <!--[if lt IE 9]>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/excanvas.js')}"/>
   <apex:includeScript value="{!URLFOR($Resource.js_athena, 'js_athena/respond.js')}"/>
   <![endif]--> 

      
  
  <script>

      // Script for WIZARD

      var Script = function () {

          $('#pills').bootstrapWizard({
              'tabClass': 'nav nav-pills', 'debug': false, onShow: function (tab, navigation, index) {
                  console.log('onShow');
              }, onNext: function (tab, navigation, index) {
                  console.log('onNext');
              }, onPrevious: function (tab, navigation, index) {
                  console.log('onPrevious');
              }, onLast: function (tab, navigation, index) {
                  console.log('onLast');
              }, onTabClick: function (tab, navigation, index) {
                  //console.log('onTabClick');
              }, onTabShow: function (tab, navigation, index) {
                  console.log('onTabShow');
                  var $total = navigation.find('li').length;
                  var $current = index + 1;
                  var $percent = ($current / $total) * 100;
                  $('#pills').find('.bar').css({ width: $percent + '%' });
              }
          });

          $('#tabsleft').bootstrapWizard({
              'tabClass': 'nav nav-tabs', 'debug': false, onShow: function (tab, navigation, index) {
                  console.log('onShow');
              }, onNext: function (tab, navigation, index) {
                  console.log('onNext');
              }, onPrevious: function (tab, navigation, index) {
                  console.log('onPrevious');
              }, onLast: function (tab, navigation, index) {
                  console.log('onLast');
              }, onTabClick: function (tab, navigation, index) {
                  console.log('onTabClick');

              }, onTabShow: function (tab, navigation, index) {
                  console.log('onTabShow');
                  var $total = navigation.find('li').length;
                  var $current = index + 1;
                  var $percent = ($current / $total) * 100;
                  $('#tabsleft').find('.bar').css({ width: $percent + '%' });

                  // If it's the last tab then hide the last button and show the finish instead
                  if ($current >= $total) {
                      $('#tabsleft').find('.pager .next').hide();
                      $('#tabsleft').find('.pager .finish').show();
                      $('#tabsleft').find('.pager .finish').removeClass('disabled');
                  } else {
 
                      $('#tabsleft').find('.pager .next').show();
                      $('#tabsleft').find('.pager .finish').hide();
                  }

              }
          });


          $('#tabsleft .finish').click(function () {
              alert('Finished!, Starting over!');
              $('#tabsleft').find("a[href*='tabsleft-tab1']").trigger('click');
          });

      }();
             </script> 
  <script>
      $(document).ready(function () {

          LoadFeaturedLB();
          var positionID = $('#hdnActivitySequence').val();

          var sequenceNumber = '{ !ActivitySequenceNo }';

          //if (positionID != '' || positionID != "" || positionID != undefined) {
          //    $("html, body").animate({ scrollTop: $('#' + positionID).offset().top }, 1000);
          //}

          // DATATABLE SLP_1
          // -------------------------------------------------------------------------------- * -->
          // removed table: Komala
                if($('[id$=RoleTags]').val()!='' && $('[id$=Title]').val()!='' && $('[id$=ExpertiseTags]').val()!='' && $('[id$=aboutself]').val()!='' && $('[id$=Department]').val()!='')
                {
                    //$('#spnProfileText').hide();
                     $('[id$=spnProfileText]').text("It looks like your profile is complete. Is there anything you would like to add or change?");
                    
                }
                else
                {
                    //$('#spnProfileText').show();
                }
                
                if($('[id$=hdnIsFirstLogin]').val()!='false')
                {
                debugger;
                 var el = jQuery('#Expand-Collapse').parents(".widget").children(".widget-body");
                  if (jQuery('#Expand-Collapse').hasClass("icon-minus")) {
                      jQuery('#Expand-Collapse').removeClass("icon-minus").addClass("icon-plus");
                      el.slideUp(200);
                }
                }               
                
      });

      function UserShareActivity(data) {


          var id = $(data).attr('data-SequenceNo');

          $('#hdnSetPosition').val(id);

          var CreateUsrId = $(data).attr('data-CreatedId');
          var FeedImId = $(data).attr('data-FeedItemId');
          var BoradOrCommId = $(data).attr('data-BrdComm');
          var IsComm = $(data).attr('data-IsComm');
          document.getElementById("{!$Component.SlpActv.hdnIsComm}").value = IsComm;
          document.getElementById("{!$Component.SlpActv.hdnBoradOrComm}").value = BoradOrCommId;

          document.getElementById("{!$Component.SlpActv.hdnFeedItemId}").value = FeedImId;
          //$('[id$=hdnFeedItemId]').val(FeedImId);
          Visualforce.remoting.Manager.invokeAction(
       '{!$RemoteAction.AV_Activity.UserFollwerShare}',
       CreateUsrId,
       ShareActivity
   );
      }

      function ShareActivity(result, event) {

          var tblShare = ("<div class='alert-error' id='dvShareContentErrorMessage' style='display:none'></div><table class='table table-striped table-bordered' id='selectUsers'>" +
                                "<thead>" +
                                  "<tr>" +
                                    "<th style='width:8px;'><input type='checkbox' id='selectAll' class='group-checkable' data-set='#selectUsers .checkboxes' onclick = 'ToggleDataTableCheckbox(this)'/></th>" +
                                    "<th>Image</th>" +
                                    "<th>Username</th>" +
                                    "<th class='hidden-phone'>Email Id</th>" +
                                  "</tr>" +
                                "</thead>" +
                                "<tbody>");
          var tbodyShare = '';
          for (var iCount = 0; iCount < result.length; iCount++) {
              //class='checkboxes'
              var ShareBody = ("<tr>" +
                 "<td><input type='checkbox' name='chkShare'  value=" + result[iCount].Id + " id='chk_'+result[iCount].Id /></td>" +
                 "<td><div class='hpit_athena_ca-item-personPhoto'><img width='35' height='35' alt='no_username_small' src='" + result[iCount].SmallPhotoUrl + "' /> </div></td>" +
                 "<td><a>" + result[iCount].Name + "</a></td>" +
                 "<td>" + result[iCount].Email + "</td>" +
               "</tr>");
              tbodyShare += ShareBody;
          }
          tblShare += tbodyShare;
          var shareEndBody = ("</tbody>" +
          "</table>");
          tblShare += shareEndBody;

          var Comment = ("<div class='control-group bgGrayLight mtop10 activityOption'>" +
                        "<label class='control-label'>Comments <span style='color: #B8B6B6;'>- (optional)</span></label>" +
            "<div class='controls'>" +
             " <textarea rows='3' class='modelTextW' id='txtShareComment'></textarea>" +
              "</div>" +
          "</div>");
          tblShare += Comment;
          $('#divShareFeedItem').empty();
          $('#divShareFeedItem').append(tblShare);

          $('#selectUsers').dataTable({
              "sDom": "<'row-fluid'<'span6'l><'span6'f>r>t<'row-fluid'<'span6'i><'span6'p>>",
              "sPaginationType": "bootstrap",
              "bSortable": true,
              "aLengthMenu": [[5, 8, 10], [5, 8, 10]],
              "iDisplayLength": 5,
              "oLanguage": {
                  "sLengthMenu": "_MENU_ records per page",
                  "oPaginate": {
                      "sPrevious": "Prev",
                      "sNext": "Next"
                  }
              },

              aoColumnDefs: [
                       { "aTargets": [0], "bSortable": false },
                       { "aTargets": [1], "bSortable": true },
                       { "aTargets": [2], "bSortable": true }]
          });

          jQuery('#selectUsers.group-checkable').change(function () {
              var set = jQuery(this).attr("data-set");
              var checked = jQuery(this).is(":checked");
              jQuery(set).each(function () {
                  if (checked) {
                      $(this).attr("checked", true);
                  } else {
                      $(this).attr("checked", false);
                  }
              });
              jQuery.uniform.update(set);
          });

          jQuery('#selectUsers_wrapper .dataTables_filter input').addClass("input-medium"); // modify table search input
          jQuery('#selectUsers_wrapper .dataTables_length select').addClass("input-mini"); // modify table per page dropdown
          $('#shareToUsers').modal('show');
      }

      // ToggleDataTableCheckbox Method
      // Method used to toggle datatable checkbox.

      function ToggleDataTableCheckbox(event) {

          var oTable = $('#selectUsers').dataTable();

          // Get the nodes from the table
          var nNodes = oTable.fnGetNodes();

          if ($('#selectAll').is(':checked')) {
              $('input[type=checkbox]', oTable.fnGetNodes()).attr('checked', true);
          }
          else {
              $('input[type=checkbox]', oTable.fnGetNodes()).attr('checked', false);
          }
      }

      function SaveShare(data) {

          //var tblSharedUsrs=new Array();
          var strRel = '';
          $('input[name="chkShare"]:checked').each(function (index, option) {
              //tblSharedUsrs.push(this.value);
              if (strRel == '') {
                  strRel = $(this).val();
              }
              else {
                  strRel = strRel + ',' + $(this).val();
              }

          });
          if (strRel == '') {
              $('[id$=dvShareContentErrorMessage]').empty();
              $('[id$=dvShareContentErrorMessage]').text('Select at least one user');
              $('[id$=dvShareContentErrorMessage]').show();
          }
          else {
              $('[id$=dvShareContentErrorMessage]').empty();
              $('[id$=dvShareContentErrorMessage]').hide();

              var positionID1 = $('#hdnSetPosition').val();
              $('#hdnActivitySequence').val(positionID1);

              var ShareCmt = $('#txtShareComment').val();
              //var FeedItemId=$(data).attr('data-FeedItmId');
              //$(['id$=hdnFeedItemId']).val(FeedItemId);
              document.getElementById("{!$Component.SlpActv.hdnSelectedUsrsId}").value = strRel;
              document.getElementById("{!$Component.SlpActv.hdnShareComment}").value = ShareCmt;
              // $(['id$=hdnSelectedUsrsId']).val(strRel);
              //$(['id$=hdnShareComment']).val(ShareCmt);
              var button = document.getElementById("{!$Component.SlpActv.SActivityShare}");
              button.click();
          }
          //$(['id$=SActivityShare']).click();
          //return true;
      }

      //Featured Start

      // Find the Browser Resolution
      function FindBrowserResolution() {
          
          var StrRes = "0";

          var widthWindow = $('.hpit_Athena_contRowActive').width();
          //var widthMargins = 170;
          //var widthTile = 404;
          var widthMargins = 189;
          var widthTile = 220;
          StrRes = Math.floor(((widthWindow - widthMargins) / widthTile) - 1);

          return StrRes;
      }
      function FeaturedLBPrev(PrevIndex) {
          var StrRes = FindBrowserResolution();
          CallAthenaSLFeatured(StrRes, -1, PrevIndex);
      }

      function FeaturedLBNext(NextIndex) {
          var StrRes = FindBrowserResolution();
          CallAthenaSLFeatured(StrRes, NextIndex, "-1");
      }

      function LoadFeaturedLB() {
          var StrRes = FindBrowserResolution();
          CallAthenaSLFeatured(StrRes, 0, "-1");
      }

      function CallAthenaSLFeatured(DisplayNoOfRecords, strNext, strPrev) {
          Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.AV_Activity.GetFeaturedLB}',
            DisplayNoOfRecords,
            strNext,
            strPrev,
            DisplayFeaturedLB
        );
      }

      function DisplayFeaturedLB(result, event) {
          ;
          $('#RepeaterDiv').empty();



          // START - By Komala  
          if ((result == null || result.length <= 0) && getCookie('FeaturedLBPrevIndex') > 0) {
              var index = parseInt(getCookie('FeaturedLBPrevIndex')) + parseInt(getCookie('FeaturedLBResultLength'));
              $('#RepeaterDiv').append("<a class='ca-nav-prev' id='aFeaturedPrev' style='height:40px; width:25px' onclick='FeaturedLBPrev(" + index + ")'/>");
          }
          // End - By Komala

          if (result != null) {
              if (result.length > 0) {
                  var PrevIndex = result[0].FeaIndex;
                  // START - By Komala
                  document.cookie = "FeaturedLBPrevIndex=" + PrevIndex;
                  document.cookie = "FeaturedLBResultLength=" + result.length;
                  // End - By Komala
                  $('#RepeaterDiv').append("<a class='ca-nav-prev' id='aFeaturedPrev' style='height:40px; width:25px' onclick='FeaturedLBPrev(" + PrevIndex + ")'/>");
                  if (PrevIndex == 1 || PrevIndex == '1') {
                      $('#aFeaturedPrev').hide();
                      $('#aFeaturedPrev').css('display', 'none');
                  }
                  for (var iCount = 0; iCount < result.length; iCount++) {
                      var title = "";
                      if (result[iCount].LBOwnerTitle == null) { title = ""; } else { title = result[iCount].LBOwnerTitle; }

                      if (result[iCount].IsCommunity == true) {
                          //$('#RepeaterDiv').append("<div class='hpit_athena_ca-item hpit_athena_ca-item-2'>" +
                          $('#RepeaterDiv').append("<div class='hpit_athena_ca-item-2' style='position: relative; float: left;width: 230px;height: 100%;text-align: center;margin-right: 33px;'>" +
                                     //"<div class='hpit_athena_ca-item-main' style='bottom:0px! important;'>" +
                                     "<div style='width: 82%;position: absolute;top: 3px;left: 42px;right: 5px;background: #fff;overflow: hidden;-moz-box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.2);-webkit-box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.2);box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.2);border-top-right-radius: 13px;    border-bottom-right-radius: 3px; border-top-left-radius: 3px;border-bottom-left-radius: 13px;'>" +
                                      //"<div class='hpit_athena_ca-item-firstHalf'>" +
                                      "<div style='position: relative; width:200px;height: auto;'>" +
                                       "<div class='hpit_athena_ca-item-topBar hpit_athena_ca-item-topBarG'>" +
                                        "<div class='hpit_athena_ca-item-topBarDateComStar'>" + (result[iCount].LBCreateDate) + " </div>" +

                                         "<div class='hpit_athena_ca-item-topBarChat'>" +
                                          "<div class='hpit_athena_ca-item-topBarChatImg'>" +
                                                "<img src='" + result[iCount].CommentIcon + "' width='14' height='14' alt='hpit_athena_chatIcon'> " +
                                             "</div>" +
                                             "&nbsp;&nbsp;<div class='hpit_athena_ca-item-topBarChatValue'>" + result[iCount].LBNoOfComments + "</div>" +
                                           "</div>" +
                                         "</div>" +
                                         //"<div class='ca-icon'> " +
                                             //"<a class='ratingMouseOver' href='/apex/SLP_ViewCommunity?id=" + result[iCount].LBid + "' id = anchorFeatured_" + result[iCount].LBid + " data-FeaturedLBid = ratingFeatured_" + result[iCount].LBid + " onmouseover='ShowFeaturedRating(this)' onmouseleave = 'HideFeaturedRating(this)'><img src='" + result[iCount].LBImgURL + "' width='230' height='175' alt='antena_defaultImgLearning'/></a>" +
                                             //200
                                              //image - 200 px 70 px
                                             "<div style='width:200px; height:70px;'> " +
                                             "<a class='ratingMouseOver' href='/apex/SLP_ViewCommunity?id=" + result[iCount].LBid + "' id = anchorFeatured_" + result[iCount].LBid + " data-FeaturedLBid = ratingFeatured_" + result[iCount].LBid + " onmouseover='ShowFeaturedRating(this)' onmouseleave = 'HideFeaturedRating(this)'><img src='" + result[iCount].LBImgURL + "' style='width:200px; height:75px;' alt='antena_defaultImgLearning'/></a>" +
                                         "</div>" +
                                         "<div class='starred starredY'></div>" +
                                       "</div>" +
                                       "<a class='a_underNone' href='/apex/SLP_ViewCommunity?id=" + result[iCount].LBid + "'>" +
                                           //"<div class='hpit_athena_ca-item-BottomBar'>" +
                                           "<div style='background: none repeat scroll 0 0 #595555; height: 45px; width 100%; z-index: 999;'>" +
                                            " <div style=' padding-top: 10px; text-decoration:none; font-weight:bold; font-size:13px; font-family: HP Simplified, Arial, Sans-Serif !important; color: #fff;'>" + result[iCount].LBName + "</div>" +
                                           "</div>" +
                                       "</a>" +
                                       "<div class='hpit_athena_ca-item-SecondHalf' style='display:none'>" +
                                        " <div class='hpit_athena_ca-item-person cf' style='display:none'>" +
                                         "  <div class='hpit_athena_ca-item-personPhoto' style='display:none'><img src='" + result[iCount].LBOwnerURL + "' width='35' height='35' alt='no_username_small'/> </div>" +
                                          " <a class='a_underNone' href='/apex/AthenaUserProfile?id=" + result[iCount].LBOwnerID + "'><div class='hpit_athena_ca-item-personName'> " + result[iCount].LBOwnerName + " </div></a>" +
                                          " <div class='hpit_athena_ca-item-personName hpit_athena_ca-item-personD' style='display:none'> " + title + " </div>" +
                                         "</div>" +
                                         "<div style='display:none' class='hpit_athena_ca-item-PersonPost'>" +
                                          " <p>" + result[iCount].LBDescription + "</p>" +
                                         "</div>" +
                                       "</div>" +
                                     "</div>" +
                                   "</div>");
                      }
                      else {
                          //$('#RepeaterDiv').append("<div class='hpit_athena_ca-item hpit_athena_ca-item-2'>" +
                          $('#RepeaterDiv').append("<div class='hpit_athena_ca-item-2' style='position: relative; float: left;width: 230px;height: 100%;text-align: center;margin-right: 33px;'>" +
                                      //"<div class='hpit_athena_ca-item-main' style='bottom: 0px !important;'>" +
                                      //82%
                                      "<div style='width: 82%;position: absolute;top: 3px;left: 42px;right: 5px;background: #fff;overflow: hidden;-moz-box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.2);-webkit-box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.2);box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.2);border-top-right-radius: 13px;   border-bottom-right-radius: 3px; border-top-left-radius: 3px;border-bottom-left-radius: 13px;'>" +
                                       //"<div class='hpit_athena_ca-item-firstHalf'>" + 
                                       "<div style= 'position: relative; width:200px;height: auto;'>" +
                                        "<div class='hpit_athena_ca-item-topBar'>" +
                                         "<div class='hpit_athena_ca-item-topBarDate'>" + (result[iCount].LBCreateDate) + " </div>" +
                                          //"<div class='ratingDispalyL' id=ratingFeatured_" + result[iCount].LBid + "></div>" +
                                          "<div style = 'height: 26px;margin-left: 48px;padding-top: 3px;position: absolute;width: 113px !important;z-index: 1;display: none;' id=ratingFeatured_" + result[iCount].LBid + "></div>" +
                                          "<div class='hpit_athena_ca-item-topBarChat'>" +
                                           "<div class='hpit_athena_ca-item-topBarChatImg'>" +
                                                 "<img src='" + result[iCount].CommentIcon + "' width='14' height='14' alt='hpit_athena_chatIcon'> " +
                                              "</div>" +
                                              "&nbsp;&nbsp;<div class='hpit_athena_ca-item-topBarChatValue'>" + result[iCount].LBNoOfComments + "</div>" +
                                            "</div>" +
                                          "</div>" +
                                          //"<div class='ca-icon'> " +
                                              //"<a class='ratingMouseOver' href='/apex/AthenaLearningBoardDtls?id=" + result[iCount].LBid + "' id = anchorFeatured_" + result[iCount].LBid + " data-FeaturedLBid = ratingFeatured_" + result[iCount].LBid + " onmouseover='ShowFeaturedRating(this)' onmouseleave = 'HideFeaturedRating(this)'><img src='" + result[iCount].LBImgURL + "' width='230' height='175' alt='antena_defaultImgLearning'/></a>" +
                                              //200
                                              //image - 200 px 70 px
                                              "<div style='width:200px; height:70px;'> " +
                                              "<a class='ratingMouseOver' href='/apex/AthenaLearningBoardDtls?id=" + result[iCount].LBid + "' id = anchorFeatured_" + result[iCount].LBid + " data-FeaturedLBid = ratingFeatured_" + result[iCount].LBid + " onmouseover='ShowFeaturedRating(this)' onmouseleave = 'HideFeaturedRating(this)'><img src='" + result[iCount].LBImgURL + "' style='width:200px; height:75px;' alt='antena_defaultImgLearning'/></a>" +

                                          "</div>" +
                                        "</div>" +
                                        "<a class='a_underNone' href='/apex/AthenaLearningBoardDtls?id=" + result[iCount].LBid + "'>" +
                                            //"<div class='hpit_athena_ca-item-BottomBar'>" +
                                            "<div style='background: none repeat scroll 0 0 #595555; height: 45px; width 100%; z-index: 999;'>" +
                                             " <div style=' padding-top:10px; text-decoration:none; font-weight:bold; font-size:13px; font-family: HP Simplified, Arial, Sans-Serif !important; color: #fff;'>" + result[iCount].LBName + "</div>" +
                                            "</div>" +
                                        "</a>" +
                                        "<div class='hpit_athena_ca-item-SecondHalf' style='display:none'>" +
                                         " <div class='hpit_athena_ca-item-person cf' style='display:none'>" +
                                          "  <div class='hpit_athena_ca-item-personPhoto' style='display:none'><img src='" + result[iCount].LBOwnerURL + "' width='35' height='35' alt='no_username_small'/> </div>" +
                                           " <a class='a_underNone' href='/apex/AthenaUserProfile?id=" + result[iCount].LBOwnerID + "'><div class='hpit_athena_ca-item-personName'> " + result[iCount].LBOwnerName + " </div></a>" +
                                           " <div class='hpit_athena_ca-item-personName hpit_athena_ca-item-personD' style='display:none'> " + title + " </div>" +
                                          "</div>" +
                                          "<div style='display:none' class='hpit_athena_ca-item-PersonPost'>" +
                                           " <p>" + result[iCount].LBDescription + "</p>" +
                                          "</div>" +
                                        "</div>" +
                                      "</div>" +
                                    "</div>");
                      }

                      $('#ratingFeatured_' + result[iCount].LBid).raty({
                          cancelOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-off.png')}",
                          cancelOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/cancel-on.png')}",
                          starHalf: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-half.png')}",
                          starOff: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-off.png')}",
                          starOn: "{!URLFOR($Resource.assets_athena, 'assets_athena/raty/img/star-on.png')}",
                          readOnly: true,
                          score: result[iCount].AvgRating
                      });

                  }

                  var featureLen = result.length - 1;
                  var NextIndex = result[featureLen].FeaIndex;
                  $('#RepeaterDiv').append("<a class='ca-nav-next' id='aFeaturedNext' style='height:40px; width:25px;padding-right: 3%;' onclick='FeaturedLBNext(" + NextIndex + ")' />");
                  if (NextIndex == result[0].TotalCount) {
                      $('#aFeaturedNext').hide();
                  }
              }
          }

          //$('.ratingDispalyL').raty({ readOnly: true, score: 2 });
      }

      function ShowFeaturedRating(data) {

          var BoardID = $(data).attr('data-FeaturedLBid');

          $('#' + BoardID).show();
      }

      function HideFeaturedRating(data) {
          var BoardID = $(data).attr('data-FeaturedLBid');

          $('#' + BoardID).hide();
      }
      //Featured End

    </script>
      <script>

          var objUpdateProfle={                       
              Role:'',
              Title:'',
              Department:'',
              AreaofFocus:'',
              AboutMe:'',
              communityIDs:'',
              userProfileIDs:''
          };
          var startCount=0;
          var FeatrurestartCount=0;
          var SearchstartCount=0;
          var clickCount=0;   
          var SearchCommunityResult={
              Name:'',
              ID:''
          };
          var FeatureCommunityResult={
              Name:'',
              ID:''
          };
          var BuildNetworkResult={
              Name:'',
              Role:'',
              ImageURL:''
          };  
          var Script = function () {

              // widget tools

              jQuery('.widget .tools .icon-minus').click(function () {
                  var el = jQuery(this).parents(".widget").children(".widget-body");
                  if (jQuery(this).hasClass("icon-minus")) {
                      jQuery(this).removeClass("icon-minus").addClass("icon-plus");
                      el.slideUp(200);
                  } else {
                      jQuery(this).removeClass("icon-plus").addClass("icon-minus");
                      el.slideDown(200);
                  }
              });

              jQuery('.widget .tools .icon-remove').click(function () {
                  jQuery(this).parents(".widget").parent().remove();
              });

          }();

          function SaveProfileInformation() {  
              clickCount+=1;
              var role=$('[id$=RoleTags]').val();
              var title=$('[id$=Title]').val();
              var areaOfFocus=$('[id$=ExpertiseTags]').val();
              var aboutMe=$('[id$=aboutself]').val();
              var communityIds=[];
              var privateCommunityIds=[];
              var userProfileIDs=[];
              var lstAreaOfFocus = areaOfFocus.split(",");
              var department=$('[id$=Department]').val();
              var FeatureCount=$('[id$=hdnFeatureCount]').val();
              var SearchCount=$('[id$=hdnSearchCount]').val();
               var UserCount=$('[id$=hdnUserCount]').val();
              for (var iSearchCount = 0; iSearchCount < SearchCount; iSearchCount++) {
                  if($("#Searchcheck_"+iSearchCount).is(':checked'))
                  {
                    
                      if($('[id$=CommunitySearchPublic_'+iSearchCount+']').val()=="false")
                      {
                          privateCommunityIds.push($('[id$=searchId_'+iSearchCount+']').val());
                      }
                      else if($('[id$=CommunitySearchPublic_'+iSearchCount+']').val()=="true")
                      {
                          communityIds.push($('[id$=searchId_'+iSearchCount+']').val());
                      }
                  }
              }
              for (var iFeatureCount = 0; iFeatureCount < FeatureCount; iFeatureCount++) {
                  if($("#featurecheck_"+iFeatureCount).is(':checked'))
                  {
                      if($('[id$=CommunityPublic_'+iFeatureCount+']').val()=="false")
                      {
                          privateCommunityIds.push($('[id$=featureId_'+iFeatureCount+']').val());
                      }
                      else if($('[id$=CommunityPublic_'+iFeatureCount+']').val()=="true")
                      {
                          communityIds.push($('[id$=featureId_'+iFeatureCount+']').val());
                      }
                          
                  }
              }
              
                 for (var iUserCount = 0; iUserCount < UserCount; iUserCount++) {
                  if($("#chckUserProfile_"+iUserCount).is(':checked'))
                  {
                          userProfileIDs.push($('[id$=userID_'+iUserCount+']').val());
                  }
              }
              
              updateProfle={                       
                  Role:role,
                  Title:title,
                  Department:department,
                  AreaofFocus:lstAreaOfFocus,
                  AboutMe:aboutMe,
                  communityIDs:communityIds,
                  PrivateCommunityIDs:privateCommunityIds,
                  userProfileIDs:userProfileIDs
              };           

              if(clickCount==1)
              {
                $('[id$=legendHead]').text('Join a community');
                  Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.AV_Activity.SaveProfileData}',
                   updateProfle,
                   MoveNext
                 );
              }
              else if(clickCount==2)
              {
                $('[id$=legendHead]').text('Build your network');
                  Visualforce.remoting.Manager.invokeAction(
               '{!$RemoteAction.AV_Activity.SaveCommunityData}',
               updateProfle,
               MoveNext
                 );
                  $('[id$=aNext]').text('Get Started');
              }
              else if(clickCount==3)
              {
                $('[id$=legendHead]').text('Your profile is complete');
                  Visualforce.remoting.Manager.invokeAction(
                   '{!$RemoteAction.AV_Activity.SaveBuildNetworkData}',
                   updateProfle,
                   MoveNext
                 );
                  $('#aPrevious').hide();
                  $('#aNext').hide();
                  setTimeout('location.reload();', 2500);
              }
              objUpdateProfle=updateProfle;
          }
        
          function MoveNext(result,event)
          {
              //Timeout close  setTimeout( "jQuery('#div').hide();",3000 );
          }

          function previousProfileInformation() {  
              if(clickCount>0)
              {
                clickCount-=1;
               }
                if(clickCount==1)
              {
                $('[id$=legendHead]').text('Join a community');
                }
                else if(clickCount==0)
                {
                    $('[id$=legendHead]').text('Profile Update');
                }
              $('[id$=RoleTags]').val(objUpdateProfle.Role);
              $('[id$=Title]').val(objUpdateProfle.Title);
              $('[id$=Department]').val(objUpdateProfle.Department);
              $('[id$=ExpertiseTags]').val(objUpdateProfle.AreaofFocus);
              $('[id$=aboutself]').val(objUpdateProfle.AboutMe);
               
              var FeatureCount=$('[id$=hdnFeatureCount]').val();
              var SearchCount=$('[id$=hdnSearchCount]').val();
              for (var iSearchCount = 0; iSearchCount < SearchCount; iSearchCount++) {
                  if(jQuery.inArray( $('[id$=searchId_'+iSearchCount+']').val(), objUpdateProfle.communityIDs )>=0)
                  {
                      $("#searchcheck_"+iSearchCount).prop('checked', true);
                  }
              }
              for (var iFeatureCount = 0; iFeatureCount < FeatureCount; iFeatureCount++) {
                  if(jQuery.inArray( $('[id$=featureId_'+iFeatureCount+']').val(), objUpdateProfle.communityIDs )>=0)
                  {
                      $("#searchcheck_"+iSearchCount).prop('checked', true);
                  }
              }

              $('[id$=aNext]').text('Next');
              //var userProfileIDs='';
   
          }
    
          function GetSearchCommunity() {  

              var SearchText=$('#searchText').val();
              if(SearchText!='' &&  SearchText.length>2)
              {
              SearchstartCount=0;
                  Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.AV_Activity.GetFeaturedOrSearchCommunity}',
                    false,
                    SearchText,
                    PopulatesearchResult
                );
              }
          }
          function PopulatesearchResult(result,event)
          {
              if (result != null) {
                  if (result.length > 0) {
                      $('#showSearchResults').show();
                      SearchCommunityResult=result;
                      var buildHtml='';
                      for (var iCount = 0; iCount < result.length; iCount++) {
                          //result[iCount].Description
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<input name="" type="checkbox" value="" id="Searchcheck_'+iCount+'" onclick="SelectCommunity('+result[iCount].isPublic+','+result[iCount].Id+')" />';
                 
                          buildHtml+='<input id="CommunitySearchPublic_'+iCount+'" type="hidden" value="'+result[iCount].isPublic+'" name="isSearchPublic" />';
                          buildHtml+='<span>';
                          if(result[iCount].isPublic==false)
                          {
                              buildHtml+=result[iCount].Name+' (Private)';
                          }
                          else
                          {
                              buildHtml+=result[iCount].Name;
                          }
                          buildHtml+='</span>';
                          buildHtml+='<input id="searchId_'+iCount+'" type="hidden" value="'+result[iCount].Id+'" name="Id">';
                          buildHtml+='</div>';
                          SearchstartCount+=1;
                          if(SearchstartCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnSearchCount" type="hidden" value="'+result.length+'" name="Id">';
                      buildHtml+='<a class="ca-nav-next" id="SearchResultNext" style="height:40px; width:25px;padding-right: 3%;" onclick="NextSearchComResult()" />';
                      $("#RepeaterSearchCommunity").html(buildHtml);
                  }
              }

          }

          function NextSearchComResult()
          {
              if (SearchCommunityResult != null) {
                  if (SearchCommunityResult.length > 0) {
                      var buildHtml='';
                      var testCount=0;
                      buildHtml+='<a class="ca-nav-prev" id="SearchResultPrev" style="height:40px; width:25px" onclick="PreviousSearchResult()" />';
                      for (var iCount = SearchstartCount; iCount < SearchCommunityResult.length; iCount++) {
                          //result[iCount].Description
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<input name="" type="checkbox" value="" id="Searchcheck_'+iCount+'"/>';
                          buildHtml+='<input id="CommunitySearchPublic_'+iCount+'" type="hidden" value="'+SearchCommunityResult[iCount].isPublic+'" name="isSearchPublic" />';
                          buildHtml+='<span>';                         
                          if(SearchCommunityResult[iCount].isPublic==false)
                          {
                              buildHtml+=SearchCommunityResult[iCount].Name+' (Private)';
                          }
                          else
                          {
                              buildHtml+=SearchCommunityResult[iCount].Name;
                          }
                          buildHtml+='</span>';

                          buildHtml+='<input id="featureId_'+iCount+'" type="hidden" value="'+SearchCommunityResult[iCount].Id+'" name="Id" />';
                          buildHtml+='</div>';
                          testCount+=1;
                          SearchstartCount+=1;
                          if(testCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnSearchCount" type="hidden" value="'+SearchCommunityResult.length+'" name="Id">';
                      if(SearchCommunityResult.length!=SearchstartCount)
                      {
                          buildHtml+='<a class="ca-nav-next" id="SearchResultNext" style="height:40px; width:25px;padding-right: 3%;" onclick="NextSearchComResult()" />';
                      }
                      else
                      {
                        SearchstartCount=SearchstartCount-testCount;
                      }
                      $("#RepeaterSearchCommunity").html(buildHtml);
                  }
              }
          }

          function PreviousSearchResult()
          {
              if (SearchCommunityResult != null) {
                  if (SearchCommunityResult.length > 0) {
                      var buildHtml='';
                      var testCount=0;
                      SearchstartCount-=4;
                      if(SearchstartCount>4)
                      {
                          buildHtml+='<a class="ca-nav-prev" id="SearchResultPrev" style="height:40px; width:25px" onclick="PreviousSearchResult()" />';
                      }
                      for (var iCount = SearchstartCount; iCount >0; iCount--) {
                          //result[iCount].Description
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<input name="" type="checkbox" value="" id="Searchcheck_'+iCount+'"/>';
                          buildHtml+='<input id="CommunitySearchPublic_'+iCount+'" type="hidden" value="'+SearchCommunityResult[iCount].isPublic+'" name="isSearchPublic" />';
                          buildHtml+='<span>';
                          if(SearchCommunityResult[iCount].isPublic==false)
                          {
                              buildHtml+=SearchCommunityResult[iCount].Name+'[ Private]';
                          }
                          else
                          {
                              buildHtml+=SearchCommunityResult[iCount].Name;
                          }
                          buildHtml+='</span>';
                          buildHtml+='<input id="featureId_'+iCount+'" type="hidden" value="'+SearchCommunityResult[iCount].Id+'" name="Id" />';
                          buildHtml+='</div>';
                          testCount+=1;
                          SearchstartCount-=1;
                          if(testCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnSearchCount" type="hidden" value="'+SearchCommunityResult.length+'" name="Id">';
                      buildHtml+='<a class="ca-nav-next" id="SearchResultNext" style="height:40px; width:25px;padding-right: 3%;" onclick="NextSearchComResult()" />';
                      if(SearchstartCount==0)
                      {
                        SearchstartCount=4;
                      }
                      $("#RepeaterSearchCommunity").html(buildHtml);
                  }
              }
          }
          function SelectCommunity(isPublic,communityID)
          {
          debugger;
            if(isPublic=="false")
            {
                $('#privateCommunity').show();
            }
          }

          $(function () {
              var sampleTags = [{!Availskill}];

              var sampleRoles= [{!AvailsRoles}];
              var sampleExperts= [{!AvailableExperts}];

              //-------------------------------
              // Single TAG field
              //-------------------------------
              $('#ExpertiseTagsTop').tagit({
                  availableTags: sampleExperts,
                  // This will make Tag-it submit a single form value, as a comma-delimited field.
                  singleField: true,
                  singleFieldNode: $('#ExpertiseTags'),
                  caseSensitive     : false,
                              
              }); 
        
              $('#RoleTagsTop').tagit({
                  availableTags: sampleRoles,
                  // This will make Tag-it submit a single form value, as a comma-delimited field.
                  singleField: true,
                  tagLimit :1,
                  singleFieldNode: $('#RoleTags')
              });


              //Restricting max length of a TAG to 10
              $('#RoleTagsTop, #ExpertiseTagsTop').find('input').attr('maxlength', 50);

              //Get Featured Community
              Visualforce.remoting.Manager.invokeAction(
                '{!$RemoteAction.AV_Activity.GetFeaturedOrSearchCommunity}',
                true,
                '',
                PopulateFeatureResult
            );
              //Get Users to Follow
              Visualforce.remoting.Manager.invokeAction(
                     '{!$RemoteAction.AV_Activity.GetUserToFollow}',
                     PopulateUserResult
                 );
          
          });
 
          function PopulateFeatureResult(result,event) {  
              if (result != null) {
                  if (result.length > 0) {
                      FeatureCommunityResult=result;
                      var buildHtml='';
                      for (var iCount = 0; iCount < result.length; iCount++) {
                          //result[iCount].Description          
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<input name="" type="checkbox" value="" id="featurecheck_'+iCount+'"/>';
                          buildHtml+='<input id="CommunityPublic_'+iCount+'" type="hidden" value="'+result[iCount].isPublic+'" name="isPublic" />';
                          buildHtml+='<span>';
                          if(result[iCount].isPublic==false)
                          {
                              buildHtml+=result[iCount].Name+' (Private)';
                          }
                          else
                          {
                              buildHtml+=result[iCount].Name;
                          }
                          buildHtml+='</span>';
                          buildHtml+='<input id="featureId_'+iCount+'" type="hidden" value="'+result[iCount].Id+'" name="Id" />';
                          buildHtml+='</div>';
                          FeatrurestartCount+=1;
                          if(FeatrurestartCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnFeatureCount" type="hidden" value="'+result.length+'" name="Id">';
                      buildHtml+='<a class="ca-nav-next" id="aFeaturedResultNext" style="height:40px; width:25px;padding-right: 3%;" onclick="NextFeatureResult()" />';
                      $("#RepeaterFeatureCommunity").html(buildHtml);
                  }
              }
          }
          function NextFeatureResult() { 
              if (FeatureCommunityResult != null) {
                  if (FeatureCommunityResult.length > 0) {
                      var buildHtml='';
                      var testCount=0;
                      buildHtml+='<a class="ca-nav-prev" id="aFeaturedPrev1" style="height:40px; width:25px" onclick="PreviousFeatureResult()" />';
                      for (var iCount = FeatrurestartCount; iCount < FeatureCommunityResult.length; iCount++) {           
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<input name="" type="checkbox" value="" id="featurecheck_'+iCount+'"/>';
                          buildHtml+='<input id="CommunityPublic_'+iCount+'" type="hidden" value="'+FeatureCommunityResult[iCount].isPublic+'" name="isPublic" />';
                          buildHtml+='<span>';
                          if(FeatureCommunityResult[iCount].isPublic==false)
                          {
                              buildHtml+=FeatureCommunityResult[iCount].Name+' (Private)';
                          }
                          else
                          {
                              buildHtml+=FeatureCommunityResult[iCount].Name;
                          }
                          buildHtml+='</span>';
                          buildHtml+='<input id="featureId_'+iCount+'" type="hidden" value="'+FeatureCommunityResult[iCount].Id+'" name="Id" />';
                          buildHtml+='</div>';
                          testCount+=1;
                          FeatrurestartCount+=1;
                          if(testCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnFeatureCount" type="hidden" value="'+FeatureCommunityResult.length+'" name="Id">';
                      if(FeatureCommunityResult.length!=FeatrurestartCount)
                      {
                        buildHtml+='<a class="ca-nav-next" id="aFeaturedResultNext" style="height:40px; width:25px;padding-right: 3%;" onclick="NextFeatureResult()" />';
                      }
                      else
                      {
                        FeatrurestartCount=FeatrurestartCount-testCount;
                      }
                      $("#RepeaterFeatureCommunity").html(buildHtml);
                  }
              }
          }
        
          function PreviousFeatureResult() {  
   

              if (FeatureCommunityResult != null) {
                  if (FeatureCommunityResult.length > 0) {
                      var buildHtml='';
                      var testCount=0;
                      FeatrurestartCount-=4;
                      if(FeatrurestartCount>4)
                      {
                          buildHtml+='<a class="ca-nav-prev" id="aFeaturedPrev1" style="height:40px; width:25px" onclick="PreviousFeatureResult()" />';
                      }
                      for (var iCount = FeatrurestartCount; iCount > 0; iCount--) {
                      
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<input name="" type="checkbox" value="" id="featurecheck_'+iCount+'"/>';
                          buildHtml+='<input id="CommunityPublic_'+iCount+'" type="hidden" value="'+FeatureCommunityResult[iCount].isPublic+'" name="isPublic" />';
                          buildHtml+='<span>';
                          if(FeatureCommunityResult[iCount].isPublic==false)
                          {
                              buildHtml+=FeatureCommunityResult[iCount].Name+' (Private)';
                          }
                          else
                          {
                              buildHtml+=FeatureCommunityResult[iCount].Name;
                          }
                          buildHtml+='<span>';
                          buildHtml+='<input id="featureId_'+iCount+'" type="hidden" value="'+FeatureCommunityResult[iCount].Id+'" name="Id" />';
                          buildHtml+='</div>';
                          testCount+=1;
                          FeatrurestartCount-=1;
                          if(testCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnFeatureCount" type="hidden" value="'+FeatureCommunityResult.length+'" name="Id">';
                      buildHtml+='<a class="ca-nav-next" id="aFeaturedResultNext" style="height:40px; width:25px;padding-right: 3%;" onclick="NextFeatureResult()" />';
                      if(FeatrurestartCount==0)
                      {
                        FeatrurestartCount=4;
                      }
                      $("#RepeaterFeatureCommunity").html(buildHtml);
                  }
              }
          }
          function PopulateUserResult(result,event) {  
              debugger;

              if (result != null) {
                  if (result.length > 0) {
                      var buildHtml='';
                      BuildNetworkResult=result;
                      for (var iCount = startCount; iCount < result.length; iCount++) {
                        if(result[iCount].Role==undefined)
                        {
                            result[iCount].Role=''
                        }
                        if(result[iCount].Region==undefined)
                        {
                            result[iCount].Region=''
                        }
                        if(result[iCount].BusinessGroup==undefined)
                        {
                            result[iCount].BusinessGroup=''
                        }
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<div class="span2 PFimg">';
                          buildHtml+='<div class="regCheck">';
                          buildHtml+='<input name="" type="checkbox" id="chckUserProfile_'+iCount+'" value="" />';
                          buildHtml+='</div>';
                          buildHtml+='<img src="'+result[iCount].ImageURL+'"/> </div>';
                          buildHtml+='<div class="span9">';
                          buildHtml+='<li class="mt2"><a href="#" target="_top">'+result[iCount].Name+'</a>'+result[iCount].Role+'</li>';
                          buildHtml+='<li>'+ result[iCount].Region+' '+result[iCount].BusinessGroup+'</li>';
                          buildHtml+='<input id="userID_'+iCount+'" type="hidden" value="'+result[iCount].userID+'" name="userID" />';
                          buildHtml+='<input id="esUserID_'+iCount+'" type="hidden" value="'+result[iCount].esUserID+'" name="esUserID"/>';
                          buildHtml+='</div>';
                          buildHtml+='</div>';
                          startCount+=1;
                          if(startCount==4)
                          {
                              break;
                          }
                     }
                      buildHtml+='<input id="hdnUserCount" type="hidden" value="'+result.length+'" name="Id">';
                      buildHtml+='<a class="ca-nav-next" id="aFeaturedNext1" style="height:40px; width:25px;padding-right: 3%;" onclick="NextBuildNetwork()" />';
                      $("#RepeaterBuildNetworkDiv").html(buildHtml);
                  }
              }
          }
 
          function NextBuildNetwork() {  
              debugger;
              if (BuildNetworkResult != null) {
                  if (BuildNetworkResult.length > 0) {
                      var buildHtml='';
                      var testCount=0;
                      buildHtml+='<a class="ca-nav-prev" id="aFeaturedPrev1" style="height:40px; width:25px" onclick="PreviousBuildNetwork()" />';
                      for (var iCount = startCount; iCount < BuildNetworkResult.length; iCount++) {      
                        if(result[iCount].Role==undefined)
                        {
                            result[iCount].Role=''
                        }
                        if(result[iCount].Region==undefined)
                        {
                            result[iCount].Region=''
                        }
                        if(result[iCount].BusinessGroup==undefined)
                        {
                            result[iCount].BusinessGroup=''
                        }                     
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<div class="span2 PFimg">';
                          buildHtml+='<div class="regCheck">';
                          buildHtml+='<input name="" type="checkbox" id="chckUserProfile_'+iCount+'" value="" />';
                          buildHtml+='</div>';
                          buildHtml+='<img src="'+BuildNetworkResult[iCount].ImageURL+'"/> </div>';
                          buildHtml+='<div class="span9">';
                          buildHtml+='<li class="mt2"><a href="#" target="_top">'+BuildNetworkResult[iCount].Name+'</a>'+BuildNetworkResult[iCount].Role+'</li>';
                          buildHtml+='<li>'+ BuildNetworkResult[iCount].Region+' '+BuildNetworkResult[iCount].BusinessGroup+'</li>';
                          buildHtml+='<input id="userID_'+iCount+'" type="hidden" value="'+BuildNetworkResult[iCount].userID+'" name="userID" />';
                          buildHtml+='<input id="esUserID_'+iCount+'" type="hidden" value="'+BuildNetworkResult[iCount].esUserID+'" name="esUserID"/>';
                          buildHtml+='</div>';
                          buildHtml+='</div>';
                          testCount+=1;
                          startCount+=1;
                          if(testCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnUserCount" type="hidden" value="'+BuildNetworkResult.length+'" name="Id">';
                      if(BuildNetworkResult.length!=startCount)
                      {
                          buildHtml+='<a class="ca-nav-next" id="aFeaturedNext1" style="height:40px; width:25px;padding-right: 3%;" onclick="NextBuildNetwork()" />';
                      }
                      else
                      {
                        startCount=startCount-testCount;
                      }
                      $("#RepeaterBuildNetworkDiv").html(buildHtml);
                  }
              }
          }
 
          function PreviousBuildNetwork() {  
              debugger;

              if (BuildNetworkResult != null) {
                  if (BuildNetworkResult.length > 0) {
                      var buildHtml='';
                      var testCount=0;
                      startCount-=4;
                      if(startCount>4)
                      {
                          buildHtml+='<a class="ca-nav-prev" id="aFeaturedPrev1" style="height:40px; width:25px" onclick="PreviousBuildNetwork()" />';
                      }
                      for (var iCount = startCount; iCount > 0; iCount--) {
                        if(result[iCount].Role==undefined)
                        {
                            result[iCount].Role=''
                        }
                        if(result[iCount].Region==undefined)
                        {
                            result[iCount].Region=''
                        }
                        if(result[iCount].BusinessGroup==undefined)
                        {
                            result[iCount].BusinessGroup=''
                        }
                          buildHtml+='<div class="span4 FCspace">';
                          buildHtml+='<div class="span2 PFimg">';
                          buildHtml+='<div class="regCheck">';
                          buildHtml+='<input name="" type="checkbox" id="chckUserProfile_'+iCount+'" value="" />';
                          buildHtml+='</div>';
                          buildHtml+='<img src="'+BuildNetworkResult[iCount].ImageURL+'"/> </div>';
                          buildHtml+='<div class="span9">';
                          buildHtml+='<li class="mt2"><a href="#" target="_top">'+BuildNetworkResult[iCount].Name+'</a>'+BuildNetworkResult[iCount].Role+'</li>';
                          buildHtml+='<li>'+ BuildNetworkResult[iCount].Region+' '+BuildNetworkResult[iCount].BusinessGroup+'</li>';
                          buildHtml+='<input id="userID_'+iCount+'" type="hidden" value="'+BuildNetworkResult[iCount].userID+'" name="userID" />';
                          buildHtml+='<input id="esUserID_'+iCount+'" type="hidden" value="'+BuildNetworkResult[iCount].esUserID+'" name="esUserID"/>';
                          buildHtml+='</div>';
                          buildHtml+='</div>';
                          testCount+=1;
                          startCount-=1;
                          if(testCount==4)
                          {
                              break;
                          }
                      }
                      buildHtml+='<input id="hdnUserCount" type="hidden" value="'+BuildNetworkResult.length+'" name="Id">';
                      buildHtml+='<a class="ca-nav-next" id="aFeaturedNext1" style="height:40px; width:25px;padding-right: 3%;" onclick="NextBuildNetwork()" />';
                      if(startCount==0)
                      {
                        startCount=4;
                      }
                      $("#RepeaterBuildNetworkDiv").html(buildHtml);
                  }
              }
          }
      </script>
  </body>
  <!-- END BODY -->
  </html>
</apex:page>