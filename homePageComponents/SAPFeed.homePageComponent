<?xml version="1.0" encoding="UTF-8"?>
<HomePageComponent xmlns="http://soap.sforce.com/2006/04/metadata">
    <body>&lt;br&gt;&lt;script language=&quot;javascript&quot;&gt;    var msg = &quot;This change will stop the Auto sync with the contracts. Opportunity will not be updated with contract changes any longer&quot;;    var sapfeedcheckboxId;    var prodId;    function sapFeedcheckBox(func) {        var oldonload = window.onload;        if (typeof window.onload != &apos;function&apos;) {            window.onload = func;        } else {            window.onload = function () {                if (oldonload) {                    oldonload();                }                func();            }        }    }    function SapfeedinlineOverride() {        try {            var sapfeedobj = window.parent.document.getElementById(sapfeedcheckboxId);            sapfeedobj.setAttribute(&quot;onClick&quot;, &quot;sapfeedOnclickOverride();&quot;);        } catch (err) {}    }    function sapfeedOnclickOverride() {        try {            var sapfeedobj = window.parent.document.getElementById(sapfeedcheckboxId);            if (sapfeedobj.checked == false) {                alert(msg);                sapfeedobj.disabled = true;            }            if (sapfeedobj.checked == true) {                sapfeedobj.checked = false;                sapfeedobj.disabled = true;            }        } catch (err) {}    }    function delOnclickOverride() {        try {            var oppId = window.location.href.substring(window.location.href.indexOf(&apos;.com/&apos;) + 5).split(&apos;/&apos;)[0];            var result = sforce.connection.query(&quot;Select Name, Id, RecordTypeId, SAP_Feed__c from Opportunity where Id = &apos;&quot; + oppId + &quot;&apos;&quot;);            var records = result.getArray(&quot;records&quot;);            for (var i = 0; i &lt; records.length; i++) {                var record = records[i];            }            var rTypeResult = sforce.connection.query(&quot;Select Name, Id from RecordType where Name = &apos;Renewal&apos; &quot;);            var rTyperecords = rTypeResult.getArray(&quot;records&quot;);            for (var i = 0; i &lt; rTyperecords.length; i++) {                var rTyperecords = rTyperecords[i];            }            if (rTyperecords.Id == record.RecordTypeId &amp;&amp; record.SAP_Feed__c == &apos;true&apos;) {                var conmsg = confirm(msg);                if (conmsg == true) {                    location.href = prodId;                } else {                    return false;                }            } else {                var del = confirm(&quot;Are you sure?&quot;);                if (del == true) {                    location.href = prodId;                } else {                    return false;                }            }        } catch (err) {}    }    function getFieldId() {        try {            var allTd = window.parent.document.getElementsByTagName(&apos;td&apos;);            for (var i = 0; i &lt; allTd.length; i++) {                if (allTd[i].innerHTML == &apos;Auto Sync&apos;) {                    var fieldId = allTd[i + 1];                    sapfeedcheckboxId = fieldId.id.split(&apos;_&apos;)[0];                }            }            var alllabel = window.parent.document.getElementsByTagName(&apos;label&apos;);            for (var i = 0; i &lt; alllabel.length; i++) {                if (alllabel[i].innerHTML == &apos;Auto Sync&apos;) {                    var fieldId = alllabel[i];                    sapfeedcheckboxId = fieldId.htmlFor;                }            }        } catch (err) {}    }    function overrideOpptyChangeOwnerLink(oppId) {        try {            var allAnchor = window.parent.document.getElementsByTagName(&apos;a&apos;);            for (var i = 0; i &lt; allAnchor.length; i++) {                if (allAnchor[i].innerHTML == &apos;[Change]&apos; &amp;&amp; allAnchor[i].href.indexOf(&apos;recordtypeselect&apos;) == -1) {                    allAnchor[i].href = &apos;/apex/OpptyOwnerChange?id=&apos; + oppId;                }            }        } catch (err) {}    }    function hideNewButtonForSupportRequest() {        try {            var allInput = window.parent.document.getElementsByTagName(&apos;input&apos;);            for (var i = 0; i &lt; allInput.length; i++) {                if (allInput[i].title == &apos;New&apos;) {                    allInput[i].style.display = &apos;none&apos;;                }            }        } catch (err) {}    }    sapFeedcheckBox(function () {        try {            var urlCon = document.location.href;            if (urlCon.indexOf(&apos;salesforce.com/a17/o&apos;) &gt;= 0) {                hideNewButtonForSupportRequest();            }            if (urlCon.indexOf(&apos;salesforce.com/006&apos;) &gt;= 0) {                getFieldId();                var oppId = window.location.href.substring(window.location.href.indexOf(&apos;.com/&apos;) + 5).split(&apos;/&apos;)[0];                oppId = oppId.substring(0, 15);                overrideOpptyChangeOwnerLink(oppId);                if (window.parent.document.getElementById(sapfeedcheckboxId)) {                    var sapfeedobj = window.parent.document.getElementById(sapfeedcheckboxId);                    sapfeedobj.setAttribute(&quot;onClick&quot;, &quot;sapfeedOnclickOverride();&quot;);                }                if (window.parent.document.getElementById(sapfeedcheckboxId + &quot;_ilecell&quot;)) {                    var sapfeedilecell = window.parent.document.getElementById(sapfeedcheckboxId + &quot;_ilecell&quot;);                    var dbclickfunctions = sapfeedilecell.getAttribute(&quot;ondblclick&quot;);                    sapfeedilecell.setAttribute(&quot;ondblclick&quot;, dbclickfunctions + &quot;SapfeedinlineOverride();&quot;);                }                if (window.parent.document.getElementById(oppId + &quot;_RelatedLineItemList_body&quot;)) {                    var deletecell = window.parent.document.getElementById(oppId + &quot;_RelatedLineItemList_body&quot;);                    var allanchor = deletecell.getElementsByClassName(&apos;actionLink&apos;);                    for (var i = 0; i &lt; allanchor.length; i++) {                        var title = allanchor[i].getAttribute(&quot;title&quot;);                        var delindex = title.indexOf(&quot;Delete&quot;);                        if (delindex &gt; -1) {                            allanchor[i].setAttribute(&quot;onClick&quot;, &quot;delOnclickOverride();&quot;);                            prodId = allanchor[i].href;                            allanchor[i].removeAttribute(&quot;href&quot;);                            allanchor[i].style.cursor = &quot;pointer&quot;;                        }                    }                }            }        } catch (err) {}    })&lt;/script&gt;</body>
    <pageComponentType>htmlArea</pageComponentType>
    <width>narrow</width>
</HomePageComponent>
