<?xml version="1.0" encoding="UTF-8"?>
<HomePageComponent xmlns="http://soap.sforce.com/2006/04/metadata">
    <body>&lt;script type=&quot;text/javascript&quot; src=&quot;/resource/jQuery&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/resource/connectionjs&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;/resource/apexjs&quot;&gt;&lt;/script&gt;&lt;script type=&quot;text/javascript&quot;&gt;    var j$ = jQuery.noConflict();    var sid = getCookie(&apos;sid&apos;);    var server = &quot;https://&quot; + window.location.host + &quot;/services/Soap/u/26.0&quot;;    var currentURL = window.location.href;    var currentHost = window.location.host;    j$(document).ready(function() {  try{   if (currentHost.indexOf(&apos;.salesforce.com&apos;) != -1) {    sforce.connection.init(sid, server);    var resultPermissionAndProgram = sforce.connection.describeSObject(&quot;Programs_and_permissions__c&quot;);    var objectKeyPrefix = resultPermissionAndProgram.keyPrefix;    var accessName = &apos;&apos;;    var dropDownID = &apos;&apos;;    var detailPageDropDownId = &apos;&apos;;    if (currentURL.indexOf(&apos;retURL=&apos;) == -1) {     j$(&quot;td&quot;).each(function() {      if (j$(this).text() == &apos;PermissionSets&apos;) {       var tempString = j$(this).next().attr(&quot;id&quot;);       if (tempString != &apos;&apos;) {        detailPageDropDownId = tempString.substring(0, 15);       }      }     });    }    j$(&quot;label&quot;).each(function() {     if (j$(this).text() == &apos;PermissionSets&apos;) {      dropDownID = j$(this).attr(&quot;for&quot;);     }    });    j$(&quot;#&quot; + dropDownID).html(&apos;&apos;);    var addHTMLDropDown = permissionSetList();    setTimeout(function() {     j$(&quot;#&quot; + dropDownID).html(addHTMLDropDown);    }, 1000);    if (currentURL.indexOf(&apos;.salesforce.com/&apos; + objectKeyPrefix) != -1) {     j$(&quot;label&quot;).each(function() {      if (j$(this).text() == &apos;Programs and permissions Name&apos;) {       accessName = j$(this).attr(&quot;for&quot;);      }     });     if (j$(&quot;#&quot; + accessName).val() != &apos;&apos;) {      setTimeout(function() {       j$(&quot;#&quot; + dropDownID).val(getCurrentPermissionSet());      }, 1500);     }    }    j$(&quot;#&quot; + detailPageDropDownId + &quot;_ilecell&quot;).bind(&apos;dblclick&apos;, function() {     setTimeout(function() {      j$(&quot;#&quot; + detailPageDropDownId).html(&apos;&apos;);      j$(&quot;#&quot; + detailPageDropDownId).html(permissionSetList());      j$(&quot;#&quot; + detailPageDropDownId).val(getCurrentPermissionSet());     }, 1000);    });   }  } catch(err){}    });    function permissionSetList() {        var dropDownHTML = &apos;\&quot;&apos;;        var soqlQuery = &quot;SELECT Label, ProfileId, Name FROM permissionSet where UserLicense.Name = \&apos;Gold Partner\&apos;&quot;;        var result = sforce.connection.query(soqlQuery);        var records = result.getArray(&quot;records&quot;);        for (i = 0; i &lt; records.length; i++) {            var permissionSetLabel = records[i].Name;            var profileid = records[i].ProfileId;            if (permissionSetLabel.indexOf(profileid) == -1) {                dropDownHTML = dropDownHTML + &apos;&lt;option value=\&quot;&apos; + records[i].Name + &apos;\&quot;&gt;&apos; + records[i].Label + &apos;&lt;/option&gt;&apos;;            }        }        dropDownHTML = dropDownHTML + &apos;\&quot;&apos;;        return dropDownHTML;    }    function getCurrentPermissionSet() {        var linkURL = window.location.href;        var recordId = linkURL.substring((linkURL.indexOf(&apos;.salesforce.com/&apos;) + 16), (linkURL.indexOf(&apos;.salesforce.com/&apos;) + 31));        if (recordId.length == 15 &amp;&amp; recordId.indexOf(&apos;/&apos;) == -1) {            var soqlQuery = &quot;SELECT PermissionSets__c FROM Programs_and_permissions__c WHERE Id =\&apos;&quot; + recordId + &quot;\&apos;&quot;;            var result = sforce.connection.query(soqlQuery);            var records = result.getArray(&quot;records&quot;);            return records[0].PermissionSets__c;        } else {            return &apos;&apos;;        }    }&lt;/script&gt;</body>
    <pageComponentType>htmlArea</pageComponentType>
    <width>narrow</width>
</HomePageComponent>
